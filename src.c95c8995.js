parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"clu1":[function(require,module,exports) {

},{"./../images/check.svg":[["check.00a3b777.svg","YHTB"],"YHTB"],"./../images/hero-home-mobile.png":[["hero-home-mobile.feaa1c00.png","I4Dv"],"I4Dv"],"./../images/hero-home-mobile@2x.png":[["hero-home-mobile@2x.07c3751e.png","oIv3"],"oIv3"],"./../images/hero-home-tablet.png":[["hero-home-tablet.28bcbf1b.png","lGgZ"],"lGgZ"],"./../images/hero-home-tablet@2x.png":[["hero-home-tablet@2x.d227fe3f.png","JsfP"],"JsfP"],"./../images/hero-home-desctop.png":[["hero-home-desctop.1113d1fe.png","kkZW"],"kkZW"],"./../images/hero-home-desctop@2x.png":[["hero-home-desctop@2x.3e882f5f.png","P6wB"],"P6wB"],"./../images/hero-library-mobile.png":[["hero-library-mobile.4d793a20.png","Dhxx"],"Dhxx"],"./../images/hero-library-mobile@2x.png":[["hero-library-mobile@2x.a79c3d50.png","fwh1"],"fwh1"],"./../images/hero-library-tablet.png":[["hero-library-tablet.8fc2643c.png","uVPx"],"uVPx"],"./../images/hero-library-tablet@2x.png":[["hero-library-tablet@2x.03383486.png","QFS8"],"QFS8"],"./../images/hero-library-desctop.png":[["hero-library-desctop.f6664f1f.png","uMvS"],"uMvS"],"./../images/hero-library-desctop@2x.png":[["hero-library-desctop@2x.9a57faad.png","ITrK"],"ITrK"],"./../images/film.svg":[["film.8d90fc1b.svg","O322"],"O322"],"./../images/search.svg":[["search.2ec2ebc5.svg","TnGF"],"TnGF"],"./../images/icon-youtube.png":[["icon-youtube.37852dd2.png","nuC8"],"nuC8"]}],"chA2":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0}),exports.Sha1=exports.RANDOM_FACTOR=exports.MAX_VALUE_MILLIS=exports.FirebaseError=exports.ErrorFactory=exports.Deferred=exports.CONSTANTS=void 0,exports.areCookiesEnabled=T,exports.assertionError=exports.assert=void 0,exports.async=tt,exports.base64urlEncodeWithoutPadding=exports.base64Encode=exports.base64Decode=exports.base64=void 0,exports.calculateBackoffMillis=dt,exports.contains=F,exports.createMockUserToken=d,exports.createSubscribe=Y,exports.decode=void 0,exports.deepCopy=u,exports.deepEqual=H,exports.deepExtend=f,exports.errorPrefix=st,exports.extractQuerystring=X,exports.getGlobal=D,exports.getModularInstance=yt,exports.getUA=b,exports.isAdmin=void 0,exports.isBrowser=x,exports.isBrowserExtension=g,exports.isElectron=v,exports.isEmpty=$,exports.isIE=A,exports.isIndexedDBAvailable=C,exports.isMobileCordova=_,exports.isNode=y,exports.isNodeSdk=S,exports.isReactNative=E,exports.isSafari=O,exports.isUWP=m,exports.issuedAtTime=exports.isValidTimestamp=exports.isValidFormat=void 0,exports.jsonEval=I,exports.map=J,exports.ordinal=bt,exports.querystring=G,exports.querystringDecode=K,exports.safeGet=z,exports.stringToByteArray=exports.stringLength=void 0,exports.stringify=P,exports.validateArgCount=void 0,exports.validateCallback=it,exports.validateContextObject=ct,exports.validateIndexedDBOpenable=w,exports.validateNamespace=nt;const e={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};exports.CONSTANTS=e;const r=function(t,e){if(!t)throw o(e)};exports.assert=r;const o=function(t){return new Error("Firebase Database ("+e.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};exports.assertionError=o;const s=function(t){const e=[];let r=0;for(let o=0;o<t.length;o++){let s=t.charCodeAt(o);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=63&s|128):55296==(64512&s)&&o+1<t.length&&56320==(64512&t.charCodeAt(o+1))?(s=65536+((1023&s)<<10)+(1023&t.charCodeAt(++o)),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=63&s|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=63&s|128)}return e},n=function(t){const e=[];let r=0,o=0;for(;r<t.length;){const s=t[r++];if(s<128)e[o++]=String.fromCharCode(s);else if(s>191&&s<224){const n=t[r++];e[o++]=String.fromCharCode((31&s)<<6|63&n)}else if(s>239&&s<365){const n=((7&s)<<18|(63&t[r++])<<12|(63&t[r++])<<6|63&t[r++])-65536;e[o++]=String.fromCharCode(55296+(n>>10)),e[o++]=String.fromCharCode(56320+(1023&n))}else{const n=t[r++],i=t[r++];e[o++]=String.fromCharCode((15&s)<<12|(63&n)<<6|63&i)}}return e.join("")},i={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,o=[];for(let s=0;s<t.length;s+=3){const e=t[s],n=s+1<t.length,i=n?t[s+1]:0,c=s+2<t.length,a=c?t[s+2]:0,h=e>>2,u=(3&e)<<4|i>>4;let f=(15&i)<<2|a>>6,l=63&a;c||(l=64,n||(f=64)),o.push(r[h],r[u],r[f],r[l])}return o.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(s(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):n(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,o=[];for(let s=0;s<t.length;){const e=r[t.charAt(s++)],n=s<t.length?r[t.charAt(s)]:0,i=++s<t.length?r[t.charAt(s)]:64,c=++s<t.length?r[t.charAt(s)]:64;if(++s,null==e||null==n||null==i||null==c)throw Error();const a=e<<2|n>>4;if(o.push(a),64!==i){const t=n<<4&240|i>>2;if(o.push(t),64!==c){const t=i<<6&192|c;o.push(t)}}}return o},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};exports.base64=i;const c=function(t){const e=s(t);return i.encodeByteArray(e,!0)};exports.base64Encode=c;const a=function(t){return c(t).replace(/\./g,"")};exports.base64urlEncodeWithoutPadding=a;const h=function(t){try{return i.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function u(t){return f(void 0,t)}function f(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(const r in e)e.hasOwnProperty(r)&&l(r)&&(t[r]=f(t[r],e[r]));return t}function l(t){return"__proto__"!==t}exports.base64Decode=h;class p{constructor(){this.reject=(()=>{}),this.resolve=(()=>{}),this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,r)=>{e?this.reject(e):this.resolve(r),"function"==typeof t&&(this.promise.catch(()=>{}),1===t.length?t(e):t(e,r))}}}function d(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r=e||"demo-project",o=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const n=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:o,exp:o+3600,auth_time:o,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[a(JSON.stringify({alg:"none",type:"JWT"})),a(JSON.stringify(n)),""].join(".")}function b(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function _(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(b())}function y(){try{return"[object process]"===Object.prototype.toString.call(t.process)}catch(e){return!1}}function x(){return"object"==typeof self&&self.self===self}function g(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function E(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function v(){return b().indexOf("Electron/")>=0}function A(){const t=b();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function m(){return b().indexOf("MSAppHost/")>=0}function S(){return!0===e.NODE_CLIENT||!0===e.NODE_ADMIN}function O(){return!y()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function C(){return"object"==typeof indexedDB}function w(){return new Promise((t,e)=>{try{let o=!0;const s="validate-browser-context-for-indexeddb-analytics-module",n=self.indexedDB.open(s);n.onsuccess=(()=>{n.result.close(),o||self.indexedDB.deleteDatabase(s),t(!0)}),n.onupgradeneeded=(()=>{o=!1}),n.onerror=(()=>{var t;e((null===(t=n.error)||void 0===t?void 0:t.message)||"")})}catch(r){e(r)}})}function T(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}function D(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t)return t;throw new Error("Unable to locate global object.")}exports.Deferred=p;const N="FirebaseError";class M extends Error{constructor(t,e,r){super(e),this.code=t,this.customData=r,this.name=N,Object.setPrototypeOf(this,M.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,j.prototype.create)}}exports.FirebaseError=M;class j{constructor(t,e,r){this.service=t,this.serviceName=e,this.errors=r}create(t,...e){const r=e[0]||{},o=`${this.service}/${t}`,s=this.errors[t],n=s?k(s,r):"Error",i=`${this.serviceName}: ${n} (${o}).`;return new M(o,i,r)}}function k(t,e){return t.replace(B,(t,r)=>{const o=e[r];return null!=o?String(o):`<${r}?>`})}exports.ErrorFactory=j;const B=/\{\$([^}]+)}/g;function I(t){return JSON.parse(t)}function P(t){return JSON.stringify(t)}const L=function(t){let e={},r={},o={},s="";try{const i=t.split(".");e=I(h(i[0])||""),r=I(h(i[1])||""),s=i[2],o=r.d||{},delete r.d}catch(n){}return{header:e,claims:r,data:o,signature:s}};exports.decode=L;const V=function(t){const e=L(t).claims,r=Math.floor((new Date).getTime()/1e3);let o=0,s=0;return"object"==typeof e&&(e.hasOwnProperty("nbf")?o=e.nbf:e.hasOwnProperty("iat")&&(o=e.iat),s=e.hasOwnProperty("exp")?e.exp:o+86400),!!r&&!!o&&!!s&&r>=o&&r<=s};exports.isValidTimestamp=V;const R=function(t){const e=L(t).claims;return"object"==typeof e&&e.hasOwnProperty("iat")?e.iat:null};exports.issuedAtTime=R;const W=function(t){const e=L(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")};exports.isValidFormat=W;const U=function(t){const e=L(t).claims;return"object"==typeof e&&!0===e.admin};function F(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function z(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function $(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function J(t,e,r){const o={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(o[s]=e.call(r,t[s],s,t));return o}function H(t,e){if(t===e)return!0;const r=Object.keys(t),o=Object.keys(e);for(const s of r){if(!o.includes(s))return!1;const r=t[s],n=e[s];if(q(r)&&q(n)){if(!H(r,n))return!1}else if(r!==n)return!1}for(const s of o)if(!r.includes(s))return!1;return!0}function q(t){return null!==t&&"object"==typeof t}function G(t){const e=[];for(const[r,o]of Object.entries(t))Array.isArray(o)?o.forEach(t=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(t))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(o));return e.length?"&"+e.join("&"):""}function K(t){const e={};return t.replace(/^\?/,"").split("&").forEach(t=>{if(t){const[r,o]=t.split("=");e[decodeURIComponent(r)]=decodeURIComponent(o)}}),e}function X(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}exports.isAdmin=U;class Q{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,e){e||(e=0);const r=this.W_;if("string"==typeof t)for(let u=0;u<16;u++)r[u]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(let u=0;u<16;u++)r[u]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(let u=16;u<80;u++){const t=r[u-3]^r[u-8]^r[u-14]^r[u-16];r[u]=4294967295&(t<<1|t>>>31)}let o,s,n=this.chain_[0],i=this.chain_[1],c=this.chain_[2],a=this.chain_[3],h=this.chain_[4];for(let u=0;u<80;u++){u<40?u<20?(o=a^i&(c^a),s=1518500249):(o=i^c^a,s=1859775393):u<60?(o=i&c|a&(i|c),s=2400959708):(o=i^c^a,s=3395469782);const t=(n<<5|n>>>27)+o+h+s+r[u]&4294967295;h=a,a=c,c=4294967295&(i<<30|i>>>2),i=n,n=t}this.chain_[0]=this.chain_[0]+n&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295}update(t,e){if(null==t)return;void 0===e&&(e=t.length);const r=e-this.blockSize;let o=0;const s=this.buf_;let n=this.inbuf_;for(;o<e;){if(0===n)for(;o<=r;)this.compress_(t,o),o+=this.blockSize;if("string"==typeof t){for(;o<e;)if(s[n]=t.charCodeAt(o),++o,++n===this.blockSize){this.compress_(s),n=0;break}}else for(;o<e;)if(s[n]=t[o],++o,++n===this.blockSize){this.compress_(s),n=0;break}}this.inbuf_=n,this.total_+=e}digest(){const t=[];let e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let o=this.blockSize-1;o>=56;o--)this.buf_[o]=255&e,e/=256;this.compress_(this.buf_);let r=0;for(let o=0;o<5;o++)for(let e=24;e>=0;e-=8)t[r]=this.chain_[o]>>e&255,++r;return t}}function Y(t,e){const r=new Z(t,e);return r.subscribe.bind(r)}exports.Sha1=Q;class Z{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(t=>{this.error(t)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,r){let o;if(void 0===t&&void 0===e&&void 0===r)throw new Error("Missing Observer.");void 0===(o=et(t,["next","error","complete"])?t:{next:t,error:e,complete:r}).next&&(o.next=rt),void 0===o.error&&(o.error=rt),void 0===o.complete&&(o.complete=rt);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch(t){}}),this.observers.push(o),s}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}})}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function tt(t,e){return(...r)=>{Promise.resolve(!0).then(()=>{t(...r)}).catch(t=>{e&&e(t)})}}function et(t,e){if("object"!=typeof t||null===t)return!1;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}function rt(){}const ot=function(t,e,r,o){let s;if(o<e?s="at least "+e:o>r&&(s=0===r?"none":"no more than "+r),s){throw new Error(t+" failed: Was called with "+o+(1===o?" argument.":" arguments.")+" Expects "+s+".")}};function st(t,e){return`${t} failed: ${e} argument `}function nt(t,e,r){if((!r||e)&&"string"!=typeof e)throw new Error(st(t,"namespace")+"must be a valid firebase namespace.")}function it(t,e,r,o){if((!o||r)&&"function"!=typeof r)throw new Error(st(t,e)+"must be a valid function.")}function ct(t,e,r,o){if((!o||r)&&("object"!=typeof r||null===r))throw new Error(st(t,e)+"must be a valid context object.")}exports.validateArgCount=ot;const at=function(t){const e=[];let o=0;for(let s=0;s<t.length;s++){let n=t.charCodeAt(s);if(n>=55296&&n<=56319){const e=n-55296;r(++s<t.length,"Surrogate pair missing trail surrogate."),n=65536+(e<<10)+(t.charCodeAt(s)-56320)}n<128?e[o++]=n:n<2048?(e[o++]=n>>6|192,e[o++]=63&n|128):n<65536?(e[o++]=n>>12|224,e[o++]=n>>6&63|128,e[o++]=63&n|128):(e[o++]=n>>18|240,e[o++]=n>>12&63|128,e[o++]=n>>6&63|128,e[o++]=63&n|128)}return e};exports.stringToByteArray=at;const ht=function(t){let e=0;for(let r=0;r<t.length;r++){const o=t.charCodeAt(r);o<128?e++:o<2048?e+=2:o>=55296&&o<=56319?(e+=4,r++):e+=3}return e};exports.stringLength=ht;const ut=1e3,ft=2,lt=144e5;exports.MAX_VALUE_MILLIS=lt;const pt=.5;function dt(t,e=ut,r=ft){const o=e*Math.pow(r,t),s=Math.round(pt*o*(Math.random()-.5)*2);return Math.min(lt,o+s)}function bt(t){return Number.isFinite(t)?t+_t(t):`${t}`}function _t(t){const e=(t=Math.abs(t))%100;if(e>=10&&e<=20)return"th";const r=t%10;return 1===r?"st":2===r?"nd":3===r?"rd":"th"}function yt(t){return t&&t._delegate?t._delegate:t}exports.RANDOM_FACTOR=pt;
},{}],"vhY9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Provider=exports.ComponentContainer=exports.Component=void 0;var t=require("@firebase/util");class e{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}exports.Component=e;const n="[DEFAULT]";class i{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const e=new t.Deferred;if(this.instancesDeferred.set(n,e),this.isInitialized(n)||this.shouldAutoInitialize())try{const t=this.getOrInitializeService({instanceIdentifier:n});t&&e.resolve(t)}catch(i){}}return this.instancesDeferred.get(n).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(r(t))try{this.getOrInitializeService({instanceIdentifier:n})}catch(e){}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:i});n.resolve(t)}catch(e){}}}}clearInstance(t=n){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...t.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return null!=this.component}isInitialized(t=n){return this.instances.has(t)}getOptions(t=n){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[s,r]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(s)&&r.resolve(i)}return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),s=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;s.add(t),this.onInitCallbacks.set(i,s);const r=this.instances.get(i);return r&&t(r,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const s of n)try{s(t,e)}catch(i){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:s(t),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(i){}return n||null}normalizeInstanceIdentifier(t=n){return this.component?this.component.multipleInstances?t:n:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}function s(t){return t===n?void 0:t}function r(t){return"EAGER"===t.instantiationMode}exports.Provider=i;class o{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new i(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}exports.ComponentContainer=o;
},{"@firebase/util":"chA2"}],"JJem":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Logger=exports.LogLevel=void 0,exports.setLogLevel=i,exports.setUserLogHandler=g;const e=[];var r;exports.LogLevel=r,function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(r||(exports.LogLevel=r={}));const t={debug:r.DEBUG,verbose:r.VERBOSE,info:r.INFO,warn:r.WARN,error:r.ERROR,silent:r.SILENT},o=r.INFO,l={[r.DEBUG]:"log",[r.VERBOSE]:"log",[r.INFO]:"info",[r.WARN]:"warn",[r.ERROR]:"error"},s=(e,r,...t)=>{if(r<e.logLevel)return;const o=(new Date).toISOString(),s=l[r];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${r})`);console[s](`[${o}]  ${e.name}:`,...t)};class n{constructor(r){this.name=r,this._logLevel=o,this._logHandler=s,this._userLogHandler=null,e.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in r))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?t[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,r.DEBUG,...e),this._logHandler(this,r.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,r.VERBOSE,...e),this._logHandler(this,r.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,r.INFO,...e),this._logHandler(this,r.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,r.WARN,...e),this._logHandler(this,r.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,r.ERROR,...e),this._logHandler(this,r.ERROR,...e)}}function i(r){e.forEach(e=>{e.setLogLevel(r)})}function g(o,l){for(const s of e){let e=null;l&&l.level&&(e=t[l.level]),s.userLogHandler=null===o?null:(t,l,...s)=>{const n=s.map(e=>{if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(r){return null}}).filter(e=>e).join(" ");l>=(null!=e?e:t.logLevel)&&o({level:r[l].toLowerCase(),message:n,args:s,type:t.name})}}}exports.Logger=n;
},{}],"h2Mb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"FirebaseError",{enumerable:!0,get:function(){return a.FirebaseError}}),exports._DEFAULT_ENTRY_NAME=exports.SDK_VERSION=void 0,exports._addComponent=R,exports._addOrOverwriteComponent=T,exports._apps=void 0,exports._clearComponents=M,exports._components=void 0,exports._getProvider=V,exports._registerComponent=U,exports._removeServiceInstance=q,exports.deleteApp=Q,exports.getApp=G,exports.getApps=J,exports.initializeApp=H,exports.onLog=X,exports.registerVersion=W,exports.setLogLevel=Z;var e=require("@firebase/component"),t=require("@firebase/logger"),a=require("@firebase/util");class r{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(o(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}function o(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}const i="@firebase/app",n="0.7.8",s=new t.Logger("@firebase/app"),p="@firebase/app-compat",c="@firebase/analytics-compat",f="@firebase/analytics",l="@firebase/app-check-compat",m="@firebase/app-check",u="@firebase/auth",d="@firebase/auth-compat",b="@firebase/database",g="@firebase/database-compat",h="@firebase/functions",_="@firebase/functions-compat",v="@firebase/installations",y="@firebase/installations-compat",w="@firebase/messaging",D="@firebase/messaging-compat",x="@firebase/performance",E="@firebase/performance-compat",C="@firebase/remote-config",A="@firebase/remote-config-compat",N="@firebase/storage",$="@firebase/storage-compat",F="@firebase/firestore",O="@firebase/firestore-compat",j="firebase",L="9.4.1",k="[DEFAULT]";exports._DEFAULT_ENTRY_NAME=k;const I={[i]:"fire-core",[p]:"fire-core-compat",[f]:"fire-analytics",[c]:"fire-analytics-compat",[m]:"fire-app-check",[l]:"fire-app-check-compat",[u]:"fire-auth",[d]:"fire-auth-compat",[b]:"fire-rtdb",[g]:"fire-rtdb-compat",[h]:"fire-fn",[_]:"fire-fn-compat",[v]:"fire-iid",[y]:"fire-iid-compat",[w]:"fire-fcm",[D]:"fire-fcm-compat",[x]:"fire-perf",[E]:"fire-perf-compat",[C]:"fire-rc",[A]:"fire-rc-compat",[N]:"fire-gcs",[$]:"fire-gcs-compat",[F]:"fire-fst",[O]:"fire-fst-compat","fire-js":"fire-js",[j]:"fire-js-all"},P=new Map;exports._apps=P;const S=new Map;function R(e,t){try{e.container.addComponent(t)}catch(a){s.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,a)}}function T(e,t){e.container.addOrOverwriteComponent(t)}function U(e){const t=e.name;if(S.has(t))return s.debug(`There were multiple attempts to register component ${t}.`),!1;S.set(t,e);for(const a of P.values())R(a,e);return!0}function V(e,t){return e.container.getProvider(t)}function q(e,t,a=k){V(e,t).clearInstance(a)}function M(){S.clear()}exports._components=S;const z={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function."},K=new a.ErrorFactory("app","Firebase",z);class Y{constructor(t,a,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},a),this._name=a.name,this._automaticDataCollectionEnabled=a.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new e.Component("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw K.create("app-deleted",{appName:this._name})}}const B="9.4.1";function H(t,r={}){if("object"!=typeof r){r={name:r}}const o=Object.assign({name:k,automaticDataCollectionEnabled:!1},r),i=o.name;if("string"!=typeof i||!i)throw K.create("bad-app-name",{appName:String(i)});const n=P.get(i);if(n){if((0,a.deepEqual)(t,n.options)&&(0,a.deepEqual)(o,n.config))return n;throw K.create("duplicate-app",{appName:i})}const s=new e.ComponentContainer(i);for(const e of S.values())s.addComponent(e);const p=new Y(t,o,s);return P.set(i,p),p}function G(e=k){const t=P.get(e);if(!t)throw K.create("no-app",{appName:e});return t}function J(){return Array.from(P.values())}async function Q(e){const t=e.name;P.has(t)&&(P.delete(t),await Promise.all(e.container.getProviders().map(e=>e.delete())),e.isDeleted=!0)}function W(t,a,r){var o;let i=null!==(o=I[t])&&void 0!==o?o:t;r&&(i+=`-${r}`);const n=i.match(/\s|\//),p=a.match(/\s|\//);if(n||p){const e=[`Unable to register library "${i}" with version "${a}":`];return n&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),n&&p&&e.push("and"),p&&e.push(`version name "${a}" contains illegal characters (whitespace or "/")`),void s.warn(e.join(" "))}U(new e.Component(`${i}-version`,()=>({library:i,version:a}),"VERSION"))}function X(e,a){if(null!==e&&"function"!=typeof e)throw K.create("invalid-log-argument");(0,t.setUserLogHandler)(e,a)}function Z(e){(0,t.setLogLevel)(e)}function ee(t){U(new e.Component("platform-logger",e=>new r(e),"PRIVATE")),W(i,n,t),W(i,n,"esm2017"),W("fire-js","")}exports.SDK_VERSION="9.4.1",ee("");
},{"@firebase/component":"vhY9","@firebase/logger":"JJem","@firebase/util":"chA2"}],"OJEJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@firebase/app");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});var r="firebase",t="9.4.1";(0,e.registerVersion)(r,t,"app");
},{"@firebase/app":"h2Mb"}],"pBGv":[function(require,module,exports) {

var t,e,n=module.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}function u(t){if(e===clearTimeout)return clearTimeout(t);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{return e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(n){t=r}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(n){e=o}}();var c,s=[],l=!1,a=-1;function f(){l&&c&&(l=!1,c.length?s=c.concat(s):a=-1,s.length&&h())}function h(){if(!l){var t=i(f);l=!0;for(var e=s.length;e;){for(c=s,s=[];++a<e;)c&&c[a].run();a=-1,e=s.length}c=null,l=!1,u(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new m(t,e)),1!==s.length||l||i(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0};
},{}],"Q6BU":[function(require,module,exports) {
var process = require("process");
var e=require("process");Object.defineProperty(exports,"__esModule",{value:!0}),exports._TEST_ACCESS_hijackHash=exports._TEST_ACCESS_forceRestClient=exports._ReferenceImpl=exports._QueryParams=exports._QueryImpl=exports.TransactionResult=exports.QueryConstraint=exports.OnDisconnect=exports.Database=exports.DataSnapshot=void 0,exports._repoManagerDatabaseFromApp=dl,exports._setSDKVersion=l,exports._validateWritablePath=exports._validatePathString=void 0,exports.child=Ca,exports.connectDatabaseEmulator=yl,exports.enableLogging=wl,exports.endAt=Ua,exports.endBefore=Ba,exports.equalTo=ol,exports.get=Sa,exports.getDatabase=ml,exports.goOffline=vl,exports.goOnline=Cl,exports.increment=Il,exports.limitToFirst=Ka,exports.limitToLast=$a,exports.off=La,exports.onChildAdded=Ma,exports.onChildChanged=Aa,exports.onChildMoved=Fa,exports.onChildRemoved=qa,exports.onDisconnect=wa,exports.onValue=Da,exports.orderByChild=Ja,exports.orderByKey=el,exports.orderByPriority=nl,exports.orderByValue=sl,exports.push=Ta,exports.query=al,exports.ref=ya,exports.refFromURL=va,exports.remove=ba,exports.runTransaction=xl,exports.serverTimestamp=kl,exports.set=ka,exports.setPriority=Ia,exports.setWithPriority=Ea,exports.startAfter=Ya,exports.startAt=Va,exports.update=xa;var t=require("@firebase/app"),n=require("@firebase/component"),i=require("@firebase/util"),s=require("@firebase/logger");const r="@firebase/database",o="0.12.4";let a="";function l(e){a=e}class h{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,i.stringify)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,i.jsonEval)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class c{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,i.contains)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const u=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new h(t)}}catch(t){}return new c},d=u("localStorage"),p=u("sessionStorage"),_=new s.Logger("@firebase/database"),f=function(){let e=1;return function(){return e++}}(),g=function(e){const t=(0,i.stringToByteArray)(e),n=new i.Sha1;n.update(t);const s=n.digest();return i.base64.encodeByteArray(s)},m=function(...e){let t="";for(let n=0;n<e.length;n++){const s=e[n];Array.isArray(s)||s&&"object"==typeof s&&"number"==typeof s.length?t+=m.apply(null,s):t+="object"==typeof s?(0,i.stringify)(s):s,t+=" "}return t};let y=null,v=!0;const C=function(e,t){(0,i.assert)(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(_.logLevel=s.LogLevel.VERBOSE,y=_.log.bind(_),t&&p.set("logging_enabled",!0)):"function"==typeof e?y=e:(y=null,p.remove("logging_enabled"))},w=function(...e){if(!0===v&&(v=!1,null===y&&!0===p.get("logging_enabled")&&C(!0)),y){const t=m.apply(null,e);y(t)}},T=function(e){return function(...t){w(e,...t)}},b=function(...e){const t="FIREBASE INTERNAL ERROR: "+m(...e);_.error(t)},k=function(...e){const t=`FIREBASE FATAL ERROR: ${m(...e)}`;throw _.error(t),new Error(t)},I=function(...e){const t="FIREBASE WARNING: "+m(...e);_.warn(t)},E=function(){"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&I("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},x=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},S=function(e){if((0,i.isNodeSdk)()||"complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}},P="[MIN_NAME]",N="[MAX_NAME]",R=function(e,t){if(e===t)return 0;if(e===P||t===N)return-1;if(t===P||e===N)return 1;{const n=V(e),i=V(t);return null!==n?null!==i?n-i==0?e.length-t.length:n-i:-1:null!==i?1:e<t?-1:1}},D=function(e,t){return e===t?0:e<t?-1:1},M=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+(0,i.stringify)(t))},A=function(e){if("object"!=typeof e||null===e)return(0,i.stringify)(e);const t=[];for(const i in e)t.push(i);t.sort();let n="{";for(let s=0;s<t.length;s++)0!==s&&(n+=","),n+=(0,i.stringify)(t[s]),n+=":",n+=A(e[t[s]]);return n+="}"},F=function(e,t){const n=e.length;if(n<=t)return[e];const i=[];for(let s=0;s<n;s+=t)s+t>n?i.push(e.substring(s,n)):i.push(e.substring(s,s+t));return i};function q(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const L=function(e){(0,i.assert)(!x(e),"Invalid JSON number");let t,n,s,r,o;0===e?(n=0,s=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(n=(r=Math.min(Math.floor(Math.log(e)/Math.LN2),1023))+1023,s=Math.round(e*Math.pow(2,52-r)-Math.pow(2,52))):(n=0,s=Math.round(e/Math.pow(2,-1074))));const a=[];for(o=52;o;o-=1)a.push(s%2?1:0),s=Math.floor(s/2);for(o=11;o;o-=1)a.push(n%2?1:0),n=Math.floor(n/2);a.push(t?1:0),a.reverse();const l=a.join("");let h="";for(o=0;o<64;o+=8){let e=parseInt(l.substr(o,8),2).toString(16);1===e.length&&(e="0"+e),h+=e}return h.toLowerCase()},O=function(){return!("object"!=typeof window||!window.chrome||!window.chrome.extension||/^chrome/.test(window.location.href))},W=function(){return"object"==typeof Windows&&"object"==typeof Windows.UI};function U(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const i=new Error(e+" at "+t._path.toString()+": "+n);return i.code=e.toUpperCase(),i}const j=new RegExp("^-?(0*)\\d{1,10}$"),B=-2147483648,H=2147483647,V=function(e){if(j.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},z=function(e){try{e()}catch(t){setTimeout(()=>{const e=t.stack||"";throw I("Exception was thrown by user callback.",e),t},Math.floor(0))}},Y=function(){return("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Q=function(e,t){const n=setTimeout(e,t);return"object"==typeof n&&n.unref&&n.unref(),n};class K{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then(e=>this.appCheck=e)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,n)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,n):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(t=>t.addTokenListener(e))}notifyForInvalidToken(){I(`Provided AppCheck credentials for the app named "${this.appName_}" `+"are invalid. This usually indicates your app was not initialized correctly.")}}class G{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit(e=>this.auth_=e)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(e=>e&&"auth/token-not-initialized"===e.code?(w("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)):new Promise((t,n)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,n):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',I(e)}}class ${constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}$.OWNER="owner";const X="5",J="v",Z="s",ee="r",te="f",ne=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,ie="ls",se="p",re="ac",oe="websocket",ae="long_polling";class le{constructor(e,t,n,i,s=!1,r="",o=!1){this.secure=t,this.namespace=n,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=r,this.includeNamespaceInQueryParams=o,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=d.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&d.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function he(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams}function ce(e,t,n){let s;if((0,i.assert)("string"==typeof t,"typeof type must == string"),(0,i.assert)("object"==typeof n,"typeof params must == object"),t===oe)s=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==ae)throw new Error("Unknown connection type: "+t);s=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}he(e)&&(n.ns=e.namespace);const r=[];return q(n,(e,t)=>{r.push(e+"="+t)}),s+r.join("&")}class ue{constructor(){this.counters_={}}incrementCounter(e,t=1){(0,i.contains)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,i.deepCopy)(this.counters_)}}const de={},pe={};function _e(e){const t=e.toString();return de[t]||(de[t]=new ue),de[t]}function fe(e,t){const n=e.toString();return pe[n]||(pe[n]=t()),pe[n]}class ge{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&z(()=>{this.onMessage_(e[t])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const me="start",ye="close",ve="pLPCommand",Ce="pRTLPCB",we="id",Te="pw",be="ser",ke="cb",Ie="seg",Ee="ts",xe="d",Se="dframe",Pe=1870,Ne=30,Re=Pe-Ne,De=25e3,Me=3e4;class Ae{constructor(e,t,n,i,s,r,o){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=i,this.authToken=s,this.transportSessionId=r,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=T(e),this.stats_=_e(t),this.urlFn=(e=>(this.appCheckToken&&(e[re]=this.appCheckToken),ce(t,ae,e)))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new ge(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Me)),S(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Fe((...e)=>{const[t,n,i,s,r]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,t===me)this.id=n,this.password=i;else{if(t!==ye)throw new Error("Unrecognized command received: "+t);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,()=>{this.onClosed_()})):this.onClosed_()}},(...e)=>{const[t,n]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,n)},()=>{this.onClosed_()},this.urlFn);const e={};e[me]="t",e[be]=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e[ke]=this.scriptTagHolder.uniqueCallbackIdentifier),e[J]=X,this.transportSessionId&&(e[Z]=this.transportSessionId),this.lastSessionId&&(e[ie]=this.lastSessionId),this.applicationId&&(e[se]=this.applicationId),this.appCheckToken&&(e[re]=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&ne.test(location.hostname)&&(e[ee]=te);const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Ae.forceAllow_=!0}static forceDisallow(){Ae.forceDisallow_=!0}static isAvailable(){return!(0,i.isNodeSdk)()&&(!!Ae.forceAllow_||!Ae.forceDisallow_&&"undefined"!=typeof document&&null!=document.createElement&&!O()&&!W())}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=(0,i.stringify)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=(0,i.base64Encode)(t),s=F(n,Re);for(let i=0;i<s.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[i]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,i.isNodeSdk)())return;this.myDisconnFrame=document.createElement("iframe");const n={};n[Se]="t",n[we]=e,n[Te]=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=(0,i.stringify)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class Fe{constructor(e,t,n,s){if(this.onDisconnect=n,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,i.isNodeSdk)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=f(),window[ve+this.uniqueCallbackIdentifier]=e,window[Ce+this.uniqueCallbackIdentifier]=t,this.myIFrame=Fe.createIFrame_();let n="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)){n='<script>document.domain="'+document.domain+'";<\/script>'}const i="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(i),this.myIFrame.doc.close()}catch(r){w("frame writing exception"),r.stack&&w(r.stack),w(r)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||w("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[we]=this.myID,e[Te]=this.myPW,e[be]=this.currentSerial;let t=this.urlFn(e),n="",i=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+Ne+n.length<=Pe))break;{const e=this.pendingSegs.shift();n=n+"&"+Ie+i+"="+e.seg+"&"+Ee+i+"="+e.ts+"&"+xe+i+"="+e.d,i++}}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(n,Math.floor(De));this.addTag(e,()=>{clearTimeout(i),n()})}addTag(e,t){(0,i.isNodeSdk)()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const e=i.readyState;e&&"loaded"!==e&&"complete"!==e||(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=(()=>{w("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()}),this.myIFrame.doc.body.appendChild(i)}catch(n){}},Math.floor(1))}}const qe=16384,Le=45e3;let Oe=null;"undefined"!=typeof MozWebSocket?Oe=MozWebSocket:"undefined"!=typeof WebSocket&&(Oe=WebSocket);class We{constructor(e,t,n,i,s,r,o){this.connId=e,this.applicationId=n,this.appCheckToken=i,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=T(this.connId),this.stats_=_e(t),this.connURL=We.connectionURL_(t,r,o,i),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,s){const r={};return r[J]=X,!(0,i.isNodeSdk)()&&"undefined"!=typeof location&&location.hostname&&ne.test(location.hostname)&&(r[ee]=te),t&&(r[Z]=t),n&&(r[ie]=n),s&&(r[re]=s),ce(e,oe,r)}open(t,n){this.onDisconnect=n,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,d.set("previous_websocket_failure",!0);try{if((0,i.isNodeSdk)()){const t=this.nodeAdmin?"AdminNode":"Node",n={headers:{"User-Agent":`Firebase/${X}/${a}/${e.platform}/${t}`,"X-Firebase-GMPID":this.applicationId||""}};this.authToken&&(n.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(n.headers["X-Firebase-AppCheck"]=this.appCheckToken);const i=e.env,s=0===this.connURL.indexOf("wss://")?i.HTTPS_PROXY||i.https_proxy:i.HTTP_PROXY||i.http_proxy;s&&(n.proxy={origin:s}),this.mySock=new Oe(this.connURL,[],n)}else{const e={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}};this.mySock=new Oe(this.connURL,[],e)}}catch(s){this.log_("Error instantiating WebSocket.");const e=s.message||s.data;return e&&this.log_(e),void this.onClosed_()}this.mySock.onopen=(()=>{this.log_("Websocket connected."),this.everConnected_=!0}),this.mySock.onclose=(()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()}),this.mySock.onmessage=(e=>{this.handleIncomingFrame(e)}),this.mySock.onerror=(e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()})}start(){}static forceDisallow(){We.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==Oe&&!We.forceDisallow_}static previouslyFailed(){return d.isInMemoryStorage||!0===d.get("previous_websocket_failure")}markConnectionHealthy(){d.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=(0,i.jsonEval)(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if((0,i.assert)(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=(0,i.stringify)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=F(t,qe);n.length>1&&this.sendString_(String(n.length));for(let i=0;i<n.length;i++)this.sendString_(n[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Le))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}We.responsesRequiredToBeHealthy=2,We.healthyTimeout=3e4;class Ue{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Ae,We]}initTransports_(e){const t=We&&We.isAvailable();let n=t&&!We.previouslyFailed();if(e.webSocketOnly&&(t||I("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[We];else{const e=this.transports_=[];for(const t of Ue.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t)}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}const je=6e4,Be=5e3,He=10240,Ve=102400,ze="t",Ye="d",Qe="s",Ke="r",Ge="e",$e="o",Xe="a",Je="n",Ze="p",et="h";class tt{constructor(e,t,n,i,s,r,o,a,l,h){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=r,this.onReady_=o,this.onDisconnect_=a,this.onKill_=l,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=T("c:"+this.id+":"),this.transportManager_=new Ue(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,n)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Q(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Ve?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>He?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(ze in e){const t=e[ze];t===Xe?this.upgradeIfSecondaryHealthy_():t===Ke?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):t===$e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=M("t",e),n=M("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Ze,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Xe,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Je,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=M("t",e),n=M("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=M(ze,e);if(Ye in e){const n=e[Ye];if(t===et)this.onHandshake_(n);else if(t===Je){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===Qe?this.onConnectionShutdown_(n):t===Ke?this.onReset_(n):t===Ge?b("Server Error: "+n):t===$e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):b("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),X!==n&&I("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),Q(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(je))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Q(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Be))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Ze,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(d.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class nt{put(e,t,n,i){}merge(e,t,n,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class it{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,i.assert)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let e=0;e<n.length;e++)n[e].callback.apply(n[e].context,t)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const i=this.getInitialEvent(e);i&&t.apply(n,i)}off(e,t,n){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!n||n===i[s].context))return void i.splice(s,1)}validateEventType_(e){(0,i.assert)(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class st extends it{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||(0,i.isMobileCordova)()||(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new st}getInitialEvent(e){return(0,i.assert)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}const rt=32,ot=768;class at{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function lt(){return new at("")}function ht(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function ct(e){return e.pieces_.length-e.pieceNum_}function ut(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new at(e.pieces_,t)}function dt(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function pt(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}function _t(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function ft(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new at(t,0)}function gt(e,t){const n=[];for(let i=e.pieceNum_;i<e.pieces_.length;i++)n.push(e.pieces_[i]);if(t instanceof at)for(let i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new at(n,0)}function mt(e){return e.pieceNum_>=e.pieces_.length}function yt(e,t){const n=ht(e),i=ht(t);if(null===n)return t;if(n===i)return yt(ut(e),ut(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function vt(e,t){const n=_t(e,0),i=_t(t,0);for(let s=0;s<n.length&&s<i.length;s++){const e=R(n[s],i[s]);if(0!==e)return e}return n.length===i.length?0:n.length<i.length?-1:1}function Ct(e,t){if(ct(e)!==ct(t))return!1;for(let n=e.pieceNum_,i=t.pieceNum_;n<=e.pieces_.length;n++,i++)if(e.pieces_[n]!==t.pieces_[i])return!1;return!0}function wt(e,t){let n=e.pieceNum_,i=t.pieceNum_;if(ct(e)>ct(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[i])return!1;++n,++i}return!0}class Tt{constructor(e,t){this.errorPrefix_=t,this.parts_=_t(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=(0,i.stringLength)(this.parts_[n]);It(this)}}function bt(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=(0,i.stringLength)(t),It(e)}function kt(e){const t=e.parts_.pop();e.byteLength_-=(0,i.stringLength)(t),e.parts_.length>0&&(e.byteLength_-=1)}function It(e){if(e.byteLength_>ot)throw new Error(e.errorPrefix_+"has a key path longer than "+ot+" bytes ("+e.byteLength_+").");if(e.parts_.length>rt)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+rt+") or object contains a cycle "+Et(e))}function Et(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class xt extends it{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))},!1)}static getInstance(){return new xt}getInitialEvent(e){return(0,i.assert)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const St=1e3,Pt=3e5,Nt=3e3,Rt=3e4,Dt=1.3,Mt=3e4,At="server_kill",Ft=3;class qt extends nt{constructor(e,t,n,s,r,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=s,this.onServerInfoUpdate_=r,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=qt.nextPersistentConnectionId_++,this.log_=T("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=St,this.maxReconnectDelay_=Pt,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!(0,i.isNodeSdk)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");xt.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&st.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const s=++this.requestNumber_,r={r:s,a:e,b:t};this.log_((0,i.stringify)(r)),(0,i.assert)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),n&&(this.requestCBHash_[s]=n)}get(e){this.initConnection_();const t=new i.Deferred,n={p:e._path.toString(),q:e._queryObject},s={action:"g",request:n,onComplete:e=>{const i=e.d;"ok"===e.s?(this.onDataUpdate_(n.p,i,!1,null),t.resolve(i)):t.reject(i)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_||setTimeout(()=>{const e=this.outstandingGets_[r];void 0!==e&&s===e&&(delete this.outstandingGets_[r],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),this.log_("get "+r+" timed out on connection"),t.reject(new Error("Client is offline.")))},Nt),this.connected_&&this.sendGet_(r),t.promise}listen(e,t,n,s){this.initConnection_();const r=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+r),this.listens.has(o)||this.listens.set(o,new Map),(0,i.assert)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,i.assert)(!this.listens.get(o).has(r),"listen() called twice for same path/queryId.");const a={onComplete:s,hashFn:t,query:e,tag:n};this.listens.get(o).set(r,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)})}sendListen_(e){const t=e.query,n=t._path.toString(),i=t._queryIdentifier;this.log_("Listen on "+n+" for "+i);const s={p:n};e.tag&&(s.q=t._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest("q",s,s=>{const r=s.d,o=s.s;qt.warnOnListenWarnings_(r,t),(this.listens.get(n)&&this.listens.get(n).get(i))===e&&(this.log_("listen response",s),"ok"!==o&&this.removeListen_(n,i),e.onComplete&&e.onComplete(o,r))})}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&(0,i.contains)(e,"w")){const n=(0,i.safeGet)(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();I("Using an unspecified index. Your data will be downloaded and "+`filtered on the client. Consider adding ${e} at `+`${n} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||(0,i.isAdmin)(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Rt)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=(0,i.isValidFormat)(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,t=>{const n=t.s,i=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,i))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)})}unlisten(e,t){const n=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+s),(0,i.assert)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,s)&&this.connected_&&this.sendUnlisten_(n,s,e._queryObject,t)}sendUnlisten_(e,t,n,i){this.log_("Unlisten on "+e+" for "+t);const s={p:e};i&&(s.q=n,s.t=i),this.sendRequest("n",s)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,i){const s={p:t,d:n};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,e=>{i&&setTimeout(()=>{i(e.s,e.d)},Math.floor(0))})}put(e,t,n,i){this.putInternal("p",e,t,n,i)}merge(e,t,n,i){this.putInternal("m",e,t,n,i)}putInternal(e,t,n,i,s){this.initConnection_();const r={p:t,d:n};void 0!==s&&(r.h=s),this.outstandingPuts_.push({action:e,request:r,onComplete:i}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),i&&i(n.s,n.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+(0,i.stringify)(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):b("Unrecognized action received from server: "+(0,i.stringify)(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){(0,i.assert)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=St,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=St,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>Mt&&(this.reconnectDelay_=St),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Dt)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+qt.nextConnectionId_++,r=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,n())},h=function(e){(0,i.assert)(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(e)};this.realtime_={close:l,sendRequest:h};const c=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[i,h]=await Promise.all([this.authTokenProvider_.getToken(c),this.appCheckTokenProvider_.getToken(c)]);o?w("getToken() completed but was canceled"):(w("getToken() completed. Creating connection."),this.authToken_=i&&i.accessToken,this.appCheckToken_=h&&h.token,a=new tt(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,e=>{I(e+" ("+this.repoInfo_.toString()+")"),this.interrupt(At)},r))}catch(b){this.log_("Failed to get token: "+b),o||(this.repoInfo_.nodeAdmin&&I(b),l())}}}interrupt(e){w("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){w("Resuming connection for reason: "+e),delete this.interruptReasons_[e],(0,i.isEmpty)(this.interruptReasons_)&&(this.reconnectDelay_=St,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map(e=>A(e)).join("$"):"default";const i=this.removeListen_(e,n);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,t){const n=new at(e).toString();let i;if(this.listens.has(n)){const e=this.listens.get(n);i=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else i=void 0;return i}onAuthRevoked_(e,t){w("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Ft&&(this.reconnectDelay_=Rt,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){w("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Ft&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";(0,i.isNodeSdk)()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+a.replace(/\./g,"-")]=1,(0,i.isMobileCordova)()?e["framework.cordova"]=1:(0,i.isReactNative)()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=st.getInstance().currentlyOnline();return(0,i.isEmpty)(this.interruptReasons_)&&e}}qt.nextPersistentConnectionId_=0,qt.nextConnectionId_=0;class Lt{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Lt(e,t)}}class Ot{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new Lt(P,e),i=new Lt(P,t);return 0!==this.compare(n,i)}minPost(){return Lt.MIN}}let Wt;class Ut extends Ot{static get __EMPTY_NODE(){return Wt}static set __EMPTY_NODE(e){Wt=e}compare(e,t){return R(e.name,t.name)}isDefinedOn(e){throw(0,i.assertionError)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Lt.MIN}maxPost(){return new Lt(N,Wt)}makePost(e,t){return(0,i.assert)("string"==typeof e,"KeyIndex indexValue must always be a string."),new Lt(e,Wt)}toString(){return".key"}}const jt=new Ut;class Bt{constructor(e,t,n,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let r=1;for(;!e.isEmpty();)if(e=e,r=t?n(e.key,t):1,i&&(r*=-1),r<0)e=this.isReverse_?e.left:e.right;else{if(0===r){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Ht{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=null!=n?n:Ht.RED,this.left=null!=i?i:zt.EMPTY_NODE,this.right=null!=s?s:zt.EMPTY_NODE}copy(e,t,n,i,s){return new Ht(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=s?s:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const s=n(e,i.key);return(i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===s?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n))).fixUp_()}removeMin_(){if(this.left.isEmpty())return zt.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()}remove(e,t){let n,i;if(t(e,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return zt.EMPTY_NODE;i=n.right.min_(),n=n.copy(i.key,i.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Ht.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Ht.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Ht.RED=!0,Ht.BLACK=!1;class Vt{copy(e,t,n,i,s){return this}insert(e,t,n){return new Ht(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class zt{constructor(e,t=zt.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new zt(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Ht.BLACK,null,null))}remove(e){return new zt(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Ht.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,i=null;for(;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return i?i.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(i=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Bt(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Bt(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Bt(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Bt(this.root_,null,this.comparator_,!0,e)}}function Yt(e,t){return R(e.name,t.name)}function Qt(e,t){return R(e,t)}let Kt;function Gt(e){Kt=e}zt.EMPTY_NODE=new Vt;const $t=function(e){return"number"==typeof e?"number:"+L(e):"string:"+e},Xt=function(e){if(e.isLeafNode()){const t=e.val();(0,i.assert)("string"==typeof t||"number"==typeof t||"object"==typeof t&&(0,i.contains)(t,".sv"),"Priority must be a string or number.")}else(0,i.assert)(e===Kt||e.isEmpty(),"priority of unexpected type.");(0,i.assert)(e===Kt||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Jt,Zt,en;class tn{constructor(e,t=tn.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,(0,i.assert)(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Xt(this.priorityNode_)}static set __childrenNodeConstructor(e){Jt=e}static get __childrenNodeConstructor(){return Jt}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new tn(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:tn.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return mt(e)?this:".priority"===ht(e)?this.priorityNode_:tn.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:tn.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=ht(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:((0,i.assert)(".priority"!==n||1===ct(e),".priority must be the last token in a path"),this.updateImmediateChild(n,tn.__childrenNodeConstructor.EMPTY_NODE.updateChild(ut(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+$t(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?L(this.value_):this.value_,this.lazyHash_=g(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===tn.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof tn.__childrenNodeConstructor?-1:((0,i.assert)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,s=tn.VALUE_TYPE_ORDER.indexOf(t),r=tn.VALUE_TYPE_ORDER.indexOf(n);return(0,i.assert)(s>=0,"Unknown leaf type: "+t),(0,i.assert)(r>=0,"Unknown leaf type: "+n),s===r?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:r-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}function nn(e){Zt=e}function sn(e){en=e}tn.VALUE_TYPE_ORDER=["object","boolean","number","string"];class rn extends Ot{compare(e,t){const n=e.node.getPriority(),i=t.node.getPriority(),s=n.compareTo(i);return 0===s?R(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Lt.MIN}maxPost(){return new Lt(N,new tn("[PRIORITY-POST]",en))}makePost(e,t){const n=Zt(e);return new Lt(t,new tn("[PRIORITY-POST]",n))}toString(){return".priority"}}const on=new rn,an=Math.log(2);class ln{constructor(e){this.count=(e=>parseInt(Math.log(e)/an,10))(e+1),this.current_=this.count-1;const t=(e=>parseInt(Array(e+1).join("1"),2))(this.count);this.bits_=e+1&t}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const hn=function(e,t,n,i){e.sort(t);const s=function(t,i){const r=i-t;let o,a;if(0===r)return null;if(1===r)return o=e[t],a=n?n(o):o,new Ht(a,o.node,Ht.BLACK,null,null);{const l=parseInt(r/2,10)+t,h=s(t,l),c=s(l+1,i);return o=e[l],a=n?n(o):o,new Ht(a,o.node,Ht.BLACK,h,c)}},r=function(t){let i=null,r=null,o=e.length;const a=function(t,i){const r=o-t,a=o;o-=t;const h=s(r+1,a),c=e[r],u=n?n(c):c;l(new Ht(u,c.node,i,null,h))},l=function(e){i?(i.left=e,i=e):(r=e,i=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),i=Math.pow(2,t.count-(e+1));n?a(i,Ht.BLACK):(a(i,Ht.BLACK),a(i,Ht.RED))}return r}(new ln(e.length));return new zt(i||t,r)};let cn;const un={};class dn{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return(0,i.assert)(un&&on,"ChildrenNode.ts has not been loaded"),cn=cn||new dn({".priority":un},{".priority":on})}get(e){const t=(0,i.safeGet)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof zt?t:null}hasIndex(e){return(0,i.contains)(this.indexSet_,e.toString())}addIndex(e,t){(0,i.assert)(e!==jt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let s=!1;const r=t.getIterator(Lt.Wrap);let o,a=r.getNext();for(;a;)s=s||e.isDefinedOn(a.node),n.push(a),a=r.getNext();o=s?hn(n,e.getCompare()):un;const l=e.toString(),h=Object.assign({},this.indexSet_);h[l]=e;const c=Object.assign({},this.indexes_);return c[l]=o,new dn(c,h)}addToIndexes(e,t){const n=(0,i.map)(this.indexes_,(n,s)=>{const r=(0,i.safeGet)(this.indexSet_,s);if((0,i.assert)(r,"Missing index implementation for "+s),n===un){if(r.isDefinedOn(e.node)){const n=[],i=t.getIterator(Lt.Wrap);let s=i.getNext();for(;s;)s.name!==e.name&&n.push(s),s=i.getNext();return n.push(e),hn(n,r.getCompare())}return un}{const i=t.get(e.name);let s=n;return i&&(s=s.remove(new Lt(e.name,i))),s.insert(e,e.node)}});return new dn(n,this.indexSet_)}removeFromIndexes(e,t){const n=(0,i.map)(this.indexes_,n=>{if(n===un)return n;{const i=t.get(e.name);return i?n.remove(new Lt(e.name,i)):n}});return new dn(n,this.indexSet_)}}let pn;class _n{constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Xt(this.priorityNode_),this.children_.isEmpty()&&(0,i.assert)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return pn||(pn=new _n(new zt(Qt),null,dn.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||pn}updatePriority(e){return this.children_.isEmpty()?this:new _n(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?pn:t}}getChild(e){const t=ht(e);return null===t?this:this.getImmediateChild(t).getChild(ut(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if((0,i.assert)(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new Lt(e,t);let i,s;t.isEmpty()?(i=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(n,this.children_)):(i=this.children_.insert(e,t),s=this.indexMap_.addToIndexes(n,this.children_));const r=i.isEmpty()?pn:this.priorityNode_;return new _n(i,r,s)}}updateChild(e,t){const n=ht(e);if(null===n)return t;{(0,i.assert)(".priority"!==ht(e)||1===ct(e),".priority must be the last token in a path");const s=this.getImmediateChild(n).updateChild(ut(e),t);return this.updateImmediateChild(n,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,i=0,s=!0;if(this.forEachChild(on,(r,o)=>{t[r]=o.val(e),n++,s&&_n.INTEGER_REGEXP_.test(r)?i=Math.max(i,Number(r)):s=!1}),!e&&s&&i<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+$t(this.getPriority().val())+":"),this.forEachChild(on,(t,n)=>{const i=n.hash();""!==i&&(e+=":"+t+":"+i)}),this.lazyHash_=""===e?"":g(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const i=this.resolveIndex_(n);if(i){const n=i.getPredecessorKey(new Lt(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Lt(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Lt(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal(e=>t(e.name,e.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,e=>e);{const n=this.children_.getIteratorFrom(e.name,Lt.Wrap);let i=n.peek();for(;null!=i&&t.compare(i,e)<0;)n.getNext(),i=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,e=>e);{const n=this.children_.getReverseIteratorFrom(e.name,Lt.Wrap);let i=n.peek();for(;null!=i&&t.compare(i,e)>0;)n.getNext(),i=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===gn?-1:0}withIndex(e){if(e===jt||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new _n(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===jt||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(on),n=t.getIterator(on);let i=e.getNext(),s=n.getNext();for(;i&&s;){if(i.name!==s.name||!i.node.equals(s.node))return!1;i=e.getNext(),s=n.getNext()}return null===i&&null===s}return!1}return!1}}resolveIndex_(e){return e===jt?null:this.indexMap_.get(e.toString())}}_n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class fn extends _n{constructor(){super(new zt(Qt),_n.EMPTY_NODE,dn.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return _n.EMPTY_NODE}isEmpty(){return!1}}const gn=new fn;Object.defineProperties(Lt,{MIN:{value:new Lt(P,_n.EMPTY_NODE)},MAX:{value:new Lt(N,gn)}}),Ut.__EMPTY_NODE=_n.EMPTY_NODE,tn.__childrenNodeConstructor=_n,Gt(gn),sn(gn);const mn=!0;function yn(e,t=null){if(null===e)return _n.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),(0,i.assert)(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e){return new tn(e,yn(t))}if(e instanceof Array||!mn){let n=_n.EMPTY_NODE;return q(e,(t,s)=>{if((0,i.contains)(e,t)&&"."!==t.substring(0,1)){const e=yn(s);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}}),n.updatePriority(yn(t))}{const n=[];let i=!1;if(q(e,(e,t)=>{if("."!==e.substring(0,1)){const s=yn(t);s.isEmpty()||(i=i||!s.getPriority().isEmpty(),n.push(new Lt(e,s)))}}),0===n.length)return _n.EMPTY_NODE;const s=hn(n,Yt,e=>e.name,Qt);if(i){const e=hn(n,on.getCompare());return new _n(s,yn(t),new dn({".priority":e},{".priority":on}))}return new _n(s,yn(t),dn.Default)}}nn(yn);class vn extends Ot{constructor(e){super(),this.indexPath_=e,(0,i.assert)(!mt(e)&&".priority"!==ht(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),i=this.extractChild(t.node),s=n.compareTo(i);return 0===s?R(e.name,t.name):s}makePost(e,t){const n=yn(e),i=_n.EMPTY_NODE.updateChild(this.indexPath_,n);return new Lt(t,i)}maxPost(){const e=_n.EMPTY_NODE.updateChild(this.indexPath_,gn);return new Lt(N,e)}toString(){return _t(this.indexPath_,0).join("/")}}class Cn extends Ot{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?R(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Lt.MIN}maxPost(){return Lt.MAX}makePost(e,t){const n=yn(e);return new Lt(t,n)}toString(){return".value"}}const wn=new Cn,Tn="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",bn="-",kn="z",In=786,En=function(){let e=0;const t=[];return function(n){const s=n===e;let r;e=n;const o=new Array(8);for(r=7;r>=0;r--)o[r]=Tn.charAt(n%64),n=Math.floor(n/64);(0,i.assert)(0===n,"Cannot push at time == 0");let a=o.join("");if(s){for(r=11;r>=0&&63===t[r];r--)t[r]=0;t[r]++}else for(r=0;r<12;r++)t[r]=Math.floor(64*Math.random());for(r=0;r<12;r++)a+=Tn.charAt(t[r]);return(0,i.assert)(20===a.length,"nextPushId: Length should be 20."),a}}(),xn=function(e){if("2147483647"===e)return"-";const t=V(e);if(null!=t)return""+(t+1);const n=new Array(e.length);for(let o=0;o<n.length;o++)n[o]=e.charAt(o);if(n.length<786)return n.push("-"),n.join("");let i=n.length-1;for(;i>=0&&"z"===n[i];)i--;if(-1===i)return N;const s=n[i],r=Tn.charAt(Tn.indexOf(s)+1);return n[i]=r,n.slice(0,i+1).join("")},Sn=function(e){if("-2147483648"===e)return P;const t=V(e);if(null!=t)return""+(t-1);const n=new Array(e.length);for(let i=0;i<n.length;i++)n[i]=e.charAt(i);return"-"===n[n.length-1]?1===n.length?"2147483647":(delete n[n.length-1],n.join("")):(n[n.length-1]=Tn.charAt(Tn.indexOf(n[n.length-1])-1),n.join("")+"z".repeat(786-n.length))};function Pn(e){return{type:"value",snapshotNode:e}}function Nn(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function Rn(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function Dn(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}function Mn(e,t){return{type:"child_moved",snapshotNode:t,childName:e}}class An{constructor(e){this.index_=e}updateChild(e,t,n,s,r,o){(0,i.assert)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(t);return a.getChild(s).equals(n.getChild(s))&&a.isEmpty()===n.isEmpty()?e:(null!=o&&(n.isEmpty()?e.hasChild(t)?o.trackChildChange(Rn(t,a)):(0,i.assert)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Nn(t,n)):o.trackChildChange(Dn(t,n,a))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(on,(e,i)=>{t.hasChild(e)||n.trackChildChange(Rn(e,i))}),t.isLeafNode()||t.forEachChild(on,(t,i)=>{if(e.hasChild(t)){const s=e.getImmediateChild(t);s.equals(i)||n.trackChildChange(Dn(t,i,s))}else n.trackChildChange(Nn(t,i))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?_n.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class Fn{constructor(e){this.indexedFilter_=new An(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Fn.getStartPost_(e),this.endPost_=Fn.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,t,n,i,s,r){return this.matches(new Lt(t,n))||(n=_n.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,i,s,r)}updateFullNode(e,t,n){t.isLeafNode()&&(t=_n.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(_n.EMPTY_NODE);const s=this;return t.forEachChild(on,(e,t)=>{s.matches(new Lt(e,t))||(i=i.updateImmediateChild(e,_n.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class qn{constructor(e){this.rangedFilter_=new Fn(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,t,n,i,s,r){return this.rangedFilter_.matches(new Lt(t,n))||(n=_n.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,i,s,r):this.fullLimitUpdateChild_(e,t,n,s,r)}updateFullNode(e,t,n){let i;if(t.isLeafNode()||t.isEmpty())i=_n.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;i=_n.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();let s;if(!(s=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),t)<=0:this.index_.compare(t,this.rangedFilter_.getEndPost())<=0))break;i=i.updateImmediateChild(t.name,t.node),n++}}else{let e,n,s,r;if(i=(i=t.withIndex(this.index_)).updatePriority(_n.EMPTY_NODE),this.reverse_){r=i.getReverseIterator(this.index_),e=this.rangedFilter_.getEndPost(),n=this.rangedFilter_.getStartPost();const t=this.index_.getCompare();s=((e,n)=>t(n,e))}else r=i.getIterator(this.index_),e=this.rangedFilter_.getStartPost(),n=this.rangedFilter_.getEndPost(),s=this.index_.getCompare();let o=0,a=!1;for(;r.hasNext();){const t=r.getNext();!a&&s(e,t)<=0&&(a=!0),a&&o<this.limit_&&s(t,n)<=0?o++:i=i.updateImmediateChild(t.name,_n.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,s,r){let o;if(this.reverse_){const e=this.index_.getCompare();o=((t,n)=>e(n,t))}else o=this.index_.getCompare();const a=e;(0,i.assert)(a.numChildren()===this.limit_,"");const l=new Lt(t,n),h=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),c=this.rangedFilter_.matches(l);if(a.hasChild(t)){const e=a.getImmediateChild(t);let i=s.getChildAfterChild(this.index_,h,this.reverse_);for(;null!=i&&(i.name===t||a.hasChild(i.name));)i=s.getChildAfterChild(this.index_,i,this.reverse_);const u=null==i?1:o(i,l);if(c&&!n.isEmpty()&&u>=0)return null!=r&&r.trackChildChange(Dn(t,n,e)),a.updateImmediateChild(t,n);{null!=r&&r.trackChildChange(Rn(t,e));const n=a.updateImmediateChild(t,_n.EMPTY_NODE);return null!=i&&this.rangedFilter_.matches(i)?(null!=r&&r.trackChildChange(Nn(i.name,i.node)),n.updateImmediateChild(i.name,i.node)):n}}return n.isEmpty()?e:c&&o(h,l)>=0?(null!=r&&(r.trackChildChange(Rn(h.name,h.node)),r.trackChildChange(Nn(t,n))),a.updateImmediateChild(t,n).updateImmediateChild(h.name,_n.EMPTY_NODE)):e}}class Ln{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=on}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,i.assert)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,i.assert)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:P}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,i.assert)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,i.assert)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:N}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,i.assert)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===on}copy(){const e=new Ln;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function On(e){return e.loadsAllData()?new An(e.getIndex()):e.hasLimit()?new qn(e):new Fn(e)}function Wn(e,t){const n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="l",n}function Un(e,t){const n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="r",n}function jn(e,t,n){const i=e.copy();return i.startSet_=!0,void 0===t&&(t=null),i.indexStartValue_=t,null!=n?(i.startNameSet_=!0,i.indexStartName_=n):(i.startNameSet_=!1,i.indexStartName_=""),i}function Bn(e,t,n){let i;if(e.index_===jt)"string"==typeof t&&(t=xn(t)),i=jn(e,t,n);else{let s;i=jn(e,t,s=null==n?N:xn(n))}return i.startAfterSet_=!0,i}function Hn(e,t,n){const i=e.copy();return i.endSet_=!0,void 0===t&&(t=null),i.indexEndValue_=t,void 0!==n?(i.endNameSet_=!0,i.indexEndName_=n):(i.endNameSet_=!1,i.indexEndName_=""),i}function Vn(e,t,n){let i,s;return e.index_===jt?("string"==typeof t&&(t=Sn(t)),s=Hn(e,t,n)):s=Hn(e,t,i=null==n?P:Sn(n)),s.endBeforeSet_=!0,s}function zn(e,t){const n=e.copy();return n.index_=t,n}function Yn(e){const t={};if(e.isDefault())return t;let n;return e.index_===on?n="$priority":e.index_===wn?n="$value":e.index_===jt?n="$key":((0,i.assert)(e.index_ instanceof vn,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=(0,i.stringify)(n),e.startSet_&&(t.startAt=(0,i.stringify)(e.indexStartValue_),e.startNameSet_&&(t.startAt+=","+(0,i.stringify)(e.indexStartName_))),e.endSet_&&(t.endAt=(0,i.stringify)(e.indexEndValue_),e.endNameSet_&&(t.endAt+=","+(0,i.stringify)(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function Qn(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_)),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_)),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==on&&(t.i=e.index_.toString()),t}exports._QueryParams=Ln;class Kn extends nt{constructor(e,t,n,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=i,this.log_=T("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,i.assert)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,n,s){const r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);const o=Kn.getListenId_(e,n),a={};this.listens_[o]=a;const l=Yn(e._queryParams);this.restRequest_(r+".json",l,(e,t)=>{let l=t;if(404===e&&(l=null,e=null),null===e&&this.onDataUpdate_(r,l,!1,n),(0,i.safeGet)(this.listens_,o)===a){let t;s(t=e?401===e?"permission_denied":"rest_error:"+e:"ok",null)}})}unlisten(e,t){const n=Kn.getListenId_(e,t);delete this.listens_[n]}get(e){const t=Yn(e._queryParams),n=e._path.toString(),s=new i.Deferred;return this.restRequest_(n+".json",t,(e,t)=>{let i=t;404===e&&(i=null,e=null),null===e?(this.onDataUpdate_(n,i,!1,null),s.resolve(i)):s.reject(new Error(i))}),s.promise}refreshAuthToken(e){}restRequest_(e,t={},n){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,r])=>{s&&s.accessToken&&(t.auth=s.accessToken),r&&r.token&&(t.ac=r.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,i.querystring)(t);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=(()=>{if(n&&4===a.readyState){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let t=null;if(a.status>=200&&a.status<300){try{t=(0,i.jsonEval)(a.responseText)}catch(e){I("Failed to parse JSON response for "+o+": "+a.responseText)}n(null,t)}else 401!==a.status&&404!==a.status&&I("Got unsuccessful REST response for "+o+" Status: "+a.status),n(a.status);n=null}}),a.open("GET",o,!0),a.send()})}}class Gn{constructor(){this.rootNode_=_n.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function $n(){return{value:null,children:new Map}}function Xn(e,t,n){if(mt(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const i=ht(t);e.children.has(i)||e.children.set(i,$n()),Xn(e.children.get(i),t=ut(t),n)}}function Jn(e,t){if(mt(t))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;{const n=e.value;return e.value=null,n.forEachChild(on,(t,n)=>{Xn(e,new at(t),n)}),Jn(e,t)}}if(e.children.size>0){const n=ht(t);if(t=ut(t),e.children.has(n)){Jn(e.children.get(n),t)&&e.children.delete(n)}return 0===e.children.size}return!0}function Zn(e,t,n){null!==e.value?n(t,e.value):ei(e,(e,i)=>{Zn(i,new at(t.toString()+"/"+e),n)})}function ei(e,t){e.children.forEach((e,n)=>{t(n,e)})}class ti{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&q(this.last_,(e,n)=>{t[e]=t[e]-n}),this.last_=e,t}}const ni=1e4,ii=3e4,si=3e5;class ri{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new ti(e);const n=ni+(ii-ni)*Math.random();Q(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;q(e,(e,s)=>{s>0&&(0,i.contains)(this.statsToReport_,e)&&(t[e]=s,n=!0)}),n&&this.server_.reportStats(t),Q(this.reportStats_.bind(this),Math.floor(2*Math.random()*si))}}var oi;function ai(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function li(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function hi(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(oi||(oi={}));class ci{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=oi.ACK_USER_WRITE,this.source=ai()}operationForChild(e){if(mt(this.path)){if(null!=this.affectedTree.value)return(0,i.assert)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new at(e));return new ci(lt(),t,this.revert)}}return(0,i.assert)(ht(this.path)===e,"operationForChild called for unrelated child."),new ci(ut(this.path),this.affectedTree,this.revert)}}class ui{constructor(e,t){this.source=e,this.path=t,this.type=oi.LISTEN_COMPLETE}operationForChild(e){return mt(this.path)?new ui(this.source,lt()):new ui(this.source,ut(this.path))}}class di{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=oi.OVERWRITE}operationForChild(e){return mt(this.path)?new di(this.source,lt(),this.snap.getImmediateChild(e)):new di(this.source,ut(this.path),this.snap)}}class pi{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=oi.MERGE}operationForChild(e){if(mt(this.path)){const t=this.children.subtree(new at(e));return t.isEmpty()?null:t.value?new di(this.source,lt(),t.value):new pi(this.source,lt(),t)}return(0,i.assert)(ht(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new pi(this.source,ut(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class _i{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(mt(e))return this.isFullyInitialized()&&!this.filtered_;const t=ht(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class fi{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function gi(e,t,n,i){const s=[],r=[];return t.forEach(t=>{"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&r.push(Mn(t.childName,t.snapshotNode))}),mi(e,s,"child_removed",t,i,n),mi(e,s,"child_added",t,i,n),mi(e,s,"child_moved",r,i,n),mi(e,s,"child_changed",t,i,n),mi(e,s,"value",t,i,n),s}function mi(e,t,n,i,s,r){const o=i.filter(e=>e.type===n);o.sort((t,n)=>vi(e,t,n)),o.forEach(n=>{const i=yi(e,n,r);s.forEach(s=>{s.respondsTo(n.type)&&t.push(s.createEvent(i,e.query_))})})}function yi(e,t,n){return"value"===t.type||"child_removed"===t.type?t:(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_),t)}function vi(e,t,n){if(null==t.childName||null==n.childName)throw(0,i.assertionError)("Should only compare child_ events.");const s=new Lt(t.childName,t.snapshotNode),r=new Lt(n.childName,n.snapshotNode);return e.index_.compare(s,r)}function Ci(e,t){return{eventCache:e,serverCache:t}}function wi(e,t,n,i){return Ci(new _i(t,n,i),e.serverCache)}function Ti(e,t,n,i){return Ci(e.eventCache,new _i(t,n,i))}function bi(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function ki(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let Ii;const Ei=()=>(Ii||(Ii=new zt(D)),Ii);class xi{constructor(e,t=Ei()){this.value=e,this.children=t}static fromObject(e){let t=new xi(null);return q(e,(e,n)=>{t=t.set(new at(e),n)}),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:lt(),value:this.value};if(mt(e))return null;{const n=ht(e),i=this.children.get(n);if(null!==i){const s=i.findRootMostMatchingPathAndValue(ut(e),t);if(null!=s){return{path:gt(new at(n),s.path),value:s.value}}return null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(mt(e))return this;{const t=ht(e),n=this.children.get(t);return null!==n?n.subtree(ut(e)):new xi(null)}}set(e,t){if(mt(e))return new xi(t,this.children);{const n=ht(e),i=(this.children.get(n)||new xi(null)).set(ut(e),t),s=this.children.insert(n,i);return new xi(this.value,s)}}remove(e){if(mt(e))return this.children.isEmpty()?new xi(null):new xi(null,this.children);{const t=ht(e),n=this.children.get(t);if(n){const i=n.remove(ut(e));let s;return s=i.isEmpty()?this.children.remove(t):this.children.insert(t,i),null===this.value&&s.isEmpty()?new xi(null):new xi(this.value,s)}return this}}get(e){if(mt(e))return this.value;{const t=ht(e),n=this.children.get(t);return n?n.get(ut(e)):null}}setTree(e,t){if(mt(e))return t;{const n=ht(e),i=(this.children.get(n)||new xi(null)).setTree(ut(e),t);let s;return s=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),new xi(this.value,s)}}fold(e){return this.fold_(lt(),e)}fold_(e,t){const n={};return this.children.inorderTraversal((i,s)=>{n[i]=s.fold_(gt(e,i),t)}),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,lt(),t)}findOnPath_(e,t,n){const i=!!this.value&&n(t,this.value);if(i)return i;if(mt(e))return null;{const i=ht(e),s=this.children.get(i);return s?s.findOnPath_(ut(e),gt(t,i),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,lt(),t)}foreachOnPath_(e,t,n){if(mt(e))return this;{this.value&&n(t,this.value);const i=ht(e),s=this.children.get(i);return s?s.foreachOnPath_(ut(e),gt(t,i),n):new xi(null)}}foreach(e){this.foreach_(lt(),e)}foreach_(e,t){this.children.inorderTraversal((n,i)=>{i.foreach_(gt(e,n),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,n)=>{n.value&&e(t,n.value)})}}class Si{constructor(e){this.writeTree_=e}static empty(){return new Si(new xi(null))}}function Pi(e,t,n){if(mt(t))return new Si(new xi(n));{const i=e.writeTree_.findRootMostValueAndPath(t);if(null!=i){const s=i.path;let r=i.value;const o=yt(s,t);return r=r.updateChild(o,n),new Si(e.writeTree_.set(s,r))}{const i=new xi(n),s=e.writeTree_.setTree(t,i);return new Si(s)}}}function Ni(e,t,n){let i=e;return q(n,(e,n)=>{i=Pi(i,gt(t,e),n)}),i}function Ri(e,t){if(mt(t))return Si.empty();{const n=e.writeTree_.setTree(t,new xi(null));return new Si(n)}}function Di(e,t){return null!=Mi(e,t)}function Mi(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(yt(n.path,t)):null}function Ai(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(on,(e,n)=>{t.push(new Lt(e,n))}):e.writeTree_.children.inorderTraversal((e,n)=>{null!=n.value&&t.push(new Lt(e,n.value))}),t}function Fi(e,t){if(mt(t))return e;{const n=Mi(e,t);return new Si(null!=n?new xi(n):e.writeTree_.subtree(t))}}function qi(e){return e.writeTree_.isEmpty()}function Li(e,t){return Oi(lt(),e.writeTree_,t)}function Oi(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let s=null;return t.children.inorderTraversal((t,r)=>{".priority"===t?((0,i.assert)(null!==r.value,"Priority writes must always be leaf nodes"),s=r.value):n=Oi(gt(e,t),r,n)}),n.getChild(e).isEmpty()||null===s||(n=n.updateChild(gt(e,".priority"),s)),n}}function Wi(e,t){return ls(t,e)}function Ui(e,t,n,s,r){(0,i.assert)(s>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),e.allWrites.push({path:t,snap:n,writeId:s,visible:r}),r&&(e.visibleWrites=Pi(e.visibleWrites,t,n)),e.lastWriteId=s}function ji(e,t,n,s){(0,i.assert)(s>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:n,writeId:s,visible:!0}),e.visibleWrites=Ni(e.visibleWrites,t,n),e.lastWriteId=s}function Bi(e,t){for(let n=0;n<e.allWrites.length;n++){const i=e.allWrites[n];if(i.writeId===t)return i}return null}function Hi(e,t){const n=e.allWrites.findIndex(e=>e.writeId===t);(0,i.assert)(n>=0,"removeWrite called with nonexistent writeId.");const s=e.allWrites[n];e.allWrites.splice(n,1);let r=s.visible,o=!1,a=e.allWrites.length-1;for(;r&&a>=0;){const t=e.allWrites[a];t.visible&&(a>=n&&Vi(t,s.path)?r=!1:wt(s.path,t.path)&&(o=!0)),a--}if(r){if(o)return zi(e),!0;if(s.snap)e.visibleWrites=Ri(e.visibleWrites,s.path);else{q(s.children,t=>{e.visibleWrites=Ri(e.visibleWrites,gt(s.path,t))})}return!0}return!1}function Vi(e,t){if(e.snap)return wt(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&wt(gt(e.path,n),t))return!0;return!1}function zi(e){e.visibleWrites=Qi(e.allWrites,Yi,lt()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}function Yi(e){return e.visible}function Qi(e,t,n){let s=Si.empty();for(let r=0;r<e.length;++r){const o=e[r];if(t(o)){const e=o.path;let t;if(o.snap)wt(n,e)?s=Pi(s,t=yt(n,e),o.snap):wt(e,n)&&(t=yt(e,n),s=Pi(s,lt(),o.snap.getChild(t)));else{if(!o.children)throw(0,i.assertionError)("WriteRecord should have .snap or .children");if(wt(n,e))s=Ni(s,t=yt(n,e),o.children);else if(wt(e,n))if(mt(t=yt(e,n)))s=Ni(s,lt(),o.children);else{const e=(0,i.safeGet)(o.children,ht(t));if(e){const n=e.getChild(ut(t));s=Pi(s,lt(),n)}}}}}return s}function Ki(e,t,n,i,s){if(i||s){const r=Fi(e.visibleWrites,t);if(!s&&qi(r))return n;if(s||null!=n||Di(r,lt())){const r=function(e){return(e.visible||s)&&(!i||!~i.indexOf(e.writeId))&&(wt(e.path,t)||wt(t,e.path))};return Li(Qi(e.allWrites,r,t),n||_n.EMPTY_NODE)}return null}{const i=Mi(e.visibleWrites,t);if(null!=i)return i;{const i=Fi(e.visibleWrites,t);if(qi(i))return n;if(null!=n||Di(i,lt())){return Li(i,n||_n.EMPTY_NODE)}return null}}}function Gi(e,t,n){let i=_n.EMPTY_NODE;const s=Mi(e.visibleWrites,t);if(s)return s.isLeafNode()||s.forEachChild(on,(e,t)=>{i=i.updateImmediateChild(e,t)}),i;if(n){const s=Fi(e.visibleWrites,t);return n.forEachChild(on,(e,t)=>{const n=Li(Fi(s,new at(e)),t);i=i.updateImmediateChild(e,n)}),Ai(s).forEach(e=>{i=i.updateImmediateChild(e.name,e.node)}),i}return Ai(Fi(e.visibleWrites,t)).forEach(e=>{i=i.updateImmediateChild(e.name,e.node)}),i}function $i(e,t,n,s,r){(0,i.assert)(s||r,"Either existingEventSnap or existingServerSnap must exist");const o=gt(t,n);if(Di(e.visibleWrites,o))return null;{const t=Fi(e.visibleWrites,o);return qi(t)?r.getChild(n):Li(t,r.getChild(n))}}function Xi(e,t,n,i){const s=gt(t,n),r=Mi(e.visibleWrites,s);if(null!=r)return r;if(i.isCompleteForChild(n)){return Li(Fi(e.visibleWrites,s),i.getNode().getImmediateChild(n))}return null}function Ji(e,t){return Mi(e.visibleWrites,t)}function Zi(e,t,n,i,s,r,o){let a;const l=Fi(e.visibleWrites,t),h=Mi(l,lt());if(null!=h)a=h;else{if(null==n)return[];a=Li(l,n)}if((a=a.withIndex(o)).isEmpty()||a.isLeafNode())return[];{const e=[],t=o.getCompare(),n=r?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o);let l=n.getNext();for(;l&&e.length<s;)0!==t(l,i)&&e.push(l),l=n.getNext();return e}}function es(){return{visibleWrites:Si.empty(),allWrites:[],lastWriteId:-1}}function ts(e,t,n,i){return Ki(e.writeTree,e.treePath,t,n,i)}function ns(e,t){return Gi(e.writeTree,e.treePath,t)}function is(e,t,n,i){return $i(e.writeTree,e.treePath,t,n,i)}function ss(e,t){return Ji(e.writeTree,gt(e.treePath,t))}function rs(e,t,n,i,s,r){return Zi(e.writeTree,e.treePath,t,n,i,s,r)}function os(e,t,n){return Xi(e.writeTree,e.treePath,t,n)}function as(e,t){return ls(gt(e.treePath,t),e.writeTree)}function ls(e,t){return{treePath:e,writeTree:t}}class hs{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;(0,i.assert)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,i.assert)(".priority"!==n,"Only non-priority child changes can be tracked.");const s=this.changeMap.get(n);if(s){const r=s.type;if("child_added"===t&&"child_removed"===r)this.changeMap.set(n,Dn(n,e.snapshotNode,s.snapshotNode));else if("child_removed"===t&&"child_added"===r)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===r)this.changeMap.set(n,Rn(n,s.oldSnap));else if("child_changed"===t&&"child_added"===r)this.changeMap.set(n,Nn(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==r)throw(0,i.assertionError)("Illegal combination of changes: "+e+" occurred after "+s);this.changeMap.set(n,Dn(n,e.snapshotNode,s.oldSnap))}}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}class cs{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}}const us=new cs;class ds{constructor(e,t,n=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new _i(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return os(this.writes_,e,t)}}getChildAfterChild(e,t,n){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:ki(this.viewCache_),s=rs(this.writes_,i,t,1,n,e);return 0===s.length?null:s[0]}}function ps(e){return{filter:e}}function _s(e,t){(0,i.assert)(t.eventCache.getNode().isIndexed(e.filter.getIndex()),"Event snap not indexed"),(0,i.assert)(t.serverCache.getNode().isIndexed(e.filter.getIndex()),"Server snap not indexed")}function fs(e,t,n,s,r){const o=new hs;let a,l;if(n.type===oi.OVERWRITE){const h=n;h.source.fromUser?a=vs(e,t,h.path,h.snap,s,r,o):((0,i.assert)(h.source.fromServer,"Unknown source."),l=h.source.tagged||t.serverCache.isFiltered()&&!mt(h.path),a=ys(e,t,h.path,h.snap,s,r,l,o))}else if(n.type===oi.MERGE){const h=n;h.source.fromUser?a=ws(e,t,h.path,h.children,s,r,o):((0,i.assert)(h.source.fromServer,"Unknown source."),l=h.source.tagged||t.serverCache.isFiltered(),a=bs(e,t,h.path,h.children,s,r,l,o))}else if(n.type===oi.ACK_USER_WRITE){const i=n;a=i.revert?Es(e,t,i.path,s,r,o):ks(e,t,i.path,i.affectedTree,s,r,o)}else{if(n.type!==oi.LISTEN_COMPLETE)throw(0,i.assertionError)("Unknown operation type: "+n.type);a=Is(e,t,n.path,s,o)}const h=o.getChanges();return gs(t,a,h),{viewCache:a,changes:h}}function gs(e,t,n){const i=t.eventCache;if(i.isFullyInitialized()){const s=i.getNode().isLeafNode()||i.getNode().isEmpty(),r=bi(e);(n.length>0||!e.eventCache.isFullyInitialized()||s&&!i.getNode().equals(r)||!i.getNode().getPriority().equals(r.getPriority()))&&n.push(Pn(bi(t)))}}function ms(e,t,n,s,r,o){const a=t.eventCache;if(null!=ss(s,n))return t;{let l,h;if(mt(n))if((0,i.assert)(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=ki(t),i=ns(s,n instanceof _n?n:_n.EMPTY_NODE);l=e.filter.updateFullNode(t.eventCache.getNode(),i,o)}else{const n=ts(s,ki(t));l=e.filter.updateFullNode(t.eventCache.getNode(),n,o)}else{const c=ht(n);if(".priority"===c){(0,i.assert)(1===ct(n),"Can't have a priority with additional path components");const r=a.getNode(),o=is(s,n,r,h=t.serverCache.getNode());l=null!=o?e.filter.updatePriority(r,o):a.getNode()}else{const i=ut(n);let u;if(a.isCompleteForChild(c)){h=t.serverCache.getNode();const e=is(s,n,a.getNode(),h);u=null!=e?a.getNode().getImmediateChild(c).updateChild(i,e):a.getNode().getImmediateChild(c)}else u=os(s,c,t.serverCache);l=null!=u?e.filter.updateChild(a.getNode(),c,u,i,r,o):a.getNode()}}return wi(t,l,a.isFullyInitialized()||mt(n),e.filter.filtersNodes())}}function ys(e,t,n,i,s,r,o,a){const l=t.serverCache;let h;const c=o?e.filter:e.filter.getIndexedFilter();if(mt(n))h=c.updateFullNode(l.getNode(),i,null);else if(c.filtersNodes()&&!l.isFiltered()){const e=l.getNode().updateChild(n,i);h=c.updateFullNode(l.getNode(),e,null)}else{const e=ht(n);if(!l.isCompleteForPath(n)&&ct(n)>1)return t;const s=ut(n),r=l.getNode().getImmediateChild(e).updateChild(s,i);h=".priority"===e?c.updatePriority(l.getNode(),r):c.updateChild(l.getNode(),e,r,s,us,null)}const u=Ti(t,h,l.isFullyInitialized()||mt(n),c.filtersNodes());return ms(e,u,n,s,new ds(s,u,r),a)}function vs(e,t,n,i,s,r,o){const a=t.eventCache;let l,h;const c=new ds(s,t,r);if(mt(n))h=e.filter.updateFullNode(t.eventCache.getNode(),i,o),l=wi(t,h,!0,e.filter.filtersNodes());else{const s=ht(n);if(".priority"===s)h=e.filter.updatePriority(t.eventCache.getNode(),i),l=wi(t,h,a.isFullyInitialized(),a.isFiltered());else{const r=ut(n),h=a.getNode().getImmediateChild(s);let u;if(mt(r))u=i;else{const e=c.getCompleteChild(s);u=null!=e?".priority"===dt(r)&&e.getChild(ft(r)).isEmpty()?e:e.updateChild(r,i):_n.EMPTY_NODE}if(h.equals(u))l=t;else{l=wi(t,e.filter.updateChild(a.getNode(),s,u,r,c,o),a.isFullyInitialized(),e.filter.filtersNodes())}}}return l}function Cs(e,t){return e.eventCache.isCompleteForChild(t)}function ws(e,t,n,i,s,r,o){let a=t;return i.foreach((i,l)=>{const h=gt(n,i);Cs(t,ht(h))&&(a=vs(e,a,h,l,s,r,o))}),i.foreach((i,l)=>{const h=gt(n,i);Cs(t,ht(h))||(a=vs(e,a,h,l,s,r,o))}),a}function Ts(e,t,n){return n.foreach((e,n)=>{t=t.updateChild(e,n)}),t}function bs(e,t,n,i,s,r,o,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let l,h=t;l=mt(n)?i:new xi(null).setTree(n,i);const c=t.serverCache.getNode();return l.children.inorderTraversal((n,i)=>{if(c.hasChild(n)){const l=t.serverCache.getNode().getImmediateChild(n),c=Ts(e,l,i);h=ys(e,h,new at(n),c,s,r,o,a)}}),l.children.inorderTraversal((n,i)=>{const l=!t.serverCache.isCompleteForChild(n)&&void 0===i.value;if(!c.hasChild(n)&&!l){const l=t.serverCache.getNode().getImmediateChild(n),c=Ts(e,l,i);h=ys(e,h,new at(n),c,s,r,o,a)}}),h}function ks(e,t,n,i,s,r,o){if(null!=ss(s,n))return t;const a=t.serverCache.isFiltered(),l=t.serverCache;if(null!=i.value){if(mt(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return ys(e,t,n,l.getNode().getChild(n),s,r,a,o);if(mt(n)){let i=new xi(null);return l.getNode().forEachChild(jt,(e,t)=>{i=i.set(new at(e),t)}),bs(e,t,n,i,s,r,a,o)}return t}{let h=new xi(null);return i.foreach((e,t)=>{const i=gt(n,e);l.isCompleteForPath(i)&&(h=h.set(e,l.getNode().getChild(i)))}),bs(e,t,n,h,s,r,a,o)}}function Is(e,t,n,i,s){const r=t.serverCache;return ms(e,Ti(t,r.getNode(),r.isFullyInitialized()||mt(n),r.isFiltered()),n,i,us,s)}function Es(e,t,n,s,r,o){let a;if(null!=ss(s,n))return t;{const l=new ds(s,t,r),h=t.eventCache.getNode();let c;if(mt(n)||".priority"===ht(n)){let n;if(t.serverCache.isFullyInitialized())n=ts(s,ki(t));else{const e=t.serverCache.getNode();(0,i.assert)(e instanceof _n,"serverChildren would be complete if leaf node"),n=ns(s,e)}n=n,c=e.filter.updateFullNode(h,n,o)}else{const i=ht(n);let r=os(s,i,t.serverCache);null==r&&t.serverCache.isCompleteForChild(i)&&(r=h.getImmediateChild(i)),(c=null!=r?e.filter.updateChild(h,i,r,ut(n),l,o):t.eventCache.getNode().hasChild(i)?e.filter.updateChild(h,i,_n.EMPTY_NODE,ut(n),l,o):h).isEmpty()&&t.serverCache.isFullyInitialized()&&(a=ts(s,ki(t))).isLeafNode()&&(c=e.filter.updateFullNode(c,a,o))}return a=t.serverCache.isFullyInitialized()||null!=ss(s,lt()),wi(t,c,a,e.filter.filtersNodes())}}class xs{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,i=new An(n.getIndex()),s=On(n);this.processor_=ps(s);const r=t.serverCache,o=t.eventCache,a=i.updateFullNode(_n.EMPTY_NODE,r.getNode(),null),l=s.updateFullNode(_n.EMPTY_NODE,o.getNode(),null),h=new _i(a,r.isFullyInitialized(),i.filtersNodes()),c=new _i(l,o.isFullyInitialized(),s.filtersNodes());this.viewCache_=Ci(c,h),this.eventGenerator_=new fi(this.query_)}get query(){return this.query_}}function Ss(e){return e.viewCache_.serverCache.getNode()}function Ps(e){return bi(e.viewCache_)}function Ns(e,t){const n=ki(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!mt(t)&&!n.getImmediateChild(ht(t)).isEmpty())?n.getChild(t):null}function Rs(e){return 0===e.eventRegistrations_.length}function Ds(e,t){e.eventRegistrations_.push(t)}function Ms(e,t,n){const s=[];if(n){(0,i.assert)(null==t,"A cancel should cancel all event registrations.");const r=e.query._path;e.eventRegistrations_.forEach(e=>{const t=e.createCancelEvent(n,r);t&&s.push(t)})}if(t){let n=[];for(let i=0;i<e.eventRegistrations_.length;++i){const s=e.eventRegistrations_[i];if(s.matches(t)){if(t.hasAnyCallback()){n=n.concat(e.eventRegistrations_.slice(i+1));break}}else n.push(s)}e.eventRegistrations_=n}else e.eventRegistrations_=[];return s}function As(e,t,n,s){t.type===oi.MERGE&&null!==t.source.queryId&&((0,i.assert)(ki(e.viewCache_),"We should always have a full cache before handling merges"),(0,i.assert)(bi(e.viewCache_),"Missing event cache, even though we have a server cache"));const r=e.viewCache_,o=fs(e.processor_,r,t,n,s);return _s(e.processor_,o.viewCache),(0,i.assert)(o.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=o.viewCache,qs(e,o.changes,o.viewCache.eventCache.getNode(),null)}function Fs(e,t){const n=e.viewCache_.eventCache,i=[];if(!n.getNode().isLeafNode()){n.getNode().forEachChild(on,(e,t)=>{i.push(Nn(e,t))})}return n.isFullyInitialized()&&i.push(Pn(n.getNode())),qs(e,i,n.getNode(),t)}function qs(e,t,n,i){const s=i?[i]:e.eventRegistrations_;return gi(e.eventGenerator_,t,n,s)}let Ls,Os;class Ws{constructor(){this.views=new Map}}function Us(e){(0,i.assert)(!Ls,"__referenceConstructor has already been defined"),Ls=e}function js(){return(0,i.assert)(Ls,"Reference.ts has not been loaded"),Ls}function Bs(e){return 0===e.views.size}function Hs(e,t,n,s){const r=t.source.queryId;if(null!==r){const o=e.views.get(r);return(0,i.assert)(null!=o,"SyncTree gave us an op for an invalid query."),As(o,t,n,s)}{let i=[];for(const r of e.views.values())i=i.concat(As(r,t,n,s));return i}}function Vs(e,t,n,i,s){const r=t._queryIdentifier,o=e.views.get(r);if(!o){let e=ts(n,s?i:null),r=!1;e?r=!0:i instanceof _n?(e=ns(n,i),r=!1):(e=_n.EMPTY_NODE,r=!1);const o=Ci(new _i(e,r,!1),new _i(i,s,!1));return new xs(t,o)}return o}function zs(e,t,n,i,s,r){const o=Vs(e,t,i,s,r);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),Ds(o,n),Fs(o,n)}function Ys(e,t,n,i){const s=t._queryIdentifier,r=[];let o=[];const a=Xs(e);if("default"===s)for(const[l,h]of e.views.entries())o=o.concat(Ms(h,n,i)),Rs(h)&&(e.views.delete(l),h.query._queryParams.loadsAllData()||r.push(h.query));else{const t=e.views.get(s);t&&(o=o.concat(Ms(t,n,i)),Rs(t)&&(e.views.delete(s),t.query._queryParams.loadsAllData()||r.push(t.query)))}return a&&!Xs(e)&&r.push(new(js())(t._repo,t._path)),{removed:r,events:o}}function Qs(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function Ks(e,t){let n=null;for(const i of e.views.values())n=n||Ns(i,t);return n}function Gs(e,t){if(t._queryParams.loadsAllData())return Js(e);{const n=t._queryIdentifier;return e.views.get(n)}}function $s(e,t){return null!=Gs(e,t)}function Xs(e){return null!=Js(e)}function Js(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}function Zs(e){(0,i.assert)(!Os,"__referenceConstructor has already been defined"),Os=e}function er(){return(0,i.assert)(Os,"Reference.ts has not been loaded"),Os}let tr=1;class nr{constructor(e){this.listenProvider_=e,this.syncPointTree_=new xi(null),this.pendingWriteTree_=es(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function ir(e,t,n,i,s){return Ui(e.pendingWriteTree_,t,n,i,s),s?gr(e,new di(ai(),t,n)):[]}function sr(e,t,n,i){ji(e.pendingWriteTree_,t,n,i);const s=xi.fromObject(n);return gr(e,new pi(ai(),t,s))}function rr(e,t,n=!1){const i=Bi(e.pendingWriteTree_,t);if(Hi(e.pendingWriteTree_,t)){let t=new xi(null);return null!=i.snap?t=t.set(lt(),!0):q(i.children,e=>{t=t.set(new at(e),!0)}),gr(e,new ci(i.path,t,n))}return[]}function or(e,t,n){return gr(e,new di(li(),t,n))}function ar(e,t,n){const i=xi.fromObject(n);return gr(e,new pi(li(),t,i))}function lr(e,t){return gr(e,new ui(li(),t))}function hr(e,t,n){const i=Tr(e,n);if(i){const n=br(i),s=n.path,r=n.queryId,o=yt(s,t);return kr(e,s,new ui(hi(r),o))}return[]}function cr(e,t,n,i){const s=t._path,r=e.syncPointTree_.get(s);let o=[];if(r&&("default"===t._queryIdentifier||$s(r,t))){const a=Ys(r,t,n,i);Bs(r)&&(e.syncPointTree_=e.syncPointTree_.remove(s));const l=a.removed;o=a.events;const h=-1!==l.findIndex(e=>e._queryParams.loadsAllData()),c=e.syncPointTree_.findOnPath(s,(e,t)=>Xs(t));if(h&&!c){const t=e.syncPointTree_.subtree(s);if(!t.isEmpty()){const n=Ir(t);for(let t=0;t<n.length;++t){const i=n[t],s=i.query,r=vr(e,i);e.listenProvider_.startListening(Er(s),Cr(e,s),r.hashFn,r.onComplete)}}}if(!c&&l.length>0&&!i)if(h){const n=null;e.listenProvider_.stopListening(Er(t),n)}else l.forEach(t=>{const n=e.queryToTagMap.get(wr(t));e.listenProvider_.stopListening(Er(t),n)});xr(e,l)}return o}function ur(e,t,n,i){const s=Tr(e,i);if(null!=s){const i=br(s),r=i.path,o=i.queryId,a=yt(r,t);return kr(e,r,new di(hi(o),a,n))}return[]}function dr(e,t,n,i){const s=Tr(e,i);if(s){const i=br(s),r=i.path,o=i.queryId,a=yt(r,t),l=xi.fromObject(n);return kr(e,r,new pi(hi(o),a,l))}return[]}function pr(e,t,n){const s=t._path;let r=null,o=!1;e.syncPointTree_.foreachOnPath(s,(e,t)=>{const n=yt(e,s);r=r||Ks(t,n),o=o||Xs(t)});let a,l=e.syncPointTree_.get(s);if(l?(o=o||Xs(l),r=r||Ks(l,lt())):(l=new Ws,e.syncPointTree_=e.syncPointTree_.set(s,l)),null!=r)a=!0;else{a=!1,r=_n.EMPTY_NODE,e.syncPointTree_.subtree(s).foreachChild((e,t)=>{const n=Ks(t,lt());n&&(r=r.updateImmediateChild(e,n))})}const h=$s(l,t);if(!h&&!t._queryParams.loadsAllData()){const n=wr(t);(0,i.assert)(!e.queryToTagMap.has(n),"View does not exist, but we have a tag");const s=Sr();e.queryToTagMap.set(n,s),e.tagToQueryMap.set(s,n)}let c=zs(l,t,n,Wi(e.pendingWriteTree_,s),r,a);if(!h&&!o){const n=Gs(l,t);c=c.concat(Pr(e,t,n))}return c}function _r(e,t,n){const i=e.pendingWriteTree_,s=e.syncPointTree_.findOnPath(t,(e,n)=>{const i=Ks(n,yt(e,t));if(i)return i});return Ki(i,t,s,n,!0)}function fr(e,t){const n=t._path;let i=null;e.syncPointTree_.foreachOnPath(n,(e,t)=>{const s=yt(e,n);i=i||Ks(t,s)});let s=e.syncPointTree_.get(n);s?i=i||Ks(s,lt()):(s=new Ws,e.syncPointTree_=e.syncPointTree_.set(n,s));const r=null!=i,o=r?new _i(i,!0,!1):null;return Ps(Vs(s,t,Wi(e.pendingWriteTree_,t._path),r?o.getNode():_n.EMPTY_NODE,r))}function gr(e,t){return mr(t,e.syncPointTree_,null,Wi(e.pendingWriteTree_,lt()))}function mr(e,t,n,i){if(mt(e.path))return yr(e,t,n,i);{const s=t.get(lt());null==n&&null!=s&&(n=Ks(s,lt()));let r=[];const o=ht(e.path),a=e.operationForChild(o),l=t.children.get(o);if(l&&a){const e=n?n.getImmediateChild(o):null,t=as(i,o);r=r.concat(mr(a,l,e,t))}return s&&(r=r.concat(Hs(s,e,i,n))),r}}function yr(e,t,n,i){const s=t.get(lt());null==n&&null!=s&&(n=Ks(s,lt()));let r=[];return t.children.inorderTraversal((t,s)=>{const o=n?n.getImmediateChild(t):null,a=as(i,t),l=e.operationForChild(t);l&&(r=r.concat(yr(l,s,o,a)))}),s&&(r=r.concat(Hs(s,e,i,n))),r}function vr(e,t){const n=t.query,i=Cr(e,n);return{hashFn:()=>{return(Ss(t)||_n.EMPTY_NODE).hash()},onComplete:t=>{if("ok"===t)return i?hr(e,n._path,i):lr(e,n._path);{const i=U(t,n);return cr(e,n,null,i)}}}}function Cr(e,t){const n=wr(t);return e.queryToTagMap.get(n)}function wr(e){return e._path.toString()+"$"+e._queryIdentifier}function Tr(e,t){return e.tagToQueryMap.get(t)}function br(e){const t=e.indexOf("$");return(0,i.assert)(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new at(e.substr(0,t))}}function kr(e,t,n){const s=e.syncPointTree_.get(t);return(0,i.assert)(s,"Missing sync point for query tag that we're tracking"),Hs(s,n,Wi(e.pendingWriteTree_,t),null)}function Ir(e){return e.fold((e,t,n)=>{if(t&&Xs(t)){return[Js(t)]}{let e=[];return t&&(e=Qs(t)),q(n,(t,n)=>{e=e.concat(n)}),e}})}function Er(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(er())(e._repo,e._path):e}function xr(e,t){for(let n=0;n<t.length;++n){const i=t[n];if(!i._queryParams.loadsAllData()){const t=wr(i),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}function Sr(){return tr++}function Pr(e,t,n){const s=t._path,r=Cr(e,t),o=vr(e,n),a=e.listenProvider_.startListening(Er(t),r,o.hashFn,o.onComplete),l=e.syncPointTree_.subtree(s);if(r)(0,i.assert)(!Xs(l.value),"If we're adding a query, it shouldn't be shadowed");else{const t=l.fold((e,t,n)=>{if(!mt(e)&&t&&Xs(t))return[Js(t).query];{let e=[];return t&&(e=e.concat(Qs(t).map(e=>e.query))),q(n,(t,n)=>{e=e.concat(n)}),e}});for(let n=0;n<t.length;++n){const i=t[n];e.listenProvider_.stopListening(Er(i),Cr(e,i))}}return a}class Nr{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Nr(t)}node(){return this.node_}}class Rr{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=gt(this.path_,e);return new Rr(this.syncTree_,t)}node(){return _r(this.syncTree_,this.path_)}}const Dr=function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e},Mr=function(e,t,n){return e&&"object"==typeof e?((0,i.assert)(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?Ar(e[".sv"],t,n):"object"==typeof e[".sv"]?Fr(e[".sv"],t):void(0,i.assert)(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},Ar=function(e,t,n){switch(e){case"timestamp":return n.timestamp;default:(0,i.assert)(!1,"Unexpected server value: "+e)}},Fr=function(e,t,n){e.hasOwnProperty("increment")||(0,i.assert)(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const s=e.increment;"number"!=typeof s&&(0,i.assert)(!1,"Unexpected increment value: "+s);const r=t.node();if((0,i.assert)(null!=r,"Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return s;const o=r.getValue();return"number"!=typeof o?s:o+s},qr=function(e,t,n,i){return Or(t,new Rr(n,e),i)},Lr=function(e,t,n){return Or(e,new Nr(t),n)};function Or(e,t,n){const i=e.getPriority().val(),s=Mr(i,t.getImmediateChild(".priority"),n);let r;if(e.isLeafNode()){const i=e,r=Mr(i.getValue(),t,n);return r!==i.getValue()||s!==i.getPriority().val()?new tn(r,yn(s)):e}{const i=e;return r=i,s!==i.getPriority().val()&&(r=r.updatePriority(new tn(s))),i.forEachChild(on,(e,i)=>{const s=Or(i,t.getImmediateChild(e),n);s!==i&&(r=r.updateImmediateChild(e,s))}),r}}class Wr{constructor(e="",t=null,n={children:{},childCount:0}){this.name=e,this.parent=t,this.node=n}}function Ur(e,t){let n=t instanceof at?t:new at(t),s=e,r=ht(n);for(;null!==r;){const e=(0,i.safeGet)(s.node.children,r)||{children:{},childCount:0};s=new Wr(r,s,e),r=ht(n=ut(n))}return s}function jr(e){return e.node.value}function Br(e,t){e.node.value=t,Gr(e)}function Hr(e){return e.node.childCount>0}function Vr(e){return void 0===jr(e)&&!Hr(e)}function zr(e,t){q(e.node.children,(n,i)=>{t(new Wr(n,e,i))})}function Yr(e,t,n,i){n&&!i&&t(e),zr(e,e=>{Yr(e,t,!0,i)}),n&&i&&t(e)}function Qr(e,t,n){let i=n?e:e.parent;for(;null!==i;){if(t(i))return!0;i=i.parent}return!1}function Kr(e){return new at(null===e.parent?e.name:Kr(e.parent)+"/"+e.name)}function Gr(e){null!==e.parent&&$r(e.parent,e.name,e)}function $r(e,t,n){const s=Vr(n),r=(0,i.contains)(e.node.children,t);s&&r?(delete e.node.children[t],e.node.childCount--,Gr(e)):s||r||(e.node.children[t]=n.node,e.node.childCount++,Gr(e))}const Xr=/[\[\].#$\/\u0000-\u001F\u007F]/,Jr=/[\[\].#$\u0000-\u001F\u007F]/,Zr=10485760,eo=function(e){return"string"==typeof e&&0!==e.length&&!Xr.test(e)},to=function(e){return"string"==typeof e&&0!==e.length&&!Jr.test(e)},no=function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),to(e)},io=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!x(e)||e&&"object"==typeof e&&(0,i.contains)(e,".sv")},so=function(e,t,n,s){s&&void 0===t||ro((0,i.errorPrefix)(e,"value"),t,n)},ro=function(e,t,n){const s=n instanceof at?new Tt(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+Et(s));if("function"==typeof t)throw new Error(e+"contains a function "+Et(s)+" with contents = "+t.toString());if(x(t))throw new Error(e+"contains "+t.toString()+" "+Et(s));if("string"==typeof t&&t.length>10485760/3&&(0,i.stringLength)(t)>10485760)throw new Error(e+"contains a string greater than 10485760 utf8 bytes "+Et(s)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let n=!1,i=!1;if(q(t,(t,r)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(i=!0,!eo(t)))throw new Error(e+" contains an invalid key ("+t+") "+Et(s)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');bt(s,t),ro(e,r,s),kt(s)}),n&&i)throw new Error(e+' contains ".value" child '+Et(s)+" in addition to actual children.")}},oo=function(e,t){let n,i;for(n=0;n<t.length;n++){const s=_t(i=t[n]);for(let t=0;t<s.length;t++)if(".priority"===s[t]&&t===s.length-1);else if(!eo(s[t]))throw new Error(e+"contains an invalid key ("+s[t]+") in path "+i.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(vt);let s=null;for(n=0;n<t.length;n++){if(i=t[n],null!==s&&wt(s,i))throw new Error(e+"contains a path "+s.toString()+" that is ancestor of another path "+i.toString());s=i}},ao=function(e,t,n,s){if(s&&void 0===t)return;const r=(0,i.errorPrefix)(e,"values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(r+" must be an object containing the children to replace.");const o=[];q(t,(e,t)=>{const i=new at(e);if(ro(r,t,gt(n,i)),".priority"===dt(i)&&!io(t))throw new Error(r+"contains an invalid value for '"+i.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(i)}),oo(r,o)},lo=function(e,t,n){if(!n||void 0!==t){if(x(t))throw new Error((0,i.errorPrefix)(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!io(t))throw new Error((0,i.errorPrefix)(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},ho=function(e,t,n,s){if(!(s&&void 0===n||eo(n)))throw new Error((0,i.errorPrefix)(e,t)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},co=function(e,t,n,s){if(!(s&&void 0===n||to(n)))throw new Error((0,i.errorPrefix)(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')};exports._validatePathString=co;const uo=function(e,t,n,i){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),co(e,t,n,i)},po=function(e,t){if(".info"===ht(t))throw new Error(e+" failed = Can't modify data under /.info/")};exports._validateWritablePath=po;const _o=function(e,t){const n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!eo(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!no(n))throw new Error((0,i.errorPrefix)(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class fo{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function go(e,t){let n=null;for(let i=0;i<t.length;i++){const s=t[i],r=s.getPath();null===n||Ct(r,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:r}),n.events.push(s)}n&&e.eventLists_.push(n)}function mo(e,t,n){go(e,n),vo(e,e=>Ct(e,t))}function yo(e,t,n){go(e,n),vo(e,e=>wt(e,t)||wt(t,e))}function vo(e,t){e.recursionDepth_++;let n=!0;for(let i=0;i<e.eventLists_.length;i++){const s=e.eventLists_[i];if(s){t(s.path)?(Co(e.eventLists_[i]),e.eventLists_[i]=null):n=!1}}n&&(e.eventLists_=[]),e.recursionDepth_--}function Co(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const i=n.getEventRunner();y&&w("event: "+n.toString()),z(i)}}}const wo="repo_interrupt",To=25;class bo{constructor(e,t,n,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new fo,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=$n(),this.transactionQueueTree_=new Wr,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function ko(e,t,n){if(e.stats_=_e(e.repoInfo_),e.forceRestClient_||Y())e.server_=new Kn(e.repoInfo_,(t,n,i,s)=>{xo(e,t,n,i,s)},e.authTokenProvider_,e.appCheckProvider_),setTimeout(()=>So(e,!0),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,i.stringify)(n)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}e.persistentConnection_=new qt(e.repoInfo_,t,(t,n,i,s)=>{xo(e,t,n,i,s)},t=>{So(e,t)},t=>{Po(e,t)},e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener(t=>{e.server_.refreshAuthToken(t)}),e.appCheckProvider_.addTokenChangeListener(t=>{e.server_.refreshAppCheckToken(t.token)}),e.statsReporter_=fe(e.repoInfo_,()=>new ri(e.stats_,e.server_)),e.infoData_=new Gn,e.infoSyncTree_=new nr({startListening:(t,n,i,s)=>{let r=[];const o=e.infoData_.getNode(t._path);return o.isEmpty()||(r=or(e.infoSyncTree_,t._path,o),setTimeout(()=>{s("ok")},0)),r},stopListening:()=>{}}),No(e,"connected",!1),e.serverSyncTree_=new nr({startListening:(t,n,i,s)=>(e.server_.listen(t,i,n,(n,i)=>{const r=s(n,i);yo(e.eventQueue_,t._path,r)}),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function Io(e){const t=e.infoData_.getNode(new at(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function Eo(e){return Dr({timestamp:Io(e)})}function xo(e,t,n,s,r){e.dataUpdateCount++;const o=new at(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let a=[];if(r)if(s){const t=(0,i.map)(n,e=>yn(e));a=dr(e.serverSyncTree_,o,t,r)}else{const t=yn(n);a=ur(e.serverSyncTree_,o,t,r)}else if(s){const t=(0,i.map)(n,e=>yn(e));a=ar(e.serverSyncTree_,o,t)}else{const t=yn(n);a=or(e.serverSyncTree_,o,t)}let l=o;a.length>0&&(l=$o(e,o)),yo(e.eventQueue_,l,a)}function So(e,t){No(e,"connected",t),!1===t&&Fo(e)}function Po(e,t){q(t,(t,n)=>{No(e,t,n)})}function No(e,t,n){const i=new at("/.info/"+t),s=yn(n);e.infoData_.updateSnapshot(i,s);const r=or(e.infoSyncTree_,i,s);yo(e.eventQueue_,i,r)}function Ro(e){return e.nextWriteId_++}function Do(e,t){const n=fr(e.serverSyncTree_,t);return null!=n?Promise.resolve(n):e.server_.get(t).then(n=>{const i=yn(n).withIndex(t._queryParams.getIndex()),s=or(e.serverSyncTree_,t._path,i);return mo(e.eventQueue_,t._path,s),Promise.resolve(i)},n=>(Vo(e,"get for query "+(0,i.stringify)(t)+" failed: "+n),Promise.reject(new Error(n))))}function Mo(e,t,n,i,s){Vo(e,"set",{path:t.toString(),value:n,priority:i});const r=Eo(e),o=yn(n,i),a=_r(e.serverSyncTree_,t),l=Lr(o,a,r),h=Ro(e),c=ir(e.serverSyncTree_,t,l,h,!0);go(e.eventQueue_,c),e.server_.put(t.toString(),o.val(!0),(n,i)=>{const r="ok"===n;r||I("set at "+t+" failed: "+n);const o=rr(e.serverSyncTree_,h,!r);yo(e.eventQueue_,t,o),zo(e,s,n,i)});const u=na(e,t);$o(e,u),yo(e.eventQueue_,u,[])}function Ao(e,t,n,i){Vo(e,"update",{path:t.toString(),value:n});let s=!0;const r=Eo(e),o={};if(q(n,(n,i)=>{s=!1,o[n]=qr(gt(t,n),yn(i),e.serverSyncTree_,r)}),s)w("update() called with empty data.  Don't do anything."),zo(e,i,"ok",void 0);else{const s=Ro(e),r=sr(e.serverSyncTree_,t,o,s);go(e.eventQueue_,r),e.server_.merge(t.toString(),n,(n,r)=>{const o="ok"===n;o||I("update at "+t+" failed: "+n);const a=rr(e.serverSyncTree_,s,!o),l=a.length>0?$o(e,t):t;yo(e.eventQueue_,l,a),zo(e,i,n,r)}),q(n,n=>{const i=na(e,gt(t,n));$o(e,i)}),yo(e.eventQueue_,t,[])}}function Fo(e){Vo(e,"onDisconnectEvents");const t=Eo(e),n=$n();Zn(e.onDisconnect_,lt(),(i,s)=>{const r=qr(i,s,e.serverSyncTree_,t);Xn(n,i,r)});let i=[];Zn(n,lt(),(t,n)=>{i=i.concat(or(e.serverSyncTree_,t,n));const s=na(e,t);$o(e,s)}),e.onDisconnect_=$n(),yo(e.eventQueue_,lt(),i)}function qo(e,t,n){e.server_.onDisconnectCancel(t.toString(),(i,s)=>{"ok"===i&&Jn(e.onDisconnect_,t),zo(e,n,i,s)})}function Lo(e,t,n,i){const s=yn(n);e.server_.onDisconnectPut(t.toString(),s.val(!0),(n,r)=>{"ok"===n&&Xn(e.onDisconnect_,t,s),zo(e,i,n,r)})}function Oo(e,t,n,i,s){const r=yn(n,i);e.server_.onDisconnectPut(t.toString(),r.val(!0),(n,i)=>{"ok"===n&&Xn(e.onDisconnect_,t,r),zo(e,s,n,i)})}function Wo(e,t,n,s){if((0,i.isEmpty)(n))return w("onDisconnect().update() called with empty data.  Don't do anything."),void zo(e,s,"ok",void 0);e.server_.onDisconnectMerge(t.toString(),n,(i,r)=>{"ok"===i&&q(n,(n,i)=>{const s=yn(i);Xn(e.onDisconnect_,gt(t,n),s)}),zo(e,s,i,r)})}function Uo(e,t,n){let i;i=".info"===ht(t._path)?pr(e.infoSyncTree_,t,n):pr(e.serverSyncTree_,t,n),mo(e.eventQueue_,t._path,i)}function jo(e,t,n){let i;i=".info"===ht(t._path)?cr(e.infoSyncTree_,t,n):cr(e.serverSyncTree_,t,n),mo(e.eventQueue_,t._path,i)}function Bo(e){e.persistentConnection_&&e.persistentConnection_.interrupt(wo)}function Ho(e){e.persistentConnection_&&e.persistentConnection_.resume(wo)}function Vo(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),w(n,...t)}function zo(e,t,n,i){t&&z(()=>{if("ok"===n)t(null);else{const e=(n||"error").toUpperCase();let s=e;i&&(s+=": "+i);const r=new Error(s);r.code=e,t(r)}})}function Yo(e,t,n,s,r,o){Vo(e,"transaction on "+t);const a={path:t,update:n,onComplete:s,status:null,order:f(),applyLocally:o,retryCount:0,unwatcher:r,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},l=Qo(e,t,void 0);a.currentInputSnapshot=l;const h=a.update(l.val());if(void 0===h)a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete&&a.onComplete(null,!1,a.currentInputSnapshot);else{ro("transaction failed: Data returned ",h,a.path),a.status=0;const n=Ur(e.transactionQueueTree_,t),s=jr(n)||[];let r;if(s.push(a),Br(n,s),"object"==typeof h&&null!==h&&(0,i.contains)(h,".priority"))r=(0,i.safeGet)(h,".priority"),(0,i.assert)(io(r),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else{r=(_r(e.serverSyncTree_,t)||_n.EMPTY_NODE).getPriority().val()}const o=Eo(e),c=yn(h,r),u=Lr(c,l,o);a.currentOutputSnapshotRaw=c,a.currentOutputSnapshotResolved=u,a.currentWriteId=Ro(e);const d=ir(e.serverSyncTree_,t,u,a.currentWriteId,a.applyLocally);yo(e.eventQueue_,t,d),Ko(e,e.transactionQueueTree_)}}function Qo(e,t,n){return _r(e.serverSyncTree_,t,n)||_n.EMPTY_NODE}function Ko(e,t=e.transactionQueueTree_){if(t||ta(e,t),jr(t)){const n=Zo(e,t);(0,i.assert)(n.length>0,"Sending zero length transaction queue"),n.every(e=>0===e.status)&&Go(e,Kr(t),n)}else Hr(t)&&zr(t,t=>{Ko(e,t)})}function Go(e,t,n){const s=n.map(e=>e.currentWriteId),r=Qo(e,t,s);let o=r;const a=r.hash();for(let c=0;c<n.length;c++){const e=n[c];(0,i.assert)(0===e.status,"tryToSendTransactionQueue_: items in queue should all be run."),e.status=1,e.retryCount++;const s=yt(t,e.path);o=o.updateChild(s,e.currentOutputSnapshotRaw)}const l=o.val(!0),h=t;e.server_.put(h.toString(),l,i=>{Vo(e,"transaction put response",{path:h.toString(),status:i});let s=[];if("ok"===i){const i=[];for(let t=0;t<n.length;t++)n[t].status=2,s=s.concat(rr(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&i.push(()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)),n[t].unwatcher();ta(e,Ur(e.transactionQueueTree_,t)),Ko(e,e.transactionQueueTree_),yo(e.eventQueue_,t,s);for(let e=0;e<i.length;e++)z(i[e])}else{if("datastale"===i)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{I("transaction at "+h.toString()+" failed: "+i);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=i}$o(e,t)}},a)}function $o(e,t){const n=Jo(e,t),i=Kr(n);return Xo(e,Zo(e,n),i),i}function Xo(e,t,n){if(0===t.length)return;const s=[];let r=[];const o=t.filter(e=>0===e.status).map(e=>e.currentWriteId);for(let l=0;l<t.length;l++){const h=t[l],c=yt(n,h.path);let u,d=!1;if((0,i.assert)(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),4===h.status)d=!0,u=h.abortReason,r=r.concat(rr(e.serverSyncTree_,h.currentWriteId,!0));else if(0===h.status)if(h.retryCount>=To)d=!0,u="maxretry",r=r.concat(rr(e.serverSyncTree_,h.currentWriteId,!0));else{const n=Qo(e,h.path,o);h.currentInputSnapshot=n;const s=t[l].update(n.val());if(void 0!==s){ro("transaction failed: Data returned ",s,h.path);let t=yn(s);"object"==typeof s&&null!=s&&(0,i.contains)(s,".priority")||(t=t.updatePriority(n.getPriority()));const a=h.currentWriteId,l=Eo(e),c=Lr(t,n,l);h.currentOutputSnapshotRaw=t,h.currentOutputSnapshotResolved=c,h.currentWriteId=Ro(e),o.splice(o.indexOf(a),1),r=(r=r.concat(ir(e.serverSyncTree_,h.path,c,h.currentWriteId,h.applyLocally))).concat(rr(e.serverSyncTree_,a,!0))}else d=!0,u="nodata",r=r.concat(rr(e.serverSyncTree_,h.currentWriteId,!0))}yo(e.eventQueue_,n,r),r=[],d&&(t[l].status=2,a=t[l].unwatcher,setTimeout(a,Math.floor(0)),t[l].onComplete&&("nodata"===u?s.push(()=>t[l].onComplete(null,!1,t[l].currentInputSnapshot)):s.push(()=>t[l].onComplete(new Error(u),!1,null))))}var a;ta(e,e.transactionQueueTree_);for(let i=0;i<s.length;i++)z(s[i]);Ko(e,e.transactionQueueTree_)}function Jo(e,t){let n,i=e.transactionQueueTree_;for(n=ht(t);null!==n&&void 0===jr(i);)i=Ur(i,n),n=ht(t=ut(t));return i}function Zo(e,t){const n=[];return ea(e,t,n),n.sort((e,t)=>e.order-t.order),n}function ea(e,t,n){const i=jr(t);if(i)for(let s=0;s<i.length;s++)n.push(i[s]);zr(t,t=>{ea(e,t,n)})}function ta(e,t){const n=jr(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,Br(t,n.length>0?n:void 0)}zr(t,t=>{ta(e,t)})}function na(e,t){const n=Kr(Jo(e,t)),i=Ur(e.transactionQueueTree_,t);return Qr(i,t=>{ia(e,t)}),ia(e,i),Yr(i,t=>{ia(e,t)}),n}function ia(e,t){const n=jr(t);if(n){const s=[];let r=[],o=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?((0,i.assert)(o===t-1,"All SENT items should be at beginning of queue."),o=t,n[t].status=3,n[t].abortReason="set"):((0,i.assert)(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),r=r.concat(rr(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&s.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===o?Br(t,void 0):n.length=o+1,yo(e.eventQueue_,Kr(t),r);for(let e=0;e<s.length;e++)z(s[e])}}function sa(e){let t="";const n=e.split("/");for(let s=0;s<n.length;s++)if(n[s].length>0){let e=n[s];try{e=decodeURIComponent(e.replace(/\+/g," "))}catch(i){}t+="/"+e}return t}function ra(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const i=n.split("=");2===i.length?t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):I(`Invalid query segment '${n}' in query '${e}'`)}return t}const oa=function(e,t){const n=aa(e),i=n.namespace;"firebase.com"===n.domain&&k(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),i&&"undefined"!==i||"localhost"===n.domain||k("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&I("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const s="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new le(n.host,n.secure,i,t,s,"",i!==n.subdomain),path:new at(n.pathString)}},aa=function(e){let t="",n="",i="",s="",r="",o=!0,a="https",l=443;if("string"==typeof e){let h=e.indexOf("//");h>=0&&(a=e.substring(0,h-1),e=e.substring(h+2));let c=e.indexOf("/");-1===c&&(c=e.length);let u=e.indexOf("?");-1===u&&(u=e.length),t=e.substring(0,Math.min(c,u)),c<u&&(s=sa(e.substring(c,u)));const d=ra(e.substring(Math.min(e.length,u)));(h=t.indexOf(":"))>=0?(o="https"===a||"wss"===a,l=parseInt(t.substring(h+1),10)):h=t.length;const p=t.slice(0,h);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{const e=t.indexOf(".");i=t.substring(0,e).toLowerCase(),n=t.substring(e+1),r=i}"ns"in d&&(r=d.ns)}return{host:t,port:l,domain:n,subdomain:i,secure:o,scheme:a,pathString:s,namespace:r}};class la{constructor(e,t,n,i){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=i}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,i.stringify)(this.snapshot.exportVal())}}class ha{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class ca{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return(0,i.assert)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class ua{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new i.Deferred;return qo(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){po("OnDisconnect.remove",this._path);const e=new i.Deferred;return Lo(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){po("OnDisconnect.set",this._path),so("OnDisconnect.set",e,this._path,!1);const t=new i.Deferred;return Lo(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){po("OnDisconnect.setWithPriority",this._path),so("OnDisconnect.setWithPriority",e,this._path,!1),lo("OnDisconnect.setWithPriority",t,!1);const n=new i.Deferred;return Oo(this._repo,this._path,e,t,n.wrapCallback(()=>{})),n.promise}update(e){po("OnDisconnect.update",this._path),ao("OnDisconnect.update",e,this._path,!1);const t=new i.Deferred;return Wo(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}exports.OnDisconnect=ua;class da{constructor(e,t,n,i){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=i}get key(){return mt(this._path)?null:dt(this._path)}get ref(){return new ga(this._repo,this._path)}get _queryIdentifier(){const e=Qn(this._queryParams),t=A(e);return"{}"===t?"default":t}get _queryObject(){return Qn(this._queryParams)}isEqual(e){if(!((e=(0,i.getModularInstance)(e))instanceof da))return!1;const t=this._repo===e._repo,n=Ct(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return t&&n&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+pt(this._path)}}function pa(e,t){if(!0===e._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}function _a(e){let t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===jt){const i="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",s="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==P)throw new Error(i);if("string"!=typeof t)throw new Error(s)}if(e.hasEnd()){if(e.getIndexEndName()!==N)throw new Error(i);if("string"!=typeof n)throw new Error(s)}}else if(e.getIndex()===on){if(null!=t&&!io(t)||null!=n&&!io(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,i.assert)(e.getIndex()instanceof vn||e.getIndex()===wn,"unknown index type."),null!=t&&"object"==typeof t||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function fa(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}exports._QueryImpl=da;class ga extends da{constructor(e,t){super(e,t,new Ln,!1)}get parent(){const e=ft(this._path);return null===e?null:new ga(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}exports._ReferenceImpl=ga;class ma{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new at(e),n=Ca(this.ref,e);return new ma(this._node.getChild(t),n,on)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){if(this._node.isLeafNode())return!1;return!!this._node.forEachChild(this._index,(t,n)=>e(new ma(n,Ca(this.ref,t),on)))}hasChild(e){const t=new at(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function ya(e,t){return(e=(0,i.getModularInstance)(e))._checkNotDeleted("ref"),void 0!==t?Ca(e._root,t):e._root}function va(e,t){(e=(0,i.getModularInstance)(e))._checkNotDeleted("refFromURL");const n=oa(t,e._repo.repoInfo_.nodeAdmin);_o("refFromURL",n);const s=n.repoInfo;return e._repo.repoInfo_.isCustomHost()||s.host===e._repo.repoInfo_.host||k("refFromURL: Host name does not match the current database: (found "+s.host+" but expected "+e._repo.repoInfo_.host+")"),ya(e,n.path.toString())}function Ca(e,t){return null===ht((e=(0,i.getModularInstance)(e))._path)?uo("child","path",t,!1):co("child","path",t,!1),new ga(e._repo,gt(e._path,t))}function wa(e){return e=(0,i.getModularInstance)(e),new ua(e._repo,e._path)}function Ta(e,t){e=(0,i.getModularInstance)(e),po("push",e._path),so("push",t,e._path,!0);const n=Io(e._repo),s=En(n),r=Ca(e,s),o=Ca(e,s);let a;return a=null!=t?ka(o,t).then(()=>o):Promise.resolve(o),r.then=a.then.bind(a),r.catch=a.then.bind(a,void 0),r}function ba(e){return po("remove",e._path),ka(e,null)}function ka(e,t){e=(0,i.getModularInstance)(e),po("set",e._path),so("set",t,e._path,!1);const n=new i.Deferred;return Mo(e._repo,e._path,t,null,n.wrapCallback(()=>{})),n.promise}function Ia(e,t){e=(0,i.getModularInstance)(e),po("setPriority",e._path),lo("setPriority",t,!1);const n=new i.Deferred;return Mo(e._repo,gt(e._path,".priority"),t,null,n.wrapCallback(()=>{})),n.promise}function Ea(e,t,n){if(po("setWithPriority",e._path),so("setWithPriority",t,e._path,!1),lo("setWithPriority",n,!1),".length"===e.key||".keys"===e.key)throw"setWithPriority failed: "+e.key+" is a read-only object.";const s=new i.Deferred;return Mo(e._repo,e._path,t,n,s.wrapCallback(()=>{})),s.promise}function xa(e,t){ao("update",t,e._path,!1);const n=new i.Deferred;return Ao(e._repo,e._path,t,n.wrapCallback(()=>{})),n.promise}function Sa(e){return Do((e=(0,i.getModularInstance)(e))._repo,e).then(t=>new ma(t,new ga(e._repo,e._path),e._queryParams.getIndex()))}exports.DataSnapshot=ma;class Pa{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const n=t._queryParams.getIndex();return new la("value",this,new ma(e.snapshotNode,new ga(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new ha(this,e,t):null}matches(e){return e instanceof Pa&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class Na{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new ha(this,e,t):null}createEvent(e,t){(0,i.assert)(null!=e.childName,"Child events should have a childName.");const n=Ca(new ga(t._repo,t._path),e.childName),s=t._queryParams.getIndex();return new la(e.type,this,new ma(e.snapshotNode,n,s),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof Na&&(this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)))}hasAnyCallback(){return!!this.callbackContext}}function Ra(e,t,n,i,s){let r;if("object"==typeof i&&(r=void 0,s=i),"function"==typeof i&&(r=i),s&&s.onlyOnce){const t=n,i=(n,i)=>{jo(e._repo,e,a),t(n,i)};i.userCallback=n.userCallback,i.context=n.context,n=i}const o=new ca(n,r||void 0),a="value"===t?new Pa(o):new Na(t,o);return Uo(e._repo,e,a),()=>jo(e._repo,e,a)}function Da(e,t,n,i){return Ra(e,"value",t,n,i)}function Ma(e,t,n,i){return Ra(e,"child_added",t,n,i)}function Aa(e,t,n,i){return Ra(e,"child_changed",t,n,i)}function Fa(e,t,n,i){return Ra(e,"child_moved",t,n,i)}function qa(e,t,n,i){return Ra(e,"child_removed",t,n,i)}function La(e,t,n){let i=null;const s=n?new ca(n):null;"value"===t?i=new Pa(s):t&&(i=new Na(t,s)),jo(e._repo,e,i)}class Oa{}exports.QueryConstraint=Oa;class Wa extends Oa{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){so("endAt",this._value,e._path,!0);const t=Hn(e._queryParams,this._value,this._key);if(fa(t),_a(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new da(e._repo,e._path,t,e._orderByCalled)}}function Ua(e,t){return ho("endAt","key",t,!0),new Wa(e,t)}class ja extends Oa{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){so("endBefore",this._value,e._path,!1);const t=Vn(e._queryParams,this._value,this._key);if(fa(t),_a(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new da(e._repo,e._path,t,e._orderByCalled)}}function Ba(e,t){return ho("endBefore","key",t,!0),new ja(e,t)}class Ha extends Oa{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){so("startAt",this._value,e._path,!0);const t=jn(e._queryParams,this._value,this._key);if(fa(t),_a(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new da(e._repo,e._path,t,e._orderByCalled)}}function Va(e=null,t){return ho("startAt","key",t,!0),new Ha(e,t)}class za extends Oa{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){so("startAfter",this._value,e._path,!1);const t=Bn(e._queryParams,this._value,this._key);if(fa(t),_a(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new da(e._repo,e._path,t,e._orderByCalled)}}function Ya(e,t){return ho("startAfter","key",t,!0),new za(e,t)}class Qa extends Oa{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new da(e._repo,e._path,Wn(e._queryParams,this._limit),e._orderByCalled)}}function Ka(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new Qa(e)}class Ga extends Oa{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new da(e._repo,e._path,Un(e._queryParams,this._limit),e._orderByCalled)}}function $a(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new Ga(e)}class Xa extends Oa{constructor(e){super(),this._path=e}_apply(e){pa(e,"orderByChild");const t=new at(this._path);if(mt(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const n=new vn(t),i=zn(e._queryParams,n);return _a(i),new da(e._repo,e._path,i,!0)}}function Ja(e){if("$key"===e)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===e)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===e)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return co("orderByChild","path",e,!1),new Xa(e)}class Za extends Oa{_apply(e){pa(e,"orderByKey");const t=zn(e._queryParams,jt);return _a(t),new da(e._repo,e._path,t,!0)}}function el(){return new Za}class tl extends Oa{_apply(e){pa(e,"orderByPriority");const t=zn(e._queryParams,on);return _a(t),new da(e._repo,e._path,t,!0)}}function nl(){return new tl}class il extends Oa{_apply(e){pa(e,"orderByValue");const t=zn(e._queryParams,wn);return _a(t),new da(e._repo,e._path,t,!0)}}function sl(){return new il}class rl extends Oa{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){if(so("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Wa(this._value,this._key)._apply(new Ha(this._value,this._key)._apply(e))}}function ol(e,t){return ho("equalTo","key",t,!0),new rl(e,t)}function al(e,...t){let n=(0,i.getModularInstance)(e);for(const i of t)n=i._apply(n);return n}Us(ga),Zs(ga);const ll="FIREBASE_DATABASE_EMULATOR_HOST",hl={};let cl=!1;function ul(e,t,n,i){e.repoInfo_=new le(`${t}:${n}`,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams),i&&(e.authTokenProvider_=i)}function dl(t,n,i,s,r){let o=s||t.options.databaseURL;void 0===o&&(t.options.projectId||k("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),w("Using default host for project ",t.options.projectId),o=`${t.options.projectId}-default-rtdb.firebaseio.com`);let a,l=oa(o,r),h=l.repoInfo,c=void 0;void 0!==e&&(c=e.env[ll]),c?(a=!0,o=`http://${c}?ns=${h.namespace}`,h=(l=oa(o,r)).repoInfo):a=!l.repoInfo.secure;const u=r&&a?new $($.OWNER):new G(t.name,t.options,n);_o("Invalid Firebase Database URL",l),mt(l.path)||k("Database URL must point to the root of a Firebase Database (not including a child path).");const d=_l(h,t,u,new K(t.name,i));return new gl(d,t)}function pl(e,t){const n=hl[t];n&&n[e.key]===e||k(`Database ${t}(${e.repoInfo_}) has already been deleted.`),Bo(e),delete n[e.key]}function _l(e,t,n,i){let s=hl[t.name];s||(s={},hl[t.name]=s);let r=s[e.toURLString()];return r&&k("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new bo(e,cl,n,i),s[e.toURLString()]=r,r}function fl(e){cl=e}class gl{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(ko(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ga(this._repo,lt())),this._rootInternal}_delete(){return null!==this._rootInternal&&(pl(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&k("Cannot call "+e+" on a deleted database.")}}function ml(e=(0,t.getApp)(),n){return(0,t._getProvider)(e,"database").getImmediate({identifier:n})}function yl(e,t,n,s={}){(e=(0,i.getModularInstance)(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&k("Cannot call useEmulator() after instance has already been initialized.");const r=e._repoInternal;let o=void 0;if(r.repoInfo_.nodeAdmin)s.mockUserToken&&k('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new $($.OWNER);else if(s.mockUserToken){const t="string"==typeof s.mockUserToken?s.mockUserToken:(0,i.createMockUserToken)(s.mockUserToken,e.app.options.projectId);o=new $(t)}ul(r,t,n,o)}function vl(e){(e=(0,i.getModularInstance)(e))._checkNotDeleted("goOffline"),Bo(e._repo)}function Cl(e){(e=(0,i.getModularInstance)(e))._checkNotDeleted("goOnline"),Ho(e._repo)}function wl(e,t){C(e,t)}function Tl(e){l(t.SDK_VERSION),(0,t._registerComponent)(new n.Component("database",(e,{instanceIdentifier:t})=>{return dl(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t)},"PUBLIC").setMultipleInstances(!0)),(0,t.registerVersion)(r,o,e),(0,t.registerVersion)(r,o,"esm2017")}exports.Database=gl;const bl={".sv":"timestamp"};function kl(){return bl}function Il(e){return{".sv":{increment:e}}}class El{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function xl(e,t,n){var s;if(e=(0,i.getModularInstance)(e),po("Reference.transaction",e._path),".length"===e.key||".keys"===e.key)throw"Reference.transaction failed: "+e.key+" is a read-only object.";const r=null===(s=null==n?void 0:n.applyLocally)||void 0===s||s,o=new i.Deferred,a=Da(e,()=>{});return Yo(e._repo,e._path,t,(t,n,i)=>{let s=null;t?o.reject(t):(s=new ma(i,new ga(e._repo,e._path),on),o.resolve(new El(n,s)))},a,r),o.promise}exports.TransactionResult=El,qt.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},qt.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};const Sl=function(e){const t=qt.prototype.put;return qt.prototype.put=function(n,i,s,r){void 0!==r&&(r=e()),t.call(this,n,i,s,r)},function(){qt.prototype.put=t}};exports._TEST_ACCESS_hijackHash=Sl;const Pl=function(e){fl(e)};exports._TEST_ACCESS_forceRestClient=Pl,Tl();
},{"@firebase/app":"h2Mb","@firebase/component":"vhY9","@firebase/util":"chA2","@firebase/logger":"JJem","process":"pBGv"}],"Uuoh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@firebase/database");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});
},{"@firebase/database":"Q6BU"}],"vCxL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.__assign=void 0,exports.__asyncDelegator=b,exports.__asyncGenerator=v,exports.__asyncValues=w,exports.__await=_,exports.__awaiter=c,exports.__classPrivateFieldGet=j,exports.__classPrivateFieldSet=P,exports.__createBinding=void 0,exports.__decorate=o,exports.__exportStar=l,exports.__extends=e,exports.__generator=u,exports.__importDefault=g,exports.__importStar=O,exports.__makeTemplateObject=x,exports.__metadata=i,exports.__param=a,exports.__read=p,exports.__rest=n,exports.__spread=y,exports.__spreadArray=d,exports.__spreadArrays=h,exports.__values=s;var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};function e(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var r=function(){return exports.__assign=r=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};function n(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function o(t,e,r,n){var o,a=arguments.length,i=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(i=(a<3?o(i):a>3?o(e,r,i):o(e,r))||i);return a>3&&i&&Object.defineProperty(e,r,i),i}function a(t,e){return function(r,n){e(r,n,t)}}function i(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function c(t,e,r,n){return new(r||(r=Promise))(function(o,a){function i(t){try{u(n.next(t))}catch(e){a(e)}}function c(t){try{u(n.throw(t))}catch(e){a(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(i,c)}u((n=n.apply(t,e||[])).next())})}function u(t,e){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(t,i)}catch(c){a=[6,c],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}exports.__assign=r;var f=Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]};function l(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||f(e,t,r)}function s(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,a=r.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(c){o={error:c}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function y(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(p(arguments[e]));return t}function h(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var a=arguments[e],i=0,c=a.length;i<c;i++,o++)n[o]=a[i];return n}function d(t,e,r){if(r||2===arguments.length)for(var n,o=0,a=e.length;o<a;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}function _(t){return this instanceof _?(this.v=t,this):new _(t)}function v(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(t,e||[]),a=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(t){o[t]&&(n[t]=function(e){return new Promise(function(r,n){a.push([t,e,r,n])>1||c(t,e)})})}function c(t,e){try{(r=o[t](e)).value instanceof _?Promise.resolve(r.value.v).then(u,f):l(a[0][2],r)}catch(n){l(a[0][3],n)}var r}function u(t){c("next",t)}function f(t){c("throw",t)}function l(t,e){t(e),a.shift(),a.length&&c(a[0][0],a[0][1])}}function b(t){var e,r;return e={},n("next"),n("throw",function(t){throw t}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,o){e[n]=t[n]?function(e){return(r=!r)?{value:_(t[n](e)),done:"return"===n}:o?o(e):e}:o}}function w(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof s?s(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise(function(n,o){(function(t,e,r,n){Promise.resolve(n).then(function(e){t({value:e,done:r})},e)})(n,o,(e=t[r](e)).done,e.value)})}}}function x(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}exports.__createBinding=f;var m=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e};function O(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&f(e,t,r);return m(e,t),e}function g(t){return t&&t.__esModule?t:{default:t}}function j(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)}function P(t,e,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!o:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(t,r):o?o.value=r:e.set(t,r),r}
},{}],"I8v3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.$=Wt,exports.C=exports.B=exports.A=void 0,exports.D=S,exports.E=xe,exports.V=exports.U=exports.T=exports.S=exports.R=exports.Q=exports.P=exports.O=exports.N=exports.M=exports.L=exports.K=exports.J=exports.I=exports.H=exports.G=exports.F=void 0,exports.W=St,exports.X=Ut,exports.Y=Ft,exports.Z=Vt,exports._=jt,exports.a=void 0,exports.a0=Kt,exports.a1=Jt,exports.a2=Bt,exports.a3=$t,exports.a4=Yt,exports.a5=Xt,exports.a6=Qt,exports.a7=Zt,exports.a8=en,exports.a9=nn,exports.aA=gr,exports.aB=or,exports.aC=Le,exports.aE=exports.aD=void 0,exports.aF=De,exports.aG=Kn,exports.aJ=exports.aI=exports.aH=void 0,exports.aa=rn,exports.ab=sn,exports.ac=void 0,exports.ad=ht,exports.ae=an,exports.af=cn,exports.ag=un,exports.ah=X,exports.ai=Q,exports.aj=Dt,exports.ak=In,exports.al=ae,exports.am=Sn,exports.an=Ln,exports.ao=Re,exports.ap=A,exports.aq=Ne,exports.ar=Ee,exports.as=I,exports.at=Yr,exports.au=Er,exports.av=_,exports.aw=E,exports.ax=R,exports.ay=ge,exports.b=exports.az=void 0,exports.c=Xi,exports.d=Zi,exports.e=Qi,exports.f=ur,exports.g=pr,exports.h=lr,exports.i=void 0,exports.j=fr,exports.k=void 0,exports.l=Vi,exports.m=void 0,exports.n=us,exports.o=void 0,exports.p=_n,exports.q=yn,exports.r=qi,exports.s=Fi,exports.t=Tn,exports.u=Hi,exports.v=wn,exports.w=En,exports.x=kn,exports.y=An,exports.z=void 0;var e=require("@firebase/util"),t=require("@firebase/app"),n=require("tslib"),i=require("@firebase/logger"),r=require("@firebase/component");const s={PHONE:"phone"};exports.F=s;const o={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"};exports.o=o;const a={EMAIL_LINK:"emailLink",EMAIL_PASSWORD:"password",FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PHONE:"phone",TWITTER:"twitter.com"};exports.S=a;const c={LINK:"link",REAUTHENTICATE:"reauthenticate",SIGN_IN:"signIn"};exports.O=c;const u={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function d(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}}function l(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}exports.A=u;const h=d;exports.z=h;const p=l;exports.B=p;const m=new e.ErrorFactory("auth","Firebase",l()),f={ADMIN_ONLY_OPERATION:"auth/admin-restricted-operation",ARGUMENT_ERROR:"auth/argument-error",APP_NOT_AUTHORIZED:"auth/app-not-authorized",APP_NOT_INSTALLED:"auth/app-not-installed",CAPTCHA_CHECK_FAILED:"auth/captcha-check-failed",CODE_EXPIRED:"auth/code-expired",CORDOVA_NOT_READY:"auth/cordova-not-ready",CORS_UNSUPPORTED:"auth/cors-unsupported",CREDENTIAL_ALREADY_IN_USE:"auth/credential-already-in-use",CREDENTIAL_MISMATCH:"auth/custom-token-mismatch",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"auth/requires-recent-login",DEPENDENT_SDK_INIT_BEFORE_AUTH:"auth/dependent-sdk-initialized-before-auth",DYNAMIC_LINK_NOT_ACTIVATED:"auth/dynamic-link-not-activated",EMAIL_CHANGE_NEEDS_VERIFICATION:"auth/email-change-needs-verification",EMAIL_EXISTS:"auth/email-already-in-use",EMULATOR_CONFIG_FAILED:"auth/emulator-config-failed",EXPIRED_OOB_CODE:"auth/expired-action-code",EXPIRED_POPUP_REQUEST:"auth/cancelled-popup-request",INTERNAL_ERROR:"auth/internal-error",INVALID_API_KEY:"auth/invalid-api-key",INVALID_APP_CREDENTIAL:"auth/invalid-app-credential",INVALID_APP_ID:"auth/invalid-app-id",INVALID_AUTH:"auth/invalid-user-token",INVALID_AUTH_EVENT:"auth/invalid-auth-event",INVALID_CERT_HASH:"auth/invalid-cert-hash",INVALID_CODE:"auth/invalid-verification-code",INVALID_CONTINUE_URI:"auth/invalid-continue-uri",INVALID_CORDOVA_CONFIGURATION:"auth/invalid-cordova-configuration",INVALID_CUSTOM_TOKEN:"auth/invalid-custom-token",INVALID_DYNAMIC_LINK_DOMAIN:"auth/invalid-dynamic-link-domain",INVALID_EMAIL:"auth/invalid-email",INVALID_EMULATOR_SCHEME:"auth/invalid-emulator-scheme",INVALID_IDP_RESPONSE:"auth/invalid-credential",INVALID_MESSAGE_PAYLOAD:"auth/invalid-message-payload",INVALID_MFA_SESSION:"auth/invalid-multi-factor-session",INVALID_OAUTH_CLIENT_ID:"auth/invalid-oauth-client-id",INVALID_OAUTH_PROVIDER:"auth/invalid-oauth-provider",INVALID_OOB_CODE:"auth/invalid-action-code",INVALID_ORIGIN:"auth/unauthorized-domain",INVALID_PASSWORD:"auth/wrong-password",INVALID_PERSISTENCE:"auth/invalid-persistence-type",INVALID_PHONE_NUMBER:"auth/invalid-phone-number",INVALID_PROVIDER_ID:"auth/invalid-provider-id",INVALID_RECIPIENT_EMAIL:"auth/invalid-recipient-email",INVALID_SENDER:"auth/invalid-sender",INVALID_SESSION_INFO:"auth/invalid-verification-id",INVALID_TENANT_ID:"auth/invalid-tenant-id",MFA_INFO_NOT_FOUND:"auth/multi-factor-info-not-found",MFA_REQUIRED:"auth/multi-factor-auth-required",MISSING_ANDROID_PACKAGE_NAME:"auth/missing-android-pkg-name",MISSING_APP_CREDENTIAL:"auth/missing-app-credential",MISSING_AUTH_DOMAIN:"auth/auth-domain-config-required",MISSING_CODE:"auth/missing-verification-code",MISSING_CONTINUE_URI:"auth/missing-continue-uri",MISSING_IFRAME_START:"auth/missing-iframe-start",MISSING_IOS_BUNDLE_ID:"auth/missing-ios-bundle-id",MISSING_OR_INVALID_NONCE:"auth/missing-or-invalid-nonce",MISSING_MFA_INFO:"auth/missing-multi-factor-info",MISSING_MFA_SESSION:"auth/missing-multi-factor-session",MISSING_PHONE_NUMBER:"auth/missing-phone-number",MISSING_SESSION_INFO:"auth/missing-verification-id",MODULE_DESTROYED:"auth/app-deleted",NEED_CONFIRMATION:"auth/account-exists-with-different-credential",NETWORK_REQUEST_FAILED:"auth/network-request-failed",NULL_USER:"auth/null-user",NO_AUTH_EVENT:"auth/no-auth-event",NO_SUCH_PROVIDER:"auth/no-such-provider",OPERATION_NOT_ALLOWED:"auth/operation-not-allowed",OPERATION_NOT_SUPPORTED:"auth/operation-not-supported-in-this-environment",POPUP_BLOCKED:"auth/popup-blocked",POPUP_CLOSED_BY_USER:"auth/popup-closed-by-user",PROVIDER_ALREADY_LINKED:"auth/provider-already-linked",QUOTA_EXCEEDED:"auth/quota-exceeded",REDIRECT_CANCELLED_BY_USER:"auth/redirect-cancelled-by-user",REDIRECT_OPERATION_PENDING:"auth/redirect-operation-pending",REJECTED_CREDENTIAL:"auth/rejected-credential",SECOND_FACTOR_ALREADY_ENROLLED:"auth/second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"auth/maximum-second-factor-count-exceeded",TENANT_ID_MISMATCH:"auth/tenant-id-mismatch",TIMEOUT:"auth/timeout",TOKEN_EXPIRED:"auth/user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"auth/too-many-requests",UNAUTHORIZED_DOMAIN:"auth/unauthorized-continue-uri",UNSUPPORTED_FIRST_FACTOR:"auth/unsupported-first-factor",UNSUPPORTED_PERSISTENCE:"auth/unsupported-persistence-type",UNSUPPORTED_TENANT_OPERATION:"auth/unsupported-tenant-operation",UNVERIFIED_EMAIL:"auth/unverified-email",USER_CANCELLED:"auth/user-cancelled",USER_DELETED:"auth/user-not-found",USER_DISABLED:"auth/user-disabled",USER_MISMATCH:"auth/user-mismatch",USER_SIGNED_OUT:"auth/user-signed-out",WEAK_PASSWORD:"auth/weak-password",WEB_STORAGE_UNSUPPORTED:"auth/web-storage-unsupported",ALREADY_INITIALIZED:"auth/already-initialized"};exports.C=f;const g=new i.Logger("@firebase/auth");function v(e,...n){g.logLevel<=i.LogLevel.ERROR&&g.error(`Auth (${t.SDK_VERSION}): ${e}`,...n)}function I(e,...t){throw w(e,...t)}function _(e,...t){return w(e,...t)}function y(t,n,i){const r=Object.assign(Object.assign({},p()),{[n]:i});return new e.ErrorFactory("auth","Firebase",r).create(n,{appName:t.name})}function T(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&I(e,"argument-error"),y(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.`+"Did you pass a reference from a different Auth SDK?")}function w(e,...t){if("string"!=typeof e){const n=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(n,...i)}return m.create(e,...t)}function E(e,t,...n){if(!e)throw w(t,...n)}function k(e){const t="INTERNAL ASSERTION FAILED: "+e;throw v(t),new Error(t)}function A(e,t){e||k(t)}const N=new Map;function R(e){A(e instanceof Function,"Expected a class definition");let t=N.get(e);return t?(A(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,N.set(e,t),t)}function S(n,i){const r=(0,t._getProvider)(n,"auth");if(r.isInitialized()){const t=r.getImmediate(),n=r.getOptions();if((0,e.deepEqual)(n,null!=i?i:{}))return t;I(t,"already-initialized")}return r.initialize({options:i})}function b(e,t){const n=(null==t?void 0:t.persistence)||[],i=(Array.isArray(n)?n:[n]).map(R);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,null==t?void 0:t.popupRedirectResolver)}function O(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function P(){return"http:"===D()||"https:"===D()}function D(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function C(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(P()||(0,e.isBrowserExtension)()||"connection"in navigator))||navigator.onLine}function L(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}class M{constructor(t,n){this.shortDelay=t,this.longDelay=n,A(n>t,"Short delay should be less than long delay!"),this.isMobile=(0,e.isMobileCordova)()||(0,e.isReactNative)()}get(){return C()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function x(e,t){A(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class U{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void k("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void k("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void k("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}exports.aI=U;const F={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},V=new M(3e4,6e4);function q(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function j(t,n,i,r,s={}){return H(t,s,()=>{let s={},o={};r&&("GET"===n?o=r:s={body:JSON.stringify(r)});const a=(0,e.querystring)(Object.assign({key:t.config.apiKey},o)).slice(1),c=new(U.headers());return c.set("Content-Type","application/json"),c.set("X-Client-Version",t._getSdkClientVersion()),t.languageCode&&c.set("X-Firebase-Locale",t.languageCode),U.fetch()(G(t,t.config.apiHost,i,a),Object.assign({method:n,headers:c,referrerPolicy:"no-referrer"},s))})}async function H(t,n,i){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},F),n);try{const n=new W(t),o=await Promise.race([i(),n.promise]);n.clearNetworkTimeout();const a=await o.json();if("needConfirmation"in a)throw K(t,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{const e=o.ok?a.errorMessage:a.error.message,[n,i]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw K(t,"credential-already-in-use",a);if("EMAIL_EXISTS"===n)throw K(t,"email-already-in-use",a);const s=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(i)throw y(t,s,i);I(t,s)}}catch(s){if(s instanceof e.FirebaseError)throw s;I(t,"network-request-failed")}}async function z(e,t,n,i,r={}){const s=await j(e,t,n,i,r);return"mfaPendingCredential"in s&&I(e,"multi-factor-auth-required",{_serverResponse:s}),s}function G(e,t,n,i){const r=`${t}${n}?${i}`;return e.config.emulator?x(e.config,r):`${e.config.apiScheme}://${r}`}class W{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(_(this.auth,"timeout")),V.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function K(e,t,n){const i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=_(e,t,i);return r.customData._tokenResponse=n,r}async function J(e,t){return j(e,"POST","/v1/accounts:delete",t)}async function B(e,t){return j(e,"POST","/v1/accounts:update",t)}async function $(e,t){return j(e,"POST","/v1/accounts:lookup",t)}function Y(e){if(e)try{const n=new Date(Number(e));if(!isNaN(n.getTime()))return n.toUTCString()}catch(t){}}function X(t,n=!1){return(0,e.getModularInstance)(t).getIdToken(n)}async function Q(t,n=!1){const i=(0,e.getModularInstance)(t),r=await i.getIdToken(n),s=ee(r);E(s&&s.exp&&s.auth_time&&s.iat,i.auth,"internal-error");const o="object"==typeof s.firebase?s.firebase:void 0,a=null==o?void 0:o.sign_in_provider;return{claims:s,token:r,authTime:Y(Z(s.auth_time)),issuedAtTime:Y(Z(s.iat)),expirationTime:Y(Z(s.exp)),signInProvider:a||null,signInSecondFactor:(null==o?void 0:o.sign_in_second_factor)||null}}function Z(e){return 1e3*Number(e)}function ee(t){const[n,i,r]=t.split(".");if(void 0===n||void 0===i||void 0===r)return v("JWT malformed, contained fewer than 3 sections"),null;try{const t=(0,e.base64Decode)(i);return t?JSON.parse(t):(v("Failed to decode base64 JWT payload"),null)}catch(s){return v("Caught error parsing JWT payload as JSON",s),null}}function te(e){const t=ee(e);return E(t,"internal-error"),E(void 0!==t.exp,"internal-error"),E(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function ne(t,n,i=!1){if(i)return n;try{return await n}catch(r){throw r instanceof e.FirebaseError&&ie(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function ie({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}class re{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===e.code&&this.schedule(!0))}this.schedule()}}class se{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Y(this.lastLoginAt),this.creationTime=Y(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function oe(e){var t;const n=e.auth,i=await e.getIdToken(),r=await ne(e,$(n,{idToken:i}));E(null==r?void 0:r.users.length,n,"internal-error");const s=r.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?ue(s.providerUserInfo):[],a=ce(e.providerData,o),c=e.isAnonymous,u=!(e.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!c&&u,l={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new se(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,l)}async function ae(t){const n=(0,e.getModularInstance)(t);await oe(n),await n.auth._persistUserIfCurrent(n),n.auth._notifyListenersIfCurrent(n)}function ce(e,t){return[...e.filter(e=>!t.some(t=>t.providerId===e.providerId)),...t]}function ue(e){return e.map(e=>{var{providerId:t}=e,i=(0,n.__rest)(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}async function de(t,n){const i=await H(t,{},()=>{const i=(0,e.querystring)({grant_type:"refresh_token",refresh_token:n}).slice(1),{tokenApiHost:r,apiKey:s}=t.config,o=G(t,r,"/v1/token",`key=${s}`);return U.fetch()(o,{method:"POST",headers:{"X-Client-Version":t._getSdkClientVersion(),"Content-Type":"application/x-www-form-urlencoded"},body:i})});return{accessToken:i.access_token,expiresIn:i.expires_in,refreshToken:i.refresh_token}}class le{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){E(e.idToken,"internal-error"),E(void 0!==e.idToken,"internal-error"),E(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):te(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return E(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:r}=await de(e,t);this.updateTokensAndExpiration(n,i,Number(r))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:r}=t,s=new le;return n&&(E("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),i&&(E("string"==typeof i,"internal-error",{appName:e}),s.accessToken=i),r&&(E("number"==typeof r,"internal-error",{appName:e}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new le,this.toJSON())}_performRefresh(){return k("not implemented")}}function he(e,t){E("string"==typeof e||void 0===e,"internal-error",{appName:t})}class pe{constructor(e){var{uid:t,auth:i,stsTokenManager:r}=e,s=(0,n.__rest)(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.emailVerified=!1,this.isAnonymous=!1,this.tenantId=null,this.providerData=[],this.proactiveRefresh=new re(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.metadata=new se(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await ne(this,this.stsTokenManager.getToken(this.auth,e));return E(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Q(this,e)}reload(){return ae(this)}_assign(e){this!==e&&(E(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new pe(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){E(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await oe(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await ne(this,J(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,r,s,o,a,c,u;const d=null!==(n=t.displayName)&&void 0!==n?n:void 0,l=null!==(i=t.email)&&void 0!==i?i:void 0,h=null!==(r=t.phoneNumber)&&void 0!==r?r:void 0,p=null!==(s=t.photoURL)&&void 0!==s?s:void 0,m=null!==(o=t.tenantId)&&void 0!==o?o:void 0,f=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(c=t.createdAt)&&void 0!==c?c:void 0,v=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:I,emailVerified:_,isAnonymous:y,providerData:T,stsTokenManager:w}=t;E(I&&w,e,"internal-error");const k=le.fromJSON(this.name,w);E("string"==typeof I,e,"internal-error"),he(d,e.name),he(l,e.name),E("boolean"==typeof _,e,"internal-error"),E("boolean"==typeof y,e,"internal-error"),he(h,e.name),he(p,e.name),he(m,e.name),he(f,e.name),he(g,e.name),he(v,e.name);const A=new pe({uid:I,auth:e,email:l,emailVerified:_,displayName:d,isAnonymous:y,photoURL:p,phoneNumber:h,tenantId:m,stsTokenManager:k,createdAt:g,lastLoginAt:v});return T&&Array.isArray(T)&&(A.providerData=T.map(e=>Object.assign({},e))),f&&(A._redirectEventId=f),A}static async _fromIdTokenResponse(e,t,n=!1){const i=new le;i.updateFromServerResponse(t);const r=new pe({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await oe(r),r}}exports.aD=pe;class me{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}me.type="NONE";const fe=me;function ge(e,t,n){return`firebase:${e}:${t}:${n}`}exports.K=fe;class ve{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=ge(this.userKey,i.apiKey,r),this.fullPersistenceKey=ge("persistence",i.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?pe._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new ve(R(fe),e,n);const i=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let r=i[0]||R(fe);const s=ge(n,e.config.apiKey,e.name);let o=null;for(const u of t)try{const t=await u._get(s);if(t){const n=pe._fromJSON(e,t);u!==r&&(o=n),r=u;break}}catch(c){}const a=i.filter(e=>e._shouldAllowMigration);return r._shouldAllowMigration&&a.length?(r=a[0],o&&await r._set(s,o.toJSON()),await Promise.all(t.map(async e=>{if(e!==r)try{await e._remove(s)}catch(c){}})),new ve(r,e,n)):new ve(r,e,n)}}function Ie(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(we(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(_e(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(ke(t))return"Blackberry";if(Ae(t))return"Webos";if(ye(t))return"Safari";if((t.includes("chrome/")||Te(t))&&!t.includes("edge/"))return"Chrome";if(Ee(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function _e(t=(0,e.getUA)()){return/firefox\//i.test(t)}function ye(t=(0,e.getUA)()){const n=t.toLowerCase();return n.includes("safari/")&&!n.includes("chrome/")&&!n.includes("crios/")&&!n.includes("android")}function Te(t=(0,e.getUA)()){return/crios\//i.test(t)}function we(t=(0,e.getUA)()){return/iemobile/i.test(t)}function Ee(t=(0,e.getUA)()){return/android/i.test(t)}function ke(t=(0,e.getUA)()){return/blackberry/i.test(t)}function Ae(t=(0,e.getUA)()){return/webos/i.test(t)}function Ne(t=(0,e.getUA)()){return/iphone|ipad|ipod/i.test(t)}function Re(t=(0,e.getUA)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(t)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(t)}function Se(t=(0,e.getUA)()){var n;return Ne(t)&&!!(null===(n=window.navigator)||void 0===n?void 0:n.standalone)}function be(){return(0,e.isIE)()&&10===document.documentMode}function Oe(t=(0,e.getUA)()){return Ne(t)||Ee(t)||Ae(t)||ke(t)||/windows phone/i.test(t)||we(t)}function Pe(){try{return!(!window||window===window.top)}catch(e){return!1}}function De(n,i=[]){let r;switch(n){case"Browser":r=Ie((0,e.getUA)());break;case"Worker":r=`${Ie((0,e.getUA)())}-${n}`;break;default:r=n}const s=i.length?i.join(","):"FirebaseCore-web";return`${r}/JsCore/${t.SDK_VERSION}/${s}`}class Ce{constructor(e,t){this.app=e,this.config=t,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Me(this),this.idTokenSubscription=new Me(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=m,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=t.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=R(t)),this._initializationPromise=this.queue(async()=>{var n,i;this._deleted||(this.persistenceManager=await ve.create(this,e),this._deleted||((null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)&&await this._popupRedirectResolver._initialize(this),await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)))}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void(await this.currentUser.getIdToken())):void(await this._updateCurrentUser(e)):void 0}async initializeCurrentUser(e){var t;let n=await this.assertedPersistence.getCurrentUser();if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,r=null==n?void 0:n._redirectEventId,s=await this.tryRedirectSignIn(e);i&&i!==r||null==s||!s.user||(n=s.user)}return n?n._redirectEventId?(E(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)):this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await oe(e)}catch(t){if("auth/network-request-failed"!==t.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=L()}async _delete(){this._deleted=!0}async updateCurrentUser(t){const n=t?(0,e.getModularInstance)(t):null;return n&&E(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e){if(!this._deleted)return e&&E(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(R(e))})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new e.ErrorFactory("auth","Firebase",t())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&R(e)||this._popupRedirectResolver;E(t,this,"argument-error"),this.redirectPersistenceManager=await ve.create(this,[R(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const r="function"==typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return E(s,this,"internal-error"),s.then(()=>r(this.currentUser)),"function"==typeof t?e.addObserver(t,n,i):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&(this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh()),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return E(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=De(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getSdkClientVersion(){return this.clientVersion}}function Le(t){return(0,e.getModularInstance)(t)}exports.aE=Ce;class Me{constructor(t){this.auth=t,this.observer=null,this.addObserver=(0,e.createSubscribe)(e=>this.observer=e)}get next(){return E(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function xe(e,t,n){const i=Le(e);E(i._canInitEmulator,i,"emulator-config-failed"),E(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const r=!!(null==n?void 0:n.disableWarnings),s=Ue(t),{host:o,port:a}=Fe(t),c=null===a?"":`:${a}`;i.config.emulator={url:`${s}//${o}${c}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||qe()}function Ue(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Fe(e){const t=Ue(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const e=r[1];return{host:e,port:Ve(i.substr(e.length+1))}}{const[e,t]=i.split(":");return{host:e,port:Ve(t)}}}function Ve(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}function qe(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}class je{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return k("not implemented")}_getIdTokenResponse(e){return k("not implemented")}_linkToIdToken(e,t){return k("not implemented")}_getReauthenticationResolver(e){return k("not implemented")}}async function He(e,t){return j(e,"POST","/v1/accounts:resetPassword",q(e,t))}async function ze(e,t){return j(e,"POST","/v1/accounts:update",t)}async function Ge(e,t){return j(e,"POST","/v1/accounts:update",q(e,t))}async function We(e,t){return z(e,"POST","/v1/accounts:signInWithPassword",q(e,t))}async function Ke(e,t){return j(e,"POST","/v1/accounts:sendOobCode",q(e,t))}async function Je(e,t){return Ke(e,t)}async function Be(e,t){return Ke(e,t)}async function $e(e,t){return Ke(e,t)}async function Ye(e,t){return Ke(e,t)}async function Xe(e,t){return z(e,"POST","/v1/accounts:signInWithEmailLink",q(e,t))}async function Qe(e,t){return z(e,"POST","/v1/accounts:signInWithEmailLink",q(e,t))}exports.G=je;class Ze extends je{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Ze(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Ze(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return We(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return Xe(e,{email:this._email,oobCode:this._password});default:I(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return ze(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return Qe(e,{idToken:t,email:this._email,oobCode:this._password});default:I(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function et(e,t){return z(e,"POST","/v1/accounts:signInWithIdp",q(e,t))}exports.H=Ze;const tt="http://localhost";class nt extends je{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new nt(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):I("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:i,signInMethod:r}=t,s=(0,n.__rest)(t,["providerId","signInMethod"]);if(!i||!r)return null;const o=new nt(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){return et(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,et(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,et(e,t)}buildRequest(){const t={requestUri:tt,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),t.postBody=(0,e.querystring)(n)}return t}}async function it(e,t){return j(e,"POST","/v1/accounts:sendVerificationCode",q(e,t))}async function rt(e,t){return z(e,"POST","/v1/accounts:signInWithPhoneNumber",q(e,t))}async function st(e,t){const n=await z(e,"POST","/v1/accounts:signInWithPhoneNumber",q(e,t));if(n.temporaryProof)throw K(e,"account-exists-with-different-credential",n);return n}exports.I=nt;const ot={USER_NOT_FOUND:"user-not-found"};async function at(e,t){return z(e,"POST","/v1/accounts:signInWithPhoneNumber",q(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),ot)}class ct extends je{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new ct({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new ct({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return rt(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return st(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return at(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}=e;return n||t||i||r?new ct({verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}function ut(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function dt(t){const n=(0,e.querystringDecode)((0,e.extractQuerystring)(t)).link,i=n?(0,e.querystringDecode)((0,e.extractQuerystring)(n)).deep_link_id:null,r=(0,e.querystringDecode)((0,e.extractQuerystring)(t)).deep_link_id;return(r?(0,e.querystringDecode)((0,e.extractQuerystring)(r)).link:null)||r||i||n||t}exports.J=ct;class lt{constructor(t){var n,i,r,s,o,a;const c=(0,e.querystringDecode)((0,e.extractQuerystring)(t)),u=null!==(n=c.apiKey)&&void 0!==n?n:null,d=null!==(i=c.oobCode)&&void 0!==i?i:null,l=ut(null!==(r=c.mode)&&void 0!==r?r:null);E(u&&d&&l,"argument-error"),this.apiKey=u,this.operation=l,this.code=d,this.continueUrl=null!==(s=c.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(o=c.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(a=c.tenantId)&&void 0!==a?a:null}static parseLink(e){const t=dt(e);try{return new lt(t)}catch(n){return null}}}function ht(e){return lt.parseLink(e)}exports.ac=lt;class pt{constructor(){this.providerId=pt.PROVIDER_ID}static credential(e,t){return Ze._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=lt.parseLink(t);return E(n,"argument-error"),Ze._fromEmailAndCode(e,n.code,n.tenantId)}}exports.L=pt,pt.PROVIDER_ID="password",pt.EMAIL_PASSWORD_SIGN_IN_METHOD="password",pt.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class mt{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class ft extends mt{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class gt extends ft{static credentialFromJSON(e){const t="string"==typeof e?JSON.parse(e):e;return E("providerId"in t&&"signInMethod"in t,"argument-error"),nt._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return E(e.idToken||e.accessToken,"argument-error"),nt._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return gt.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return gt.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n,oauthTokenSecret:i,pendingToken:r,nonce:s,providerId:o}=e;if(!(n||i||t||r))return null;if(!o)return null;try{return new gt(o)._credential({idToken:t,accessToken:n,nonce:s,pendingToken:r})}catch(a){return null}}}exports.T=gt;class vt extends ft{constructor(){super("facebook.com")}static credential(e){return nt._fromParams({providerId:vt.PROVIDER_ID,signInMethod:vt.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return vt.credentialFromTaggedObject(e)}static credentialFromError(e){return vt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!(e&&"oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return vt.credential(e.oauthAccessToken)}catch(t){return null}}}exports.M=vt,vt.FACEBOOK_SIGN_IN_METHOD="facebook.com",vt.PROVIDER_ID="facebook.com";class It extends ft{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return nt._fromParams({providerId:It.PROVIDER_ID,signInMethod:It.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return It.credentialFromTaggedObject(e)}static credentialFromError(e){return It.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return It.credential(t,n)}catch(i){return null}}}exports.N=It,It.GOOGLE_SIGN_IN_METHOD="google.com",It.PROVIDER_ID="google.com";class _t extends ft{constructor(){super("github.com")}static credential(e){return nt._fromParams({providerId:_t.PROVIDER_ID,signInMethod:_t.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _t.credentialFromTaggedObject(e)}static credentialFromError(e){return _t.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!(e&&"oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return _t.credential(e.oauthAccessToken)}catch(t){return null}}}exports.Q=_t,_t.GITHUB_SIGN_IN_METHOD="github.com",_t.PROVIDER_ID="github.com";const yt="http://localhost";class Tt extends je{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){return et(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,et(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,et(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i,pendingToken:r}=t;return n&&i&&r&&n===i?new Tt(n,r):null}static _create(e,t){return new Tt(e,t)}buildRequest(){return{requestUri:yt,returnSecureToken:!0,pendingToken:this.pendingToken}}}exports.aJ=Tt;const wt="saml.";class Et extends mt{constructor(e){E(e.startsWith(wt),"argument-error"),super(e)}static credentialFromResult(e){return Et.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Et.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=Tt.fromJSON(e);return E(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:n}=e;if(!t||!n)return null;try{return Tt._create(n,t)}catch(i){return null}}}exports.U=Et;class kt extends ft{constructor(){super("twitter.com")}static credential(e,t){return nt._fromParams({providerId:kt.PROVIDER_ID,signInMethod:kt.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return kt.credentialFromTaggedObject(e)}static credentialFromError(e){return kt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return kt.credential(t,n)}catch(i){return null}}}async function At(e,t){return z(e,"POST","/v1/accounts:signUp",q(e,t))}exports.V=kt,kt.TWITTER_SIGN_IN_METHOD="twitter.com",kt.PROVIDER_ID="twitter.com";class Nt{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,i=!1){const r=await pe._fromIdTokenResponse(e,n,i),s=Rt(n);return new Nt({user:r,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=Rt(n);return new Nt({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function Rt(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}async function St(e){var t;const n=Le(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new Nt({user:n.currentUser,providerId:null,operationType:"signIn"});const i=await At(n,{returnSecureToken:!0}),r=await Nt._fromIdTokenResponse(n,"signIn",i,!0);return await n._updateCurrentUser(r.user),r}class bt extends e.FirebaseError{constructor(e,t,n,i){var r;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,bt.prototype),this.customData={appName:e.name,tenantId:null!==(r=e.tenantId)&&void 0!==r?r:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new bt(e,t,n,i)}}function Ot(e,t,n,i){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if("auth/multi-factor-auth-required"===n.code)throw bt._fromErrorAndOperation(e,n,t,i);throw n})}function Pt(e){return new Set(e.map(({providerId:e})=>e).filter(e=>!!e))}async function Dt(t,n){const i=(0,e.getModularInstance)(t);await Lt(!0,i,n);const{providerUserInfo:r}=await B(i.auth,{idToken:await i.getIdToken(),deleteProvider:[n]}),s=Pt(r||[]);return i.providerData=i.providerData.filter(e=>s.has(e.providerId)),s.has("phone")||(i.phoneNumber=null),await i.auth._persistUserIfCurrent(i),i}async function Ct(e,t,n=!1){const i=await ne(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Nt._forOperation(e,"link",i)}async function Lt(e,t,n){await oe(t);const i=!1===e?"provider-already-linked":"no-such-provider";E(Pt(t.providerData).has(n)===e,t.auth,i)}async function Mt(e,t,n=!1){const{auth:i}=e;try{const s=await ne(e,Ot(i,"reauthenticate",t,e),n);E(s.idToken,i,"internal-error");const o=ee(s.idToken);E(o,i,"internal-error");const{sub:a}=o;return E(e.uid===a,i,"user-mismatch"),Nt._forOperation(e,"reauthenticate",s)}catch(r){throw"auth/user-not-found"===(null==r?void 0:r.code)&&I(i,"user-mismatch"),r}}async function xt(e,t,n=!1){const i=await Ot(e,"signIn",t),r=await Nt._fromIdTokenResponse(e,"signIn",i);return n||await e._updateCurrentUser(r.user),r}async function Ut(e,t){return xt(Le(e),t)}async function Ft(t,n){const i=(0,e.getModularInstance)(t);return await Lt(!1,i,n.providerId),Ct(i,n)}async function Vt(t,n){return Mt((0,e.getModularInstance)(t),n)}async function qt(e,t){return z(e,"POST","/v1/accounts:signInWithCustomToken",q(e,t))}async function jt(e,t){const n=Le(e),i=await qt(n,{token:t,returnSecureToken:!0}),r=await Nt._fromIdTokenResponse(n,"signIn",i);return await n._updateCurrentUser(r.user),r}class Ht{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?zt._fromServerResponse(e,t):I(e,"internal-error")}}class zt extends Ht{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new zt(t)}}function Gt(e,t,n){var i;E((null===(i=n.url)||void 0===i?void 0:i.length)>0,e,"invalid-continue-uri"),E(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(E(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(E(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function Wt(t,n,i){const r=(0,e.getModularInstance)(t),s={requestType:"PASSWORD_RESET",email:n};i&&Gt(r,s,i),await Be(r,s)}async function Kt(t,n,i){await He((0,e.getModularInstance)(t),{oobCode:n,newPassword:i})}async function Jt(t,n){await Ge((0,e.getModularInstance)(t),{oobCode:n})}async function Bt(t,n){const i=(0,e.getModularInstance)(t),r=await He(i,{oobCode:n}),s=r.requestType;switch(E(s,i,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":E(r.newEmail,i,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":E(r.mfaInfo,i,"internal-error");default:E(r.email,i,"internal-error")}let o=null;return r.mfaInfo&&(o=Ht._fromServerResponse(Le(i),r.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.newEmail:r.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.email:r.newEmail)||null,multiFactorInfo:o},operation:s}}async function $t(t,n){const{data:i}=await Bt((0,e.getModularInstance)(t),n);return i.email}async function Yt(e,t,n){const i=Le(e),r=await At(i,{returnSecureToken:!0,email:t,password:n}),s=await Nt._fromIdTokenResponse(i,"signIn",r);return await i._updateCurrentUser(s.user),s}function Xt(t,n,i){return Ut((0,e.getModularInstance)(t),pt.credential(n,i))}async function Qt(t,n,i){const r=(0,e.getModularInstance)(t),s={requestType:"EMAIL_SIGNIN",email:n};E(i.handleCodeInApp,r,"argument-error"),i&&Gt(r,s,i),await $e(r,s)}function Zt(e,t){const n=lt.parseLink(t);return"EMAIL_SIGNIN"===(null==n?void 0:n.operation)}async function en(t,n,i){const r=(0,e.getModularInstance)(t),s=pt.credentialWithLink(n,i||O());return E(s._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Ut(r,s)}async function tn(e,t){return j(e,"POST","/v1/accounts:createAuthUri",q(e,t))}async function nn(t,n){const i={identifier:n,continueUri:P()?O():"http://localhost"},{signinMethods:r}=await tn((0,e.getModularInstance)(t),i);return r||[]}async function rn(t,n){const i=(0,e.getModularInstance)(t),r={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()};n&&Gt(i.auth,r,n);const{email:s}=await Je(i.auth,r);s!==t.email&&await t.reload()}async function sn(t,n,i){const r=(0,e.getModularInstance)(t),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await t.getIdToken(),newEmail:n};i&&Gt(r.auth,s,i);const{email:o}=await Ye(r.auth,s);o!==t.email&&await t.reload()}async function on(e,t){return j(e,"POST","/v1/accounts:update",t)}async function an(t,{displayName:n,photoURL:i}){if(void 0===n&&void 0===i)return;const r=(0,e.getModularInstance)(t),s={idToken:await r.getIdToken(),displayName:n,photoUrl:i,returnSecureToken:!0},o=await ne(r,on(r.auth,s));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:e})=>"password"===e);a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function cn(t,n){return dn((0,e.getModularInstance)(t),n,null)}function un(t,n){return dn((0,e.getModularInstance)(t),null,n)}async function dn(e,t,n){const{auth:i}=e,r={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(r.email=t),n&&(r.password=n);const s=await ne(e,ze(i,r));await e._updateTokensIfNecessary(s,!0)}function ln(e){var t,n;if(!e)return null;const{providerId:i}=e,r=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},s=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!i&&(null==e?void 0:e.idToken)){const i=null===(n=null===(t=ee(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(i){return new hn(s,"anonymous"!==i&&"custom"!==i?i:null)}}if(!i)return null;switch(i){case"facebook.com":return new mn(s,r);case"github.com":return new fn(s,r);case"google.com":return new gn(s,r);case"twitter.com":return new vn(s,r,e.screenName||null);case"custom":case"anonymous":return new hn(s,null);default:return new hn(s,i,r)}}class hn{constructor(e,t,n={}){this.isNewUser=e,this.providerId=t,this.profile=n}}class pn extends hn{constructor(e,t,n,i){super(e,t,n),this.username=i}}class mn extends hn{constructor(e,t){super(e,"facebook.com",t)}}class fn extends pn{constructor(e,t){super(e,"github.com",t,"string"==typeof(null==t?void 0:t.login)?null==t?void 0:t.login:null)}}class gn extends hn{constructor(e,t){super(e,"google.com",t)}}class vn extends pn{constructor(e,t,n){super(e,"twitter.com",t,n)}}function In(e){const{user:t,_tokenResponse:n}=e;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:ln(n)}function _n(t,n){return(0,e.getModularInstance)(t).setPersistence(n)}function yn(t,n,i,r){return(0,e.getModularInstance)(t).onIdTokenChanged(n,i,r)}function Tn(t,n,i,r){return(0,e.getModularInstance)(t).onAuthStateChanged(n,i,r)}function wn(t){(0,e.getModularInstance)(t).useDeviceLanguage()}function En(t,n){return(0,e.getModularInstance)(t).updateCurrentUser(n)}function kn(t){return(0,e.getModularInstance)(t).signOut()}async function An(t){return(0,e.getModularInstance)(t).delete()}class Nn{constructor(e,t){this.type=e,this.credential=t}static _fromIdtoken(e){return new Nn("enroll",e)}static _fromMfaPendingCredential(e){return new Nn("signin",e)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,n;if(null==e?void 0:e.multiFactorSession){if(null===(t=e.multiFactorSession)||void 0===t?void 0:t.pendingCredential)return Nn._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(null===(n=e.multiFactorSession)||void 0===n?void 0:n.idToken)return Nn._fromIdtoken(e.multiFactorSession.idToken)}return null}}class Rn{constructor(e,t,n){this.session=e,this.hints=t,this.signInResolver=n}static _fromError(e,t){const n=Le(e),i=t.customData._serverResponse,r=(i.mfaInfo||[]).map(e=>Ht._fromServerResponse(n,e));E(i.mfaPendingCredential,n,"internal-error");const s=Nn._fromMfaPendingCredential(i.mfaPendingCredential);return new Rn(s,r,async e=>{const r=await e._process(n,s);delete i.mfaInfo,delete i.mfaPendingCredential;const o=Object.assign(Object.assign({},i),{idToken:r.idToken,refreshToken:r.refreshToken});switch(t.operationType){case"signIn":const e=await Nt._fromIdTokenResponse(n,t.operationType,o);return await n._updateCurrentUser(e.user),e;case"reauthenticate":return E(t.user,n,"internal-error"),Nt._forOperation(t.user,t.operationType,o);default:I(n,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function Sn(t,n){var i;const r=(0,e.getModularInstance)(t),s=n;return E(n.customData.operationType,r,"argument-error"),E(null===(i=s.customData._serverResponse)||void 0===i?void 0:i.mfaPendingCredential,r,"argument-error"),Rn._fromError(r,s)}function bn(e,t){return j(e,"POST","/v2/accounts/mfaEnrollment:start",q(e,t))}function On(e,t){return j(e,"POST","/v2/accounts/mfaEnrollment:finalize",q(e,t))}function Pn(e,t){return j(e,"POST","/v2/accounts/mfaEnrollment:withdraw",q(e,t))}class Dn{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(t=>Ht._fromServerResponse(e.auth,t)))})}static _fromUser(e){return new Dn(e)}async getSession(){return Nn._fromIdtoken(await this.user.getIdToken())}async enroll(e,t){const n=e,i=await this.getSession(),r=await ne(this.user,n._process(this.user.auth,i,t));return await this.user._updateTokensIfNecessary(r),this.user.reload()}async unenroll(e){const t="string"==typeof e?e:e.uid,n=await this.user.getIdToken(),i=await ne(this.user,Pn(this.user.auth,{idToken:n,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:e})=>e!==t),await this.user._updateTokensIfNecessary(i);try{await this.user.reload()}catch(r){if("auth/user-token-expired"!==r.code)throw r}}}const Cn=new WeakMap;function Ln(t){const n=(0,e.getModularInstance)(t);return Cn.has(n)||Cn.set(n,Dn._fromUser(n)),Cn.get(n)}const Mn="__sak";class xn{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Mn,"1"),this.storage.removeItem(Mn),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}function Un(){const t=(0,e.getUA)();return ye(t)||Ne(t)}const Fn=1e3,Vn=10;class qn extends xn{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=((e,t)=>this.onStorageEvent(e,t)),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=Un()&&Pe(),this.fallbackToPolling=Oe(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},r=this.storage.getItem(n);be()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Vn):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},Fn)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}qn.type="LOCAL";const jn=qn;exports.b=jn;class Hn extends xn{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Hn.type="SESSION";const zn=Hn;function Gn(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}exports.a=zn;class Wn{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new Wn(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:r}=t.data,s=this.handlersMap[i];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map(async e=>e(t.origin,r)),a=await Gn(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Kn(e="",t=10){let n="";for(let i=0;i<t;i++)n+=Math.floor(10*Math.random());return e+n}Wn.receivers=[];class Jn{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,s;return new Promise((o,a)=>{const c=Kn("",20);i.port1.start();const u=setTimeout(()=>{a(new Error("unsupported_event"))},n);s={messageChannel:i,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(u),r=setTimeout(()=>{a(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),o(t.data.response);break;default:clearTimeout(u),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}function Bn(){return window}function $n(e){Bn().location.href=e}function Yn(){return void 0!==Bn().WorkerGlobalScope&&"function"==typeof Bn().importScripts}async function Xn(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}function Qn(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}function Zn(){return Yn()?self:null}const ei="firebaseLocalStorageDb",ti=1,ni="firebaseLocalStorage",ii="fbase_key";class ri{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function si(e,t){return e.transaction([ni],t?"readwrite":"readonly").objectStore(ni)}function oi(){const e=indexedDB.deleteDatabase(ei);return new ri(e).toPromise()}function ai(){const e=indexedDB.open(ei,ti);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(ni,{keyPath:ii})}catch(i){n(i)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(ni)?t(n):(n.close(),await oi(),t(await ai()))})})}async function ci(e,t,n){const i=si(e,!0).put({[ii]:t,value:n});return new ri(i).toPromise()}async function ui(e,t){const n=si(e,!1).get(t),i=await new ri(n).toPromise();return void 0===i?null:i.value}function di(e,t){const n=si(e,!0).delete(t);return new ri(n).toPromise()}const li=800,hi=3;class pi{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ai(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(n){if(t++>hi)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Yn()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Wn._getInstance(Zn()),this.receiver._subscribe("keyChanged",async(e,t)=>{return{keyProcessed:(await this._poll()).includes(t.key)}}),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await Xn(),!this.activeServiceWorker)return;this.sender=new Jn(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&Qn()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await ai();return await ci(t,Mn,"1"),await di(t,Mn),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>ci(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>ui(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>di(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=si(e,!1).getAll();return new ri(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:i,value:r}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),li)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}pi.type="LOCAL";const mi=pi;function fi(e,t){return j(e,"POST","/v2/accounts/mfaSignIn:start",q(e,t))}function gi(e,t){return j(e,"POST","/v2/accounts/mfaSignIn:finalize",q(e,t))}async function vi(e){return(await j(e,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}function Ii(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}function _i(e){return new Promise((t,n)=>{const i=document.createElement("script");i.setAttribute("src",e),i.onload=t,i.onerror=(e=>{const t=_("internal-error");t.customData=e,n(t)}),i.type="text/javascript",i.charset="UTF-8",Ii().appendChild(i)})}function yi(e){return`__${e}${Math.floor(1e6*Math.random())}`}exports.i=mi;const Ti=500,wi=6e4,Ei=1e12;class ki{constructor(e){this.auth=e,this.counter=Ei,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new Ai(e,this.auth.name,t||{})),this.counter++,n}reset(e){var t;const n=e||Ei;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}getResponse(e){var t;const n=e||Ei;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}async execute(e){var t;const n=e||Ei;return null===(t=this._widgets.get(n))||void 0===t||t.execute(),""}}class Ai{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=(()=>{this.execute()});const i="string"==typeof e?document.getElementById(e):e;E(i,"argument-error",{appName:t}),this.container=i,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout(()=>{this.responseToken=Ni(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch(n){}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch(n){}this.isVisible&&this.execute()},wi)},Ti))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function Ni(e){const t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let i=0;i<e;i++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}const Ri=yi("rcb"),Si=new M(3e4,6e4),bi="https://www.google.com/recaptcha/api.js?";class Oi{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!Bn().grecaptcha}load(t,n=""){return E(Pi(n),t,"argument-error"),this.shouldResolveImmediately(n)?Promise.resolve(Bn().grecaptcha):new Promise((i,r)=>{const s=Bn().setTimeout(()=>{r(_(t,"network-request-failed"))},Si.get());Bn()[Ri]=(()=>{Bn().clearTimeout(s),delete Bn()[Ri];const e=Bn().grecaptcha;if(!e)return void r(_(t,"internal-error"));const o=e.render;e.render=((e,t)=>{const n=o(e,t);return this.counter++,n}),this.hostLanguage=n,i(e)}),_i(`${bi}?${(0,e.querystring)({onload:Ri,render:"explicit",hl:n})}`).catch(()=>{clearTimeout(s),r(_(t,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){return!!Bn().grecaptcha&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function Pi(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}class Di{async load(e){return new ki(e)}clearedOneInstance(){}}const Ci="recaptcha",Li={theme:"light",type:"image"};class Mi{constructor(e,t=Object.assign({},Li),n){this.parameters=t,this.type=Ci,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Le(n),this.isInvisible="invisible"===this.parameters.size,E("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const i="string"==typeof e?document.getElementById(e):e;E(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Di:new Oi,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),n=t.getResponse(e);return n||new Promise(n=>{const i=e=>{e&&(this.tokenChangeListeners.delete(i),n(e))};this.tokenChangeListeners.add(i),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){E(!this.parameters.sitekey,this.auth,"argument-error"),E(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),E("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(e=>e(t)),"function"==typeof e)e(t);else if("string"==typeof e){const n=Bn()[e];"function"==typeof n&&n(t)}}}assertNotDestroyed(){E(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){E(P()&&!Yn(),this.auth,"internal-error"),await xi(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await vi(this.auth);E(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return E(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function xi(){let e=null;return new Promise(t=>{"complete"!==document.readyState?(e=(()=>t()),window.addEventListener("load",e)):t()}).catch(t=>{throw e&&window.removeEventListener("load",e),t})}exports.R=Mi;class Ui{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=ct._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function Fi(t,n,i){const r=Le(t),s=await ji(r,n,(0,e.getModularInstance)(i));return new Ui(s,e=>Ut(r,e))}async function Vi(t,n,i){const r=(0,e.getModularInstance)(t);await Lt(!1,r,"phone");const s=await ji(r.auth,n,(0,e.getModularInstance)(i));return new Ui(s,e=>Ft(r,e))}async function qi(t,n,i){const r=(0,e.getModularInstance)(t),s=await ji(r.auth,n,(0,e.getModularInstance)(i));return new Ui(s,e=>Vt(r,e))}async function ji(e,t,n){var i;const r=await n.verify();try{let s;if(E("string"==typeof r,e,"argument-error"),E(n.type===Ci,e,"argument-error"),"session"in(s="string"==typeof t?{phoneNumber:t}:t)){const t=s.session;if("phoneNumber"in s){return E("enroll"===t.type,e,"internal-error"),(await bn(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}})).phoneSessionInfo.sessionInfo}{E("signin"===t.type,e,"internal-error");const n=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;return E(n,e,"missing-multi-factor-info"),(await fi(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await it(e,{phoneNumber:s.phoneNumber,recaptchaToken:r});return t}}finally{n._reset()}}async function Hi(t,n){await Ct((0,e.getModularInstance)(t),n)}class zi{constructor(e){this.providerId=zi.PROVIDER_ID,this.auth=Le(e)}verifyPhoneNumber(t,n){return ji(this.auth,t,(0,e.getModularInstance)(n))}static credential(e,t){return ct._fromVerification(e,t)}static credentialFromResult(e){const t=e;return zi.credentialFromTaggedObject(t)}static credentialFromError(e){return zi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?ct._fromTokenResponse(t,n):null}}function Gi(e,t){return t?R(t):(E(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}exports.P=zi,zi.PROVIDER_ID="phone",zi.PHONE_SIGN_IN_METHOD="phone";class Wi extends je{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return et(e,this._buildIdpRequest())}_linkToIdToken(e,t){return et(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return et(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Ki(e){return xt(e.auth,new Wi(e),e.bypassAuthState)}function Ji(e){const{auth:t,user:n}=e;return E(n,t,"internal-error"),Mt(n,new Wi(e),e.bypassAuthState)}async function Bi(e){const{auth:t,user:n}=e;return E(n,t,"internal-error"),Ct(n,new Wi(e),e.bypassAuthState)}class $i{constructor(e,t,n,i,r=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:r,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Ki;case"linkViaPopup":case"linkViaRedirect":return Bi;case"reauthViaPopup":case"reauthViaRedirect":return Ji;default:I(this.auth,"internal-error")}}resolve(e){A(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){A(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Yi=new M(2e3,1e4);async function Xi(e,t,n){const i=Le(e);T(e,t,mt);const r=Gi(i,n);return new er(i,"signInViaPopup",t,r).executeNotNull()}async function Qi(t,n,i){const r=(0,e.getModularInstance)(t);T(r.auth,n,mt);const s=Gi(r.auth,i);return new er(r.auth,"reauthViaPopup",n,s,r).executeNotNull()}async function Zi(t,n,i){const r=(0,e.getModularInstance)(t);T(r.auth,n,mt);const s=Gi(r.auth,i);return new er(r.auth,"linkViaPopup",n,s,r).executeNotNull()}class er extends $i{constructor(e,t,n,i,r){super(e,t,i,r),this.provider=n,this.authWindow=null,this.pollId=null,er.currentPopupAction&&er.currentPopupAction.cancel(),er.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return E(e,this.auth,"internal-error"),e}async onExecution(){A(1===this.filter.length,"Popup operations only handle one event");const e=Kn();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(_(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(_(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,er.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;null!==(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)&&void 0!==n&&n.closed?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_(this.auth,"popup-closed-by-user"))},2e3):this.pollId=window.setTimeout(e,Yi.get())};e()}}er.currentPopupAction=null;const tr="pendingRedirect",nr=new Map;class ir extends $i{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=nr.get(this.auth._key());if(!e){try{const n=await rr(this.resolver,this.auth)?await super.execute():null;e=(()=>Promise.resolve(n))}catch(t){e=(()=>Promise.reject(t))}nr.set(this.auth._key(),e)}return this.bypassAuthState||nr.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}async function rr(e,t){const n=cr(t),i=ar(e);if(!(await i._isAvailable()))return!1;const r="true"===await i._get(n);return await i._remove(n),r}async function sr(e,t){return ar(e)._set(cr(t),"true")}function or(){nr.clear()}function ar(e){return R(e._redirectPersistence)}function cr(e){return ge(tr,e.config.apiKey,e.name)}function ur(e,t,n){return dr(e,t,n)}async function dr(e,t,n){const i=Le(e);T(e,t,mt);const r=Gi(i,n);return await sr(r,i),r._openRedirect(i,t,"signInViaRedirect")}function lr(e,t,n){return hr(e,t,n)}async function hr(t,n,i){const r=(0,e.getModularInstance)(t);T(r.auth,n,mt);const s=Gi(r.auth,i);await sr(s,r.auth);const o=await vr(r);return s._openRedirect(r.auth,n,"reauthViaRedirect",o)}function pr(e,t,n){return mr(e,t,n)}async function mr(t,n,i){const r=(0,e.getModularInstance)(t);T(r.auth,n,mt);const s=Gi(r.auth,i);await Lt(!1,r,n.providerId),await sr(s,r.auth);const o=await vr(r);return s._openRedirect(r.auth,n,"linkViaRedirect",o)}async function fr(e,t){return await Le(e)._initializationPromise,gr(e,t,!1)}async function gr(e,t,n=!1){const i=Le(e),r=Gi(i,t),s=new ir(i,r,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,t)),o}async function vr(e){const t=Kn(`${e.uid}:::`);return e._redirectEventId=t,await e.auth._setRedirectUser(e),await e.auth._persistUserIfCurrent(e),t}const Ir=6e5;class _r{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!wr(e)?t:(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0),t)}sendToConsumer(e,t){var n;if(e.error&&!Tr(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(_(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Ir&&this.cachedEventUids.clear(),this.cachedEventUids.has(yr(e))}saveEventToCache(e){this.cachedEventUids.add(yr(e)),this.lastProcessedEventTime=Date.now()}}function yr(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function Tr({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}function wr(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Tr(e);default:return!1}}async function Er(e,t={}){return j(e,"GET","/v1/projects",t)}exports.az=_r;const kr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ar=/^https?/;async function Nr(e){if(e.config.emulator)return;const{authorizedDomains:t}=await Er(e);for(const i of t)try{if(Rr(i))return}catch(n){}I(e,"unauthorized-domain")}function Rr(e){const t=O(),{protocol:n,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const r=new URL(e);return""===r.hostname&&""===i?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!Ar.test(n))return!1;if(kr.test(e))return i===e;const r=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const Sr=new M(3e4,6e4);function br(){const e=Bn().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function Or(e){return new Promise((t,n)=>{var i,r,s;function o(){br(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{br(),n(_(e,"network-request-failed"))},timeout:Sr.get()})}if(null===(r=null===(i=Bn().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)t(gapi.iframes.getContext());else{if(null===(s=Bn().gapi)||void 0===s||!s.load){const t=yi("iframefcb");return Bn()[t]=(()=>{gapi.load?o():n(_(e,"network-request-failed"))}),_i(`https://apis.google.com/js/api.js?onload=${t}`)}o()}}).catch(e=>{throw Pr=null,e})}let Pr=null;function Dr(e){return Pr=Pr||Or(e)}const Cr=new M(5e3,15e3),Lr="__/auth/iframe",Mr="emulator/auth/iframe",xr={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Ur=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Fr(n){const i=n.config;E(i.authDomain,n,"auth-domain-config-required");const r=i.emulator?x(i,Mr):`https://${n.config.authDomain}/${Lr}`,s={apiKey:i.apiKey,appName:n.name,v:t.SDK_VERSION},o=Ur.get(n.config.apiHost);o&&(s.eid=o);const a=n._getFrameworks();return a.length&&(s.fw=a.join(",")),`${r}?${(0,e.querystring)(s).slice(1)}`}async function Vr(e){const t=await Dr(e),n=Bn().gapi;return E(n,e,"internal-error"),t.open({where:document.body,url:Fr(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:xr,dontclear:!0},t=>new Promise(async(n,i)=>{await t.restyle({setHideOnLeave:!1});const r=_(e,"network-request-failed"),s=Bn().setTimeout(()=>{i(r)},Cr.get());function o(){Bn().clearTimeout(s),n(t)}t.ping(o).then(o,()=>{i(r)})}))}const qr={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},jr=500,Hr=600,zr="_blank",Gr="http://localhost";class Wr{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function Kr(t,n,i,r=jr,s=Hr){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u=Object.assign(Object.assign({},qr),{width:r.toString(),height:s.toString(),top:o,left:a}),d=(0,e.getUA)().toLowerCase();i&&(c=Te(d)?zr:i),_e(d)&&(n=n||Gr,u.scrollbars="yes");const l=Object.entries(u).reduce((e,[t,n])=>`${e}${t}=${n},`,"");if(Se(d)&&"_self"!==c)return Jr(n||"",c),new Wr(null);const h=window.open(n||"",c,l);E(h,t,"popup-blocked");try{h.focus()}catch(p){}return new Wr(h)}function Jr(e,t){const n=document.createElement("a");n.href=e,n.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}exports.aH=Wr;const Br="__/auth/handler",$r="emulator/auth/handler";function Yr(n,i,r,s,o,a){E(n.config.authDomain,n,"auth-domain-config-required"),E(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:r,redirectUrl:s,v:t.SDK_VERSION,eventId:o};if(i instanceof mt){i.setDefaultLanguage(n.languageCode),c.providerId=i.providerId||"",(0,e.isEmpty)(i.getCustomParameters())||(c.customParameters=JSON.stringify(i.getCustomParameters()));for(const[e,t]of Object.entries(a||{}))c[e]=t}if(i instanceof ft){const e=i.getScopes().filter(e=>""!==e);e.length>0&&(c.scopes=e.join(","))}n.tenantId&&(c.tid=n.tenantId);const u=c;for(const e of Object.keys(u))void 0===u[e]&&delete u[e];return`${Xr(n)}?${(0,e.querystring)(u).slice(1)}`}function Xr({config:e}){return e.emulator?x(e,$r):`https://${e.authDomain}/${Br}`}const Qr="webStorageSupport";class Zr{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=zn,this._completeRedirectFn=gr}async _openPopup(e,t,n,i){var r;return A(null===(r=this.eventManagers[e._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()"),Kr(e,Yr(e,t,n,O(),i),Kn())}async _openRedirect(e,t,n,i){return await this._originValidation(e),$n(Yr(e,t,n,O(),i)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(A(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n}async initAndGetManager(e){const t=await Vr(e),n=new _r(e);return t.register("authEvent",t=>{return E(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Qr,{type:Qr},n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i[Qr];void 0!==r&&t(!!r),I(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Nr(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Oe()||ye()||Ne()}}const es=Zr;exports.k=es;class ts{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return k("unexpected MultiFactorSessionType")}}}class ns extends ts{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new ns(e)}_finalizeEnroll(e,t,n){return On(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return gi(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class is{constructor(){}static assertion(e){return ns._fromCredential(e)}}exports.m=is,is.FACTOR_ID="phone";var rs="@firebase/auth",ss="0.19.3";class os{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){E(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function as(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function cs(e){(0,t._registerComponent)(new r.Component("auth",(t,{options:n})=>{const i=t.getProvider("app").getImmediate(),{apiKey:r,authDomain:s}=i.options;return(t=>{E(r&&!r.includes(":"),"invalid-api-key",{appName:t.name}),E(!(null==s?void 0:s.includes(":")),"argument-error",{appName:t.name});const i={apiKey:r,authDomain:s,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:De(e)},o=new Ce(t,i);return b(o,n),o})(i)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),(0,t._registerComponent)(new r.Component("auth-internal",e=>{return(e=>new os(e))(Le(e.getProvider("auth").getImmediate()))},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,t.registerVersion)(rs,ss,as(e)),(0,t.registerVersion)(rs,ss,"esm2017")}function us(e=(0,t.getApp)()){const n=(0,t._getProvider)(e,"auth");return n.isInitialized()?n.getImmediate():S(e,{popupRedirectResolver:es,persistence:[mi,jn,zn]})}cs("Browser");
},{"@firebase/util":"chA2","@firebase/app":"h2Mb","tslib":"vCxL","@firebase/logger":"JJem","@firebase/component":"vhY9"}],"QWyA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"ActionCodeOperation",{enumerable:!0,get:function(){return e.A}}),Object.defineProperty(exports,"ActionCodeURL",{enumerable:!0,get:function(){return e.ac}}),Object.defineProperty(exports,"AuthCredential",{enumerable:!0,get:function(){return e.G}}),Object.defineProperty(exports,"AuthErrorCodes",{enumerable:!0,get:function(){return e.C}}),Object.defineProperty(exports,"EmailAuthCredential",{enumerable:!0,get:function(){return e.H}}),Object.defineProperty(exports,"EmailAuthProvider",{enumerable:!0,get:function(){return e.L}}),Object.defineProperty(exports,"FacebookAuthProvider",{enumerable:!0,get:function(){return e.M}}),Object.defineProperty(exports,"FactorId",{enumerable:!0,get:function(){return e.F}}),Object.defineProperty(exports,"GithubAuthProvider",{enumerable:!0,get:function(){return e.Q}}),Object.defineProperty(exports,"GoogleAuthProvider",{enumerable:!0,get:function(){return e.N}}),Object.defineProperty(exports,"OAuthCredential",{enumerable:!0,get:function(){return e.I}}),Object.defineProperty(exports,"OAuthProvider",{enumerable:!0,get:function(){return e.T}}),Object.defineProperty(exports,"OperationType",{enumerable:!0,get:function(){return e.O}}),Object.defineProperty(exports,"PhoneAuthCredential",{enumerable:!0,get:function(){return e.J}}),Object.defineProperty(exports,"PhoneAuthProvider",{enumerable:!0,get:function(){return e.P}}),Object.defineProperty(exports,"PhoneMultiFactorGenerator",{enumerable:!0,get:function(){return e.m}}),Object.defineProperty(exports,"ProviderId",{enumerable:!0,get:function(){return e.o}}),Object.defineProperty(exports,"RecaptchaVerifier",{enumerable:!0,get:function(){return e.R}}),Object.defineProperty(exports,"SAMLAuthProvider",{enumerable:!0,get:function(){return e.U}}),Object.defineProperty(exports,"SignInMethod",{enumerable:!0,get:function(){return e.S}}),Object.defineProperty(exports,"TwitterAuthProvider",{enumerable:!0,get:function(){return e.V}}),Object.defineProperty(exports,"applyActionCode",{enumerable:!0,get:function(){return e.a1}}),Object.defineProperty(exports,"browserLocalPersistence",{enumerable:!0,get:function(){return e.b}}),Object.defineProperty(exports,"browserPopupRedirectResolver",{enumerable:!0,get:function(){return e.k}}),Object.defineProperty(exports,"browserSessionPersistence",{enumerable:!0,get:function(){return e.a}}),Object.defineProperty(exports,"checkActionCode",{enumerable:!0,get:function(){return e.a2}}),Object.defineProperty(exports,"confirmPasswordReset",{enumerable:!0,get:function(){return e.a0}}),Object.defineProperty(exports,"connectAuthEmulator",{enumerable:!0,get:function(){return e.E}}),Object.defineProperty(exports,"createUserWithEmailAndPassword",{enumerable:!0,get:function(){return e.a4}}),Object.defineProperty(exports,"debugErrorMap",{enumerable:!0,get:function(){return e.z}}),Object.defineProperty(exports,"deleteUser",{enumerable:!0,get:function(){return e.y}}),Object.defineProperty(exports,"fetchSignInMethodsForEmail",{enumerable:!0,get:function(){return e.a9}}),Object.defineProperty(exports,"getAdditionalUserInfo",{enumerable:!0,get:function(){return e.ak}}),Object.defineProperty(exports,"getAuth",{enumerable:!0,get:function(){return e.n}}),Object.defineProperty(exports,"getIdToken",{enumerable:!0,get:function(){return e.ah}}),Object.defineProperty(exports,"getIdTokenResult",{enumerable:!0,get:function(){return e.ai}}),Object.defineProperty(exports,"getMultiFactorResolver",{enumerable:!0,get:function(){return e.am}}),Object.defineProperty(exports,"getRedirectResult",{enumerable:!0,get:function(){return e.j}}),Object.defineProperty(exports,"inMemoryPersistence",{enumerable:!0,get:function(){return e.K}}),Object.defineProperty(exports,"indexedDBLocalPersistence",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(exports,"initializeAuth",{enumerable:!0,get:function(){return e.D}}),Object.defineProperty(exports,"isSignInWithEmailLink",{enumerable:!0,get:function(){return e.a7}}),Object.defineProperty(exports,"linkWithCredential",{enumerable:!0,get:function(){return e.Y}}),Object.defineProperty(exports,"linkWithPhoneNumber",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(exports,"linkWithPopup",{enumerable:!0,get:function(){return e.d}}),Object.defineProperty(exports,"linkWithRedirect",{enumerable:!0,get:function(){return e.g}}),Object.defineProperty(exports,"multiFactor",{enumerable:!0,get:function(){return e.an}}),Object.defineProperty(exports,"onAuthStateChanged",{enumerable:!0,get:function(){return e.t}}),Object.defineProperty(exports,"onIdTokenChanged",{enumerable:!0,get:function(){return e.q}}),Object.defineProperty(exports,"parseActionCodeURL",{enumerable:!0,get:function(){return e.ad}}),Object.defineProperty(exports,"prodErrorMap",{enumerable:!0,get:function(){return e.B}}),Object.defineProperty(exports,"reauthenticateWithCredential",{enumerable:!0,get:function(){return e.Z}}),Object.defineProperty(exports,"reauthenticateWithPhoneNumber",{enumerable:!0,get:function(){return e.r}}),Object.defineProperty(exports,"reauthenticateWithPopup",{enumerable:!0,get:function(){return e.e}}),Object.defineProperty(exports,"reauthenticateWithRedirect",{enumerable:!0,get:function(){return e.h}}),Object.defineProperty(exports,"reload",{enumerable:!0,get:function(){return e.al}}),Object.defineProperty(exports,"sendEmailVerification",{enumerable:!0,get:function(){return e.aa}}),Object.defineProperty(exports,"sendPasswordResetEmail",{enumerable:!0,get:function(){return e.$}}),Object.defineProperty(exports,"sendSignInLinkToEmail",{enumerable:!0,get:function(){return e.a6}}),Object.defineProperty(exports,"setPersistence",{enumerable:!0,get:function(){return e.p}}),Object.defineProperty(exports,"signInAnonymously",{enumerable:!0,get:function(){return e.W}}),Object.defineProperty(exports,"signInWithCredential",{enumerable:!0,get:function(){return e.X}}),Object.defineProperty(exports,"signInWithCustomToken",{enumerable:!0,get:function(){return e._}}),Object.defineProperty(exports,"signInWithEmailAndPassword",{enumerable:!0,get:function(){return e.a5}}),Object.defineProperty(exports,"signInWithEmailLink",{enumerable:!0,get:function(){return e.a8}}),Object.defineProperty(exports,"signInWithPhoneNumber",{enumerable:!0,get:function(){return e.s}}),Object.defineProperty(exports,"signInWithPopup",{enumerable:!0,get:function(){return e.c}}),Object.defineProperty(exports,"signInWithRedirect",{enumerable:!0,get:function(){return e.f}}),Object.defineProperty(exports,"signOut",{enumerable:!0,get:function(){return e.x}}),Object.defineProperty(exports,"unlink",{enumerable:!0,get:function(){return e.aj}}),Object.defineProperty(exports,"updateCurrentUser",{enumerable:!0,get:function(){return e.w}}),Object.defineProperty(exports,"updateEmail",{enumerable:!0,get:function(){return e.af}}),Object.defineProperty(exports,"updatePassword",{enumerable:!0,get:function(){return e.ag}}),Object.defineProperty(exports,"updatePhoneNumber",{enumerable:!0,get:function(){return e.u}}),Object.defineProperty(exports,"updateProfile",{enumerable:!0,get:function(){return e.ae}}),Object.defineProperty(exports,"useDeviceLanguage",{enumerable:!0,get:function(){return e.v}}),Object.defineProperty(exports,"verifyBeforeUpdateEmail",{enumerable:!0,get:function(){return e.ab}}),Object.defineProperty(exports,"verifyPasswordResetCode",{enumerable:!0,get:function(){return e.a3}});var e=require("./index-8593558d.js");require("@firebase/util"),require("@firebase/app"),require("tslib"),require("@firebase/logger"),require("@firebase/component");
},{"./index-8593558d.js":"I8v3","@firebase/util":"chA2","@firebase/app":"h2Mb","tslib":"vCxL","@firebase/logger":"JJem","@firebase/component":"vhY9"}],"zKjx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@firebase/auth");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});
},{"@firebase/auth":"QWyA"}],"CAsa":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getDb=n,exports.init=o,exports.login=s,exports.writeNewData=p;var e=require("firebase/app"),t=require("firebase/database"),a=require("firebase/auth");const r={apiKey:"AIzaSyCGJzBOsXG8poQB0hOgZgBuDv87LmyxPwk",authDomain:"project-filmoteka.firebaseapp.com",projectId:"project-filmoteka",storageBucket:"project-filmoteka.appspot.com",messagingSenderId:"752565238788",appId:"1:752565238788:web:5f9744ba69c8ecc4964951",measurementId:"G-VENZM40NT5",databaseURL:"https://project-filmoteka.firebaseio.com"};async function o(){return await(0,e.initializeApp)(r,"filmoteka")}async function n(e){return(0,t.getDatabase)(e,"https://project-filmoteka-default-rtdb.europe-west1.firebasedatabase.app/")}async function s(e,t,r,o,n){let s;t||(t="test"),o||(o="test@gmail.com"),r||(r="test123");let p=await(0,a.getAuth)(e);return console.log("auth.currentUser",p.currentUser),console.log("auth.AdditionalUserInfo",p.AdditionalUserInfo),n?(s=await i(p,o,r),(0,a.updateProfile)(p.currentUser,{displayName:t}).catch(e=>{console.log(e)})):s=await c(p,o,r),(0,a.onAuthStateChanged)(p,e=>{console.log("userData",e),e?l(e):u(e)}),s}async function i(e,t,r){let o=await(0,a.createUserWithEmailAndPassword)(e,t,r).then(l).catch(u);return o||(o={}),o}async function c(e,t,r){let o=await(0,a.signInWithEmailAndPassword)(e,t,r).then(l).catch(u);return o||(o={}),o}function u(e){const t=e.code,a=e.message;console.log(`errorCode = ${t}\nerrorMessage = ${a}`)}function l(e){return console.log("userCredential.email",e.email),e}async function p(e,a,r){const o={};return o[a]=r,await(0,t.update)((0,t.ref)(e),o)}
},{"firebase/app":"OJEJ","firebase/database":"Uuoh","firebase/auth":"zKjx"}],"OsqH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;const e={bodyRefs:document.body,headerRefs:document.querySelector("header"),navHomeRefs:document.querySelector(".js-home"),navLibrRefs:document.querySelector(".js-lib"),btnHomeRefs:document.querySelector("#btn-home"),btnLibrRefs:document.querySelector("#btn-library"),btnLogin:document.querySelector("#btn-login"),logoRefs:document.querySelector(".logo"),toggleThemeRefs:document.querySelector(".theme-switch__toggle"),headerWatchedBtnRefs:document.querySelector("#btn-watched"),headerQueueBtnRefs:document.querySelector("#btn-queue"),ukrLangSvgRefs:document.querySelector("#ukr"),engLangSvgRefs:document.querySelector("#eng"),langlabelRefs:document.querySelector(".languages__label"),btnLangRefs:document.querySelector("#btn-lang"),formSearchRefs:document.querySelector(".header-form"),inputSearchRefs:document.querySelector(".header-form__input"),librListRefs:document.querySelector(".library__list"),btnSearchRefs:document.querySelectorAll(".header-form__button"),backdropRefs:document.querySelector(".backdrop"),modalFilmContainerRefs:document.querySelector(".movie-container-film"),closeBtnModalRefs:document.querySelector('[data-action="close-btn-modal"]'),modalWindowRefs:document.querySelector(".modal-film"),galleryListRefs:document.querySelector(".gallery-film-list"),watchedBtnRefs:document.querySelector(".btn-watched"),queueBtnRefs:document.querySelector(".btn-queue"),openModalBtnRefs:document.querySelector("[data-modal-open]"),modalRefs:document.querySelector("[data-modal]"),modalTrailerWindowRefs:document.querySelector(".modal-trailer"),modalTrailerContainerRefs:document.querySelector(".modal-trailer-container"),modalsWrapperRefs:document.querySelector(".modals"),openModalAuthRefs:document.querySelector("[data-auth-modal-open]"),modalAuthRefs:document.querySelector("[data-auth-modal]"),confirmCheckboxRefs:document.querySelector(".auth__confirm-checkbox"),authFormRefs:document.querySelector(".auth__form"),authTitleRefs:document.querySelector(".auth__title"),authSignUpBtnRefs:document.querySelector("#registration"),authCancelBtnRefs:document.querySelector(".button-submit-close"),authNameGroupRefs:document.querySelector("#auth-input-group-name"),authNameRefs:document.querySelector("#user-name"),authNameTextRefs:document.querySelector("#name-text"),authEmailRefs:document.querySelector("#user-email"),authEmailTextRefs:document.querySelector("#email-text"),authPasswordRefs:document.querySelector("#user-password"),authPasswordTextRefs:document.querySelector("#password-text"),authCheckboxText:document.querySelector(".auth__confirm-conditions"),paginationRefs:document.querySelector(".pagination"),WATCHED:"watched",QUEUE:"queue",wrapperRefs:document.querySelector(".pagination__wrapper-js"),arrowLeftRefs:document.querySelector(".arrow-left-js"),arrowRightRefs:document.querySelector(".arrow-right-js"),listernerEventRefs:document.querySelector(".pagination__wrapper-js"),emptyWatchedQueueRefs:document.querySelector(".watched-queue"),errorPictureRefs:document.querySelector(".error"),emptySearchRefs:document.querySelector(".empty-search"),watchedQueueTextRefs:document.querySelector(".watched-queue-text"),emptySearchTextRefs:document.querySelector(".empty-search-text"),errorTextRefs:document.querySelector(".error-text")};var t={refs:e};exports.default=t;
},{}],"H3RA":[function(require,module,exports) {
"use strict";var e=t(require("./common/refs"));function t(e){return e&&e.__esModule?e:{default:e}}const{backdropRefs:n,openModalBtnRefs:o,modalRefs:s}=e.default.refs;o.addEventListener("click",l);const c=s.querySelector(".close__button");function i(){"dark-theme"===localStorage.getItem("theme")?r("inherit","rgb(5, 5, 5)","rgb(255, 255, 255)"):r("rgb(0, 0, 0)","","")}function l(){d(),a(),i()}function a(){s.classList.toggle("visually-hidden"),s.classList.toggle("is-open"),c.classList.add("team-btn-close"),n.classList.remove("visually-hidden"),document.body.classList.toggle("modal-open")}function d(){n.addEventListener("click",u),window.addEventListener("keydown",v),c.addEventListener("click",u)}function r(e,t,n){c.style.fill=e,s.style.backgroundColor=t,s.style.color=n}function u(e){let t=e.target.classList;(t.contains("backdrop")||t.contains("close-button__icon")||t.contains("close__button")||t.contains("use-close-button"))&&f()}function f(){s.classList.toggle("visually-hidden"),s.classList.toggle("is-open"),n.classList.add("visually-hidden"),document.body.classList.remove("modal-open"),g()}function g(){window.removeEventListener("keydown",v),c.removeEventListener("click",u),n.removeEventListener("click",u)}function v(e){"Escape"===e.code&&f()}
},{"./common/refs":"OsqH"}],"TAGd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.del=a,exports.get=s,exports.getLanguage=l,exports.getUser=f,exports.move=g,exports.put=c,exports.setLanguage=r;var e=require("../api-service.js"),o=require("../common/api-firebase");function t(){console.log("getData");let e=localStorage.getItem("themoviedb");if(!e)return{};try{return JSON.parse(e)}catch(o){return console.log(`Something happened: ${o}`),{}}}function n(e,o){return console.log("checkUser",e,o),e||(e={[o]:{}}),e[o]||(e[o]={}),e}function l(){console.log("getLanguage");let e=localStorage.getItem("language");return e||"en-US"}function r(e){console.log("setLanguage",e),localStorage.setItem("language",String(e))}function a(e,o,n){if(console.log("del",e,o,n),!e||!o||!n)return!0;let r=l(),a=t();return!(a&&a[e]&&a[e][r]&&a[e][r][o])||(a[e]["uk-UA"][o]=a[e]["uk-UA"][o].filter(e=>e.id!=n.id),a[e]["en-US"][o]=a[e]["en-US"][o].filter(e=>e.id!=n.id),u(a))}function g(e,o,t,n){console.log("move",e,o,t,n);let l=a(e,o,n);return l&&(l=c(e,t,n)),l}function s(e){console.log("get",e);let o=t();if(!o)return[];if(!e)return o;let n=l();return o[e]&&o[e][n]?o[e][n]:[]}async function c(r,a,g){if(console.log("put",r,a,g),!r)return!1;let c=t(),i=l();console.log("dataSL",c),console.log("lang",i),console.log("user",r),(c=n(c,r))[r][i]||(c[r][i]={}),c[r][i]=p(c[r][i],a,g);let f="uk-UA"===i?"en-US":"uk-UA",d=await(0,e.fetchMovieByLang)(g.id,f);if(c[r][f]||(c[r][f]={}),console.log("movie",d),c[r][f]=p(c[r][f],a,d),"local"!=r){let e=await(0,o.getDb)(app);console.log("db",e);let t=s(),n=r.split("@")[0];await(0,o.writeNewData)(e,n,t)}return u(c)}function i(e,o){console.log("addData",e,o);let t=-1;for(const n of e)n.id===o.id&&(t=1);-1===t&&e.push(o)}function u(e){console.log("saveData",e);try{let t=JSON.stringify(e);return localStorage.setItem("themoviedb",t),!0}catch(o){return console.log(`Something happened: ${o}`),!1}}function f(){console.log("getUser");let e=localStorage.getItem("loginUser");return e||(e="local",localStorage.setItem("loginUser",e)),e}function p(e,o,t){if(console.log("setKey",e,o,t),e[o]&&Array.isArray(e[o])||(e[o]=[]),Array.isArray(t))for(const n of t)i(e[o],n);else i(e[o],t);return e}console.log(e.fetchMovieByLang);
},{"../api-service.js":"hC31","../common/api-firebase":"CAsa"}],"hC31":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.fetchMovieByLang=c;var e=require("./common/api-data.js");const a="https://api.themoviedb.org/3",t="7cb7f2a84f35ebc2678afebafcd2cb5f";function n(n,o){const c=(0,e.getLanguage)();return fetch(`${a}/search/movie?api_key=${t}&query=${n}&language=${c}&page=${o}&include_adult=false`).then(e=>e.json())}function o(n){const o=(0,e.getLanguage)();return fetch(`${a}/movie/${n}?api_key=${t}&language=${o}`).then(e=>e.json())}function c(e,n){return fetch(`${a}/movie/${e}?api_key=${t}&language=${n}`).then(e=>e.json())}function i(n){const o=(0,e.getLanguage)();return fetch(`${a}/movie/${n}/videos?api_key=${t}&language=${o}`).then(e=>e.json())}function u(n){const o=(0,e.getLanguage)();return fetch(`${a}/trending/movie/day?api_key=${t}&page=${n}&language=${o}`).then(e=>e.json())}function r(){const n=(0,e.getLanguage)();return fetch(`${a}/genre/movie/list?api_key=${t}&language=${n}`).then(e=>e.json())}const g={user:"mamay.ukr",password:"mamay.ukr",email:"mamay.ukr.1977@gmail.com",keyV3Auth:"7cb7f2a84f35ebc2678afebafcd2cb5f",keyV4Auth:"eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiI3Y2I3ZjJhODRmMzVlYmMyNjc4YWZlYmFmY2QyY2I1ZiIsInN1YiI6IjYxODZlMGM1YzVjMWVmMDAyYzI3NWE1OCIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.Pgpe2ZFsuuwD752NaRWkXNGvN6Y_7zSj-ucISFoCXyM"};var s={fetchMovies:n,fetchMovie:o,fetchPopularFilms:u,fetchGenres:r,fetchTrailer:i,themoviedb:g};exports.default=s;
},{"./common/api-data.js":"TAGd"}],"pAws":[function(require,module,exports) {
var define;
var global = arguments[3];
var e,t=arguments[3];!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof e&&e.amd?e([],r):"object"==typeof exports?exports.Handlebars=r():t.Handlebars=r()}(this,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}return r.m=e,r.c=t,r.p="",r(0)}([function(e,t,r){"use strict";var n=r(1).default,o=r(2).default;t.__esModule=!0;var a=n(r(3)),i=o(r(36)),u=o(r(5)),l=n(r(4)),s=n(r(37)),c=o(r(43));function f(){var e=new a.HandlebarsEnvironment;return l.extend(e,a),e.SafeString=i.default,e.Exception=u.default,e.Utils=l,e.escapeExpression=l.escapeExpression,e.VM=s,e.template=function(t){return s.template(t,e)},e}var p=f();p.create=f,c.default(p),p.default=p,t.default=p,e.exports=t.default},function(e,t){"use strict";t.default=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},t.__esModule=!0},function(e,t){"use strict";t.default=function(e){return e&&e.__esModule?e:{default:e}},t.__esModule=!0},function(e,t,r){"use strict";var n=r(2).default;t.__esModule=!0,t.HandlebarsEnvironment=c;var o=r(4),a=n(r(5)),i=r(9),u=r(29),l=n(r(31)),s=r(32);t.VERSION="4.7.7";t.COMPILER_REVISION=8;t.LAST_COMPATIBLE_COMPILER_REVISION=7;t.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0 <4.3.0",8:">= 4.3.0"};function c(e,t,r){this.helpers=e||{},this.partials=t||{},this.decorators=r||{},i.registerDefaultHelpers(this),u.registerDefaultDecorators(this)}c.prototype={constructor:c,logger:l.default,log:l.default.log,registerHelper:function(e,t){if("[object Object]"===o.toString.call(e)){if(t)throw new a.default("Arg not supported with multiple helpers");o.extend(this.helpers,e)}else this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,t){if("[object Object]"===o.toString.call(e))o.extend(this.partials,e);else{if(void 0===t)throw new a.default('Attempting to register a partial called "'+e+'" as undefined');this.partials[e]=t}},unregisterPartial:function(e){delete this.partials[e]},registerDecorator:function(e,t){if("[object Object]"===o.toString.call(e)){if(t)throw new a.default("Arg not supported with multiple decorators");o.extend(this.decorators,e)}else this.decorators[e]=t},unregisterDecorator:function(e){delete this.decorators[e]},resetLoggedPropertyAccesses:function(){s.resetLoggedProperties()}};var f=l.default.log;t.log=f,t.createFrame=o.createFrame,t.logger=l.default},function(e,t){"use strict";t.__esModule=!0,t.extend=i,t.indexOf=function(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1},t.escapeExpression=function(e){if("string"!=typeof e){if(e&&e.toHTML)return e.toHTML();if(null==e)return"";if(!e)return e+"";e=""+e}if(!o.test(e))return e;return e.replace(n,a)},t.isEmpty=function(e){return!e&&0!==e||!(!s(e)||0!==e.length)},t.createFrame=function(e){var t=i({},e);return t._parent=e,t},t.blockParams=function(e,t){return e.path=t,e},t.appendContextPath=function(e,t){return(e?e+".":"")+t};var r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},n=/[&<>"'`=]/g,o=/[&<>"'`=]/;function a(e){return r[e]}function i(e){for(var t=1;t<arguments.length;t++)for(var r in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],r)&&(e[r]=arguments[t][r]);return e}var u=Object.prototype.toString;t.toString=u;var l=function(e){return"function"==typeof e};l(/x/)&&(t.isFunction=l=function(e){return"function"==typeof e&&"[object Function]"===u.call(e)}),t.isFunction=l;var s=Array.isArray||function(e){return!(!e||"object"!=typeof e)&&"[object Array]"===u.call(e)};t.isArray=s},function(e,t,r){"use strict";var n=r(6).default;t.__esModule=!0;var o=["description","fileName","lineNumber","endLineNumber","message","name","number","stack"];function a(e,t){var r=t&&t.loc,i=void 0,u=void 0,l=void 0,s=void 0;r&&(i=r.start.line,u=r.end.line,l=r.start.column,s=r.end.column,e+=" - "+i+":"+l);for(var c=Error.prototype.constructor.call(this,e),f=0;f<o.length;f++)this[o[f]]=c[o[f]];Error.captureStackTrace&&Error.captureStackTrace(this,a);try{r&&(this.lineNumber=i,this.endLineNumber=u,n?(Object.defineProperty(this,"column",{value:l,enumerable:!0}),Object.defineProperty(this,"endColumn",{value:s,enumerable:!0})):(this.column=l,this.endColumn=s))}catch(p){}}a.prototype=new Error,t.default=a,e.exports=t.default},function(e,t,r){e.exports={default:r(7),__esModule:!0}},function(e,t,r){var n=r(8);e.exports=function(e,t,r){return n.setDesc(e,t,r)}},function(e,t){var r=Object;e.exports={create:r.create,getProto:r.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:r.getOwnPropertyDescriptor,setDesc:r.defineProperty,setDescs:r.defineProperties,getKeys:r.keys,getNames:r.getOwnPropertyNames,getSymbols:r.getOwnPropertySymbols,each:[].forEach}},function(e,t,r){"use strict";var n=r(2).default;t.__esModule=!0,t.registerDefaultHelpers=function(e){o.default(e),a.default(e),i.default(e),u.default(e),l.default(e),s.default(e),c.default(e)},t.moveHelperToHooks=function(e,t,r){e.helpers[t]&&(e.hooks[t]=e.helpers[t],r||delete e.helpers[t])};var o=n(r(10)),a=n(r(11)),i=n(r(24)),u=n(r(25)),l=n(r(26)),s=n(r(27)),c=n(r(28))},function(e,t,r){"use strict";t.__esModule=!0;var n=r(4);t.default=function(e){e.registerHelper("blockHelperMissing",function(t,r){var o=r.inverse,a=r.fn;if(!0===t)return a(this);if(!1===t||null==t)return o(this);if(n.isArray(t))return t.length>0?(r.ids&&(r.ids=[r.name]),e.helpers.each(t,r)):o(this);if(r.data&&r.ids){var i=n.createFrame(r.data);i.contextPath=n.appendContextPath(r.data.contextPath,r.name),r={data:i}}return a(t,r)})},e.exports=t.default},function(e,t,r){(function(n){"use strict";var o=r(12).default,a=r(2).default;t.__esModule=!0;var i=r(4),u=a(r(5));t.default=function(e){e.registerHelper("each",function(e,t){if(!t)throw new u.default("Must pass iterator to #each");var r,a=t.fn,l=t.inverse,s=0,c="",f=void 0,p=void 0;function d(t,r,n){f&&(f.key=t,f.index=r,f.first=0===r,f.last=!!n,p&&(f.contextPath=p+t)),c+=a(e[t],{data:f,blockParams:i.blockParams([e[t],t],[p+t,null])})}if(t.data&&t.ids&&(p=i.appendContextPath(t.data.contextPath,t.ids[0])+"."),i.isFunction(e)&&(e=e.call(this)),t.data&&(f=i.createFrame(t.data)),e&&"object"==typeof e)if(i.isArray(e))for(var h=e.length;s<h;s++)s in e&&d(s,s,s===e.length-1);else if(n.Symbol&&e[n.Symbol.iterator]){for(var v=[],m=e[n.Symbol.iterator](),g=m.next();!g.done;g=m.next())v.push(g.value);for(h=(e=v).length;s<h;s++)d(s,s,s===e.length-1)}else r=void 0,o(e).forEach(function(e){void 0!==r&&d(r,s-1),r=e,s++}),void 0!==r&&d(r,s-1,!0);return 0===s&&(c=l(this)),c})},e.exports=t.default}).call(t,function(){return this}())},function(e,t,r){e.exports={default:r(13),__esModule:!0}},function(e,t,r){r(14),e.exports=r(20).Object.keys},function(e,t,r){var n=r(15);r(17)("keys",function(e){return function(t){return e(n(t))}})},function(e,t,r){var n=r(16);e.exports=function(e){return Object(n(e))}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,r){var n=r(18),o=r(20),a=r(23);e.exports=function(e,t){var r=(o.Object||{})[e]||Object[e],i={};i[e]=t(r),n(n.S+n.F*a(function(){r(1)}),"Object",i)}},function(e,t,r){var n=r(19),o=r(20),a=r(21),i=function(e,t,r){var u,l,s,c=e&i.F,f=e&i.G,p=e&i.S,d=e&i.P,h=e&i.B,v=e&i.W,m=f?o:o[t]||(o[t]={}),g=f?n:p?n[t]:(n[t]||{}).prototype;for(u in f&&(r=t),r)(l=!c&&g&&u in g)&&u in m||(s=l?g[u]:r[u],m[u]=f&&"function"!=typeof g[u]?r[u]:h&&l?a(s,n):v&&g[u]==s?function(e){var t=function(t){return this instanceof e?new e(t):e(t)};return t.prototype=e.prototype,t}(s):d&&"function"==typeof s?a(Function.call,s):s,d&&((m.prototype||(m.prototype={}))[u]=s))};i.F=1,i.G=2,i.S=4,i.P=8,i.B=16,i.W=32,e.exports=i},function(e,t){var r=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(e,t){var r=e.exports={version:"1.2.6"};"number"==typeof __e&&(__e=r)},function(e,t,r){var n=r(22);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},function(e,t,r){"use strict";var n=r(2).default;t.__esModule=!0;var o=n(r(5));t.default=function(e){e.registerHelper("helperMissing",function(){if(1!==arguments.length)throw new o.default('Missing helper: "'+arguments[arguments.length-1].name+'"')})},e.exports=t.default},function(e,t,r){"use strict";var n=r(2).default;t.__esModule=!0;var o=r(4),a=n(r(5));t.default=function(e){e.registerHelper("if",function(e,t){if(2!=arguments.length)throw new a.default("#if requires exactly one argument");return o.isFunction(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||o.isEmpty(e)?t.inverse(this):t.fn(this)}),e.registerHelper("unless",function(t,r){if(2!=arguments.length)throw new a.default("#unless requires exactly one argument");return e.helpers.if.call(this,t,{fn:r.inverse,inverse:r.fn,hash:r.hash})})},e.exports=t.default},function(e,t){"use strict";t.__esModule=!0,t.default=function(e){e.registerHelper("log",function(){for(var t=[void 0],r=arguments[arguments.length-1],n=0;n<arguments.length-1;n++)t.push(arguments[n]);var o=1;null!=r.hash.level?o=r.hash.level:r.data&&null!=r.data.level&&(o=r.data.level),t[0]=o,e.log.apply(e,t)})},e.exports=t.default},function(e,t){"use strict";t.__esModule=!0,t.default=function(e){e.registerHelper("lookup",function(e,t,r){return e?r.lookupProperty(e,t):e})},e.exports=t.default},function(e,t,r){"use strict";var n=r(2).default;t.__esModule=!0;var o=r(4),a=n(r(5));t.default=function(e){e.registerHelper("with",function(e,t){if(2!=arguments.length)throw new a.default("#with requires exactly one argument");o.isFunction(e)&&(e=e.call(this));var r=t.fn;if(o.isEmpty(e))return t.inverse(this);var n=t.data;return t.data&&t.ids&&((n=o.createFrame(t.data)).contextPath=o.appendContextPath(t.data.contextPath,t.ids[0])),r(e,{data:n,blockParams:o.blockParams([e],[n&&n.contextPath])})})},e.exports=t.default},function(e,t,r){"use strict";var n=r(2).default;t.__esModule=!0,t.registerDefaultDecorators=function(e){o.default(e)};var o=n(r(30))},function(e,t,r){"use strict";t.__esModule=!0;var n=r(4);t.default=function(e){e.registerDecorator("inline",function(e,t,r,o){var a=e;return t.partials||(t.partials={},a=function(o,a){var i=r.partials;r.partials=n.extend({},i,t.partials);var u=e(o,a);return r.partials=i,u}),t.partials[o.args[0]]=o.fn,a})},e.exports=t.default},function(e,t,r){"use strict";t.__esModule=!0;var n=r(4),o={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(e){if("string"==typeof e){var t=n.indexOf(o.methodMap,e.toLowerCase());e=t>=0?t:parseInt(e,10)}return e},log:function(e){if(e=o.lookupLevel(e),"undefined"!=typeof console&&o.lookupLevel(o.level)<=e){var t=o.methodMap[e];console[t]||(t="log");for(var r=arguments.length,n=Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];console[t].apply(console,n)}}};t.default=o,e.exports=t.default},function(e,t,r){"use strict";var n=r(33).default,o=r(12).default,a=r(1).default;t.__esModule=!0,t.createProtoAccessControl=function(e){var t=n(null);t.constructor=!1,t.__defineGetter__=!1,t.__defineSetter__=!1,t.__lookupGetter__=!1;var r=n(null);return r.__proto__=!1,{properties:{whitelist:i.createNewLookupObject(r,e.allowedProtoProperties),defaultValue:e.allowProtoPropertiesByDefault},methods:{whitelist:i.createNewLookupObject(t,e.allowedProtoMethods),defaultValue:e.allowProtoMethodsByDefault}}},t.resultIsAllowed=function(e,t,r){return s("function"==typeof e?t.methods:t.properties,r)},t.resetLoggedProperties=function(){o(l).forEach(function(e){delete l[e]})};var i=r(35),u=a(r(31)),l=n(null);function s(e,t){return void 0!==e.whitelist[t]?!0===e.whitelist[t]:void 0!==e.defaultValue?e.defaultValue:(function(e){!0!==l[e]&&(l[e]=!0,u.log("error",'Handlebars: Access has been denied to resolve the property "'+e+'" because it is not an "own property" of its parent.\nYou can add a runtime option to disable the check or this warning:\nSee https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details'))}(t),!1)}},function(e,t,r){e.exports={default:r(34),__esModule:!0}},function(e,t,r){var n=r(8);e.exports=function(e,t){return n.create(e,t)}},function(e,t,r){"use strict";var n=r(33).default;t.__esModule=!0,t.createNewLookupObject=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return o.extend.apply(void 0,[n(null)].concat(t))};var o=r(4)},function(e,t){"use strict";function r(e){this.string=e}t.__esModule=!0,r.prototype.toString=r.prototype.toHTML=function(){return""+this.string},t.default=r,e.exports=t.default},function(e,t,r){"use strict";var n=r(38).default,o=r(12).default,a=r(1).default,i=r(2).default;t.__esModule=!0,t.checkRevision=function(e){var t=e&&e[0]||1,r=s.COMPILER_REVISION;if(t>=s.LAST_COMPATIBLE_COMPILER_REVISION&&t<=s.COMPILER_REVISION)return;if(t<s.LAST_COMPATIBLE_COMPILER_REVISION){var n=s.REVISION_CHANGES[r],o=s.REVISION_CHANGES[t];throw new l.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+n+") or downgrade your runtime to an older version ("+o+").")}throw new l.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")},t.template=function(e,t){if(!t)throw new l.default("No environment passed to template");if(!e||!e.main)throw new l.default("Unknown template object: "+typeof e);e.main.decorator=e.main_d,t.VM.checkRevision(e.compiler);var r=e.compiler&&7===e.compiler[0];var a={strict:function(e,t,r){if(!(e&&t in e))throw new l.default('"'+t+'" not defined in '+e,{loc:r});return a.lookupProperty(e,t)},lookupProperty:function(e,t){var r=e[t];return null==r?r:Object.prototype.hasOwnProperty.call(e,t)?r:p.resultIsAllowed(r,a.protoAccessControl,t)?r:void 0},lookup:function(e,t){for(var r=e.length,n=0;n<r;n++){var o=e[n]&&a.lookupProperty(e[n],t);if(null!=o)return e[n][t]}},lambda:function(e,t){return"function"==typeof e?e.call(t):e},escapeExpression:u.escapeExpression,invokePartial:function(r,n,o){o.hash&&(n=u.extend({},n,o.hash),o.ids&&(o.ids[0]=!0));r=t.VM.resolvePartial.call(this,r,n,o);var a=u.extend({},o,{hooks:this.hooks,protoAccessControl:this.protoAccessControl}),i=t.VM.invokePartial.call(this,r,n,a);null==i&&t.compile&&(o.partials[o.name]=t.compile(r,e.compilerOptions,t),i=o.partials[o.name](n,a));if(null!=i){if(o.indent){for(var s=i.split("\n"),c=0,f=s.length;c<f&&(s[c]||c+1!==f);c++)s[c]=o.indent+s[c];i=s.join("\n")}return i}throw new l.default("The partial "+o.name+" could not be compiled when running in runtime-only mode")},fn:function(t){var r=e[t];return r.decorator=e[t+"_d"],r},programs:[],program:function(e,t,r,n,o){var a=this.programs[e],i=this.fn(e);return t||o||n||r?a=d(this,e,i,t,r,n,o):a||(a=this.programs[e]=d(this,e,i)),a},data:function(e,t){for(;e&&t--;)e=e._parent;return e},mergeIfNeeded:function(e,t){var r=e||t;return e&&t&&e!==t&&(r=u.extend({},t,e)),r},nullContext:n({}),noop:t.VM.noop,compilerInfo:e.compiler};function i(t){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=r.data;i._setup(r),!r.partial&&e.useData&&(n=function(e,t){t&&"root"in t||((t=t?s.createFrame(t):{}).root=e);return t}(t,n));var o=void 0,u=e.useBlockParams?[]:void 0;function l(t){return""+e.main(a,t,a.helpers,a.partials,n,u,o)}return e.useDepths&&(o=r.depths?t!=r.depths[0]?[t].concat(r.depths):r.depths:[t]),(l=v(e.main,l,a,r.depths||[],n,u))(t,r)}return i.isTop=!0,i._setup=function(n){if(n.partial)a.protoAccessControl=n.protoAccessControl,a.helpers=n.helpers,a.partials=n.partials,a.decorators=n.decorators,a.hooks=n.hooks;else{var i=u.extend({},t.helpers,n.helpers);!function(e,t){o(e).forEach(function(r){var n=e[r];e[r]=function(e,t){var r=t.lookupProperty;return f.wrapHelper(e,function(e){return u.extend({lookupProperty:r},e)})}(n,t)})}(i,a),a.helpers=i,e.usePartial&&(a.partials=a.mergeIfNeeded(n.partials,t.partials)),(e.usePartial||e.useDecorators)&&(a.decorators=u.extend({},t.decorators,n.decorators)),a.hooks={},a.protoAccessControl=p.createProtoAccessControl(n);var l=n.allowCallsToHelperMissing||r;c.moveHelperToHooks(a,"helperMissing",l),c.moveHelperToHooks(a,"blockHelperMissing",l)}},i._child=function(t,r,n,o){if(e.useBlockParams&&!n)throw new l.default("must pass block params");if(e.useDepths&&!o)throw new l.default("must pass parent depths");return d(a,t,e[t],r,0,n,o)},i},t.wrapProgram=d,t.resolvePartial=function(e,t,r){e?e.call||r.name||(r.name=e,e=r.partials[e]):e="@partial-block"===r.name?r.data["partial-block"]:r.partials[r.name];return e},t.invokePartial=function(e,t,r){var n=r.data&&r.data["partial-block"];r.partial=!0,r.ids&&(r.data.contextPath=r.ids[0]||r.data.contextPath);var o=void 0;r.fn&&r.fn!==h&&function(){r.data=s.createFrame(r.data);var e=r.fn;o=r.data["partial-block"]=function(t){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return r.data=s.createFrame(r.data),r.data["partial-block"]=n,e(t,r)},e.partials&&(r.partials=u.extend({},r.partials,e.partials))}();void 0===e&&o&&(e=o);if(void 0===e)throw new l.default("The partial "+r.name+" could not be found");if(e instanceof Function)return e(t,r)},t.noop=h;var u=a(r(4)),l=i(r(5)),s=r(3),c=r(9),f=r(42),p=r(32);function d(e,t,r,n,o,a,i){function u(t){var o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],u=i;return!i||t==i[0]||t===e.nullContext&&null===i[0]||(u=[t].concat(i)),r(e,t,e.helpers,e.partials,o.data||n,a&&[o.blockParams].concat(a),u)}return(u=v(r,u,e,i,n,a)).program=t,u.depth=i?i.length:0,u.blockParams=o||0,u}function h(){return""}function v(e,t,r,n,o,a){if(e.decorator){var i={};t=e.decorator(t,i,r,n&&n[0],o,a,n),u.extend(t,i)}return t}},function(e,t,r){e.exports={default:r(39),__esModule:!0}},function(e,t,r){r(40),e.exports=r(20).Object.seal},function(e,t,r){var n=r(41);r(17)("seal",function(e){return function(t){return e&&n(t)?e(t):t}})},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t){"use strict";t.__esModule=!0,t.wrapHelper=function(e,t){if("function"!=typeof e)return e;return function(){var r=arguments[arguments.length-1];return arguments[arguments.length-1]=t(r),e.apply(this,arguments)}}},function(e,t){(function(r){"use strict";t.__esModule=!0,t.default=function(e){var t=void 0!==r?r:window,n=t.Handlebars;e.noConflict=function(){return t.Handlebars===e&&(t.Handlebars=n),e}},e.exports=t.default}).call(t,function(){return this}())}])});
},{}],"q3aP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=l(require("handlebars/dist/handlebars.runtime"));function l(e){return e&&e.__esModule?e:{default:e}}const n=e.default.template({1:function(e,l,n,t,a){var o,r,i=null!=l?l:e.nullContext||{},s=e.hooks.helperMissing,u="function",c=e.escapeExpression,p=e.lookupProperty||function(e,l){if(Object.prototype.hasOwnProperty.call(e,l))return e[l]};return'<li class="gallery-film-item" id="'+c(typeof(r=null!=(r=p(n,"id")||(null!=l?p(l,"id"):l))?r:s)===u?r.call(i,{name:"id",hash:{},data:a,loc:{start:{line:2,column:34},end:{line:2,column:40}}}):r)+'">\n    <div class="video-card">\n'+(null!=(o=p(n,"if").call(i,null!=l?p(l,"poster_path"):l,{name:"if",hash:{},fn:e.program(2,a,0),inverse:e.program(4,a,0),data:a,loc:{start:{line:4,column:8},end:{line:8,column:15}}}))?o:"")+'        <div class="card__overlay">\n        </div>\n        <div class="video-about">\n            <p class="video-title">'+c(typeof(r=null!=(r=p(n,"title")||(null!=l?p(l,"title"):l))?r:s)===u?r.call(i,{name:"title",hash:{},data:a,loc:{start:{line:12,column:35},end:{line:12,column:44}}}):r)+'</p>\n            <p class="video-genre">'+c(typeof(r=null!=(r=p(n,"genre_ids")||(null!=l?p(l,"genre_ids"):l))?r:s)===u?r.call(i,{name:"genre_ids",hash:{},data:a,loc:{start:{line:13,column:35},end:{line:13,column:48}}}):r)+" | "+c(typeof(r=null!=(r=p(n,"release_date")||(null!=l?p(l,"release_date"):l))?r:s)===u?r.call(i,{name:"release_date",hash:{},data:a,loc:{start:{line:13,column:51},end:{line:13,column:67}}}):r)+"<span class='video-average visually-hidden'>"+c(typeof(r=null!=(r=p(n,"vote_average")||(null!=l?p(l,"vote_average"):l))?r:s)===u?r.call(i,{name:"vote_average",hash:{},data:a,loc:{start:{line:13,column:111},end:{line:13,column:127}}}):r)+"</span></p>\n        </div>\n    </div>\n</li>\n"},2:function(e,l,n,t,a){var o,r=null!=l?l:e.nullContext||{},i=e.hooks.helperMissing,s=e.escapeExpression,u=e.lookupProperty||function(e,l){if(Object.prototype.hasOwnProperty.call(e,l))return e[l]};return'        <img class="video-poster card__thumb" src="https://image.tmdb.org/t/p/w500'+s("function"==typeof(o=null!=(o=u(n,"poster_path")||(null!=l?u(l,"poster_path"):l))?o:i)?o.call(r,{name:"poster_path",hash:{},data:a,loc:{start:{line:5,column:82},end:{line:5,column:97}}}):o)+'" alt="'+s("function"==typeof(o=null!=(o=u(n,"title")||(null!=l?u(l,"title"):l))?o:i)?o.call(r,{name:"title",hash:{},data:a,loc:{start:{line:5,column:104},end:{line:5,column:113}}}):o)+'">\n'},4:function(e,l,n,t,a){var o,r=e.lookupProperty||function(e,l){if(Object.prototype.hasOwnProperty.call(e,l))return e[l]};return'        <img class="video-poster card__thumb" src="https://upload.wikimedia.org/wikipedia/commons/c/c2/No_image_poster.png" alt="'+e.escapeExpression("function"==typeof(o=null!=(o=r(n,"title")||(null!=l?r(l,"title"):l))?o:e.hooks.helperMissing)?o.call(null!=l?l:e.nullContext||{},{name:"title",hash:{},data:a,loc:{start:{line:7,column:129},end:{line:7,column:138}}}):o)+'">\n'},compiler:[8,">= 4.3.0"],main:function(e,l,n,t,a){var o;return null!=(o=(e.lookupProperty||function(e,l){if(Object.prototype.hasOwnProperty.call(e,l))return e[l]})(n,"each").call(null!=l?l:e.nullContext||{},l,{name:"each",hash:{},fn:e.program(1,a,0),inverse:e.noop,data:a,loc:{start:{line:1,column:0},end:{line:17,column:9}}}))?o:""},useData:!0});var t=n;exports.default=t;
},{"handlebars/dist/handlebars.runtime":"pAws"}],"HyPT":[function(require,module,exports) {
"use strict";function e(e){let t=localStorage.getItem("genres");if(!t)return;t=JSON.parse(t);let r=JSON.parse(JSON.stringify(e));return r.results=r.results.map(e=>{let r=e.genre_ids.map(e=>{return t.find(t=>t.id===e).name});return 0===r.length&&(r=["No genre"],"uk-UA"===localStorage.getItem("language")&&(r=["Нема жанру"])),r&&(r=r.join(", ").split(",")),r.length>=3&&(r=r.slice(0,2),"uk-UA"===localStorage.getItem("language")?r.push(" Інше"):r.push(" Other")),e.genre_ids=r,e}),r}function t(e){let t=JSON.parse(JSON.stringify(e));return t.results=t.results.map(e=>(e.release_date?e.release_date=e.release_date.split("-")[0]:"uk-UA"===localStorage.getItem("language")?e.release_date="Нема даних":e.release_date="No date",e)),t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.onSearchGenresList=e,exports.onSearchYear=t;
},{}],"OU2w":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.onSearch=f;var e=i(require("./api-service")),t=i(require("../partials/hbs/video-card.hbs")),s=require("./common/api-data"),r=require("./search-genres-and-year.js"),a=i(require("./common/refs"));function i(e){return e&&e.__esModule?e:{default:e}}const{galleryListRefs:n,inputSearchRefs:l,errorPictureRefs:o,emptySearchRefs:c,emptySearchTextRefs:u,errorTextRefs:d}=a.default.refs,h=(0,s.getLanguage)();async function f(t){t||(t=1),await e.default.fetchMovies(l.value.trim(),t).then(r.onSearchYear).then(r.onSearchGenresList).then(v).then(e=>{y(e),localStorage.setItem("pageType","search by keyword"),localStorage.setItem("totalPages",e.total_pages)}).catch(m)}function v(e){return 0===e.total_results&&(c.classList.add("visually-hidden"),o.classList.remove("visually-hidden"),"uk-UA"===h&&(d.textContent="Такого фільму не знайдено. Введіть правильну назву!"),n.innerHTML=""),Promise.resolve(e)}function y(e){const s=(0,t.default)(e.results);c.classList.add("visually-hidden"),n.innerHTML=s;const r=document.querySelectorAll(".video-average");for(const t of r)t.classList.remove("visually-hidden");s&&o.classList.add("visually-hidden")}function m(){o.classList.add("visually-hidden"),c.classList.remove("visually-hidden"),"uk-UA"===h&&(u.textContent="Будь-ласка введіть назву фільму!"),n.innerHTML=""}
},{"./api-service":"hC31","../partials/hbs/video-card.hbs":"q3aP","./common/api-data":"TAGd","./search-genres-and-year.js":"HyPT","./common/refs":"OsqH"}],"E2xy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=l(require("handlebars/dist/handlebars.runtime"));function l(e){return e&&e.__esModule?e:{default:e}}const n=e.default.template({1:function(e,l,n,t,a){var o,r,i=null!=l?l:e.nullContext||{},s=e.hooks.helperMissing,c="function",u=e.escapeExpression,p=e.lookupProperty||function(e,l){if(Object.prototype.hasOwnProperty.call(e,l))return e[l]};return'<li class="gallery-film-item" id="'+u(typeof(r=null!=(r=p(n,"id")||(null!=l?p(l,"id"):l))?r:s)===c?r.call(i,{name:"id",hash:{},data:a,loc:{start:{line:2,column:34},end:{line:2,column:40}}}):r)+'">\n    <div class="video-card">\n'+(null!=(o=p(n,"if").call(i,null!=l?p(l,"poster_path"):l,{name:"if",hash:{},fn:e.program(2,a,0),inverse:e.program(4,a,0),data:a,loc:{start:{line:4,column:8},end:{line:8,column:15}}}))?o:"")+'            <div class="card__overlay">\n            </div>\n    <div class="video-about">\n        <p class="video-title">'+u(typeof(r=null!=(r=p(n,"title")||(null!=l?p(l,"title"):l))?r:s)===c?r.call(i,{name:"title",hash:{},data:a,loc:{start:{line:12,column:31},end:{line:12,column:40}}}):r)+'</p>\n        <p class="video-genre">\n            '+u(typeof(r=null!=(r=p(n,"genres")||(null!=l?p(l,"genres"):l))?r:s)===c?r.call(i,{name:"genres",hash:{},data:a,loc:{start:{line:14,column:12},end:{line:14,column:22}}}):r)+" | "+u(typeof(r=null!=(r=p(n,"release_date")||(null!=l?p(l,"release_date"):l))?r:s)===c?r.call(i,{name:"release_date",hash:{},data:a,loc:{start:{line:14,column:25},end:{line:14,column:41}}}):r)+"<span class='video-average'>"+u(typeof(r=null!=(r=p(n,"vote_average")||(null!=l?p(l,"vote_average"):l))?r:s)===c?r.call(i,{name:"vote_average",hash:{},data:a,loc:{start:{line:14,column:69},end:{line:14,column:85}}}):r)+"</span></p>\n    </div>\n    </div>\n</li>\n"},2:function(e,l,n,t,a){var o,r=null!=l?l:e.nullContext||{},i=e.hooks.helperMissing,s=e.escapeExpression,c=e.lookupProperty||function(e,l){if(Object.prototype.hasOwnProperty.call(e,l))return e[l]};return'        <img class="video-poster" src="https://image.tmdb.org/t/p/w500'+s("function"==typeof(o=null!=(o=c(n,"poster_path")||(null!=l?c(l,"poster_path"):l))?o:i)?o.call(r,{name:"poster_path",hash:{},data:a,loc:{start:{line:5,column:70},end:{line:5,column:85}}}):o)+'" alt="'+s("function"==typeof(o=null!=(o=c(n,"title")||(null!=l?c(l,"title"):l))?o:i)?o.call(r,{name:"title",hash:{},data:a,loc:{start:{line:5,column:92},end:{line:5,column:101}}}):o)+'">\n'},4:function(e,l,n,t,a){var o,r=e.lookupProperty||function(e,l){if(Object.prototype.hasOwnProperty.call(e,l))return e[l]};return'        <img class="video-poster" src="https://upload.wikimedia.org/wikipedia/commons/c/c2/No_image_poster.png" alt="'+e.escapeExpression("function"==typeof(o=null!=(o=r(n,"title")||(null!=l?r(l,"title"):l))?o:e.hooks.helperMissing)?o.call(null!=l?l:e.nullContext||{},{name:"title",hash:{},data:a,loc:{start:{line:7,column:117},end:{line:7,column:126}}}):o)+'">\n'},compiler:[8,">= 4.3.0"],main:function(e,l,n,t,a){var o;return null!=(o=(e.lookupProperty||function(e,l){if(Object.prototype.hasOwnProperty.call(e,l))return e[l]})(n,"each").call(null!=l?l:e.nullContext||{},l,{name:"each",hash:{},fn:e.program(1,a,0),inverse:e.noop,data:a,loc:{start:{line:1,column:0},end:{line:18,column:9}}}))?o:""},useData:!0});var t=n;exports.default=t;
},{"handlebars/dist/handlebars.runtime":"pAws"}],"zmcZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n=e(require("handlebars/dist/handlebars.runtime"));function e(n){return n&&n.__esModule?n:{default:n}}const l=n.default.template({compiler:[8,">= 4.3.0"],main:function(n,e,l,t,a){var i,o=null!=e?e:n.nullContext||{},r=n.hooks.helperMissing,u=n.escapeExpression,s=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'\n  <li class="pagination__item item '+u("function"==typeof(i=null!=(i=s(l,"id")||(null!=e?s(e,"id"):e))?i:r)?i.call(o,{name:"id",hash:{},data:a,loc:{start:{line:2,column:35},end:{line:2,column:41}}}):i)+'">\n    <a class="pagination__link link pagination__link-js" href="#">'+u("function"==typeof(i=null!=(i=s(l,"name")||(null!=e?s(e,"name"):e))?i:r)?i.call(o,{name:"name",hash:{},data:a,loc:{start:{line:3,column:66},end:{line:3,column:74}}}):i)+"</a>\n  </li>"},useData:!0});var t=l;exports.default=t;
},{"handlebars/dist/handlebars.runtime":"pAws"}],"sETT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.onSearchPopularFilms=o;var e=s(require("./api-service")),t=s(require("../partials/hbs/video-card.hbs")),r=s(require("./common/refs")),a=require("./search-genres-and-year.js");function s(e){return e&&e.__esModule?e:{default:e}}const{galleryListRefs:n}=r.default.refs;async function o(t){t||(t=1),await e.default.fetchGenres().then(e=>e.genres).then(c),await e.default.fetchPopularFilms(t).then(a.onSearchGenresList).then(a.onSearchYear).then(e=>(localStorage.setItem("totalPages",e.total_pages),localStorage.setItem("pageType","popular"),e.results)).then(l).catch(e=>{console.log(e)})}function l(e){const r=(0,t.default)(e);n.innerHTML=r}function c(e){localStorage.setItem("genres",JSON.stringify(e))}o();
},{"./api-service":"hC31","../partials/hbs/video-card.hbs":"q3aP","./common/refs":"OsqH","./search-genres-and-year.js":"HyPT"}],"o8lo":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.onMarkupButton=k,exports.onMarkupPages=m;var e=i(require("./common/refs")),t=i(require("../partials/hbs/pagination.hbs")),n=require("./render-popular-film.js"),a=require("./search-by-keyword.js"),r=require("./watched-queue-btns");function i(e){return e&&e.__esModule?e:{default:e}}const{wrapperRefs:s,arrowLeftRefs:u,arrowRightRefs:l,listernerEventRefs:o}=e.default.refs;let c=1,d=1;const f=9,p="...";function m(e){h(e),k(e)}async function h(e){let t=v();switch(t||(t="popular"),t){case"popular":await(0,n.onSearchPopularFilms)(e);break;case"search by keyword":await(0,a.onSearch)(e);break;case"watched":await(0,r.watchedBtnClick)(e);break;case"queue":await(0,r.queueBtnClick)(e)}}function k(e){e||(e=1),x(e),M(),q(),_()}function g(){return(c=localStorage.getItem("totalPages"))?Number(c):1}function v(){let e=localStorage.getItem("pageType");return e||"popular"}function w(){return m(d-=1),d}function y(){return m(d+=1),d}function L(e){c=g(),b(e),m(d)}function b(e){let t=e.target.innerText;if(t!==p)d=Number(t);else{let t=e.target;for(;"LI"!==t.nodeName;)t=t.parentNode;Array.from(t.classList).includes("next")?d+=3:d-=3,d<0?d=1:d>c&&(d=c)}}function q(){1===d||c<f?u.classList.add("visually-hidden"):u.classList.remove("visually-hidden")}function _(){c<f||d===c?l.classList.add("visually-hidden"):l.classList.remove("visually-hidden")}function x(e){s.innerHTML="";let n,a,r="";if(e||(e=1),(c=g())||(c=1),r+=(0,t.default)({id:"",name:1}),c>1){if(e>4?(r+=(0,t.default)({id:"prev",name:p}),c===e?(n=e-6,a=c):(n=c-e>3?e-2:e-(6-c+e),a=e<c-4?e+2:c-2)):(r+=(0,t.default)({id:"",name:2}),n=c>2?3:2,a=c>=7?7:c),c>2)for(let e=n;e<=a;e+=1)r+=(0,t.default)({id:"",name:e});c>a&&(r+=c-f>0&&c-d>3?(0,t.default)({id:"next",name:p}):(0,t.default)({id:"",name:c-1}),r+=(0,t.default)({id:"",name:c}))}s.innerHTML=r}function M(){const e=document.querySelectorAll(".pagination__link-js");for(const t of e)if(t.innerText===String(d)){t.classList.add("pagination__link-current");break}}u.addEventListener("click",w),l.addEventListener("click",y),o.addEventListener("click",L),k(d);
},{"./common/refs":"OsqH","../partials/hbs/pagination.hbs":"zmcZ","./render-popular-film.js":"sETT","./search-by-keyword.js":"OU2w","./watched-queue-btns":"VN1g"}],"VN1g":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.queueBtnClick=k,exports.watchedBtnClick=g;var e=a(require("../partials/hbs/watched-queue-markup.hbs")),t=a(require("./common/refs")),n=require("./pagination"),r=require("./common/api-data");function a(e){return e&&e.__esModule?e:{default:e}}const{galleryListRefs:u,headerWatchedBtnRefs:l,headerQueueBtnRefs:s,wrapperRefs:i,emptyWatchedQueueRefs:o,watchedQueueTextRefs:c}=t.default.refs,d=(0,r.getLanguage)();function f(t,n){let a=(0,r.getUser)();n||(n=1);let l=(0,r.get)(a),s="",i=0;(s="watched"===t?l.watched:l.queue)?i=q(s):s=[],localStorage.setItem("totalPages",i),localStorage.setItem("pageType",t);let f=20*(n-1),h=20*n;h>s.length&&(h=s.length);let p=L(v(s.slice(f,h)));p&&p.length>0?(u.innerHTML=(0,e.default)(p),o.classList.add("visually-hidden")):(o.classList.remove("visually-hidden"),u.innerHTML="","uk-UA"===d&&(c.textContent="Упс... Ваш список порожній!"))}function h(){m("watched")}function p(){m("queue")}function g(e){m("watched",e)}function k(e){m("queue",e)}function m(e,t){f(e,t),i.innerHTML="",(0,n.onMarkupButton)(t)}function q(e){return Math.floor(e.length/20)+1}function v(e){if(!e)return null;let t=JSON.parse(JSON.stringify(e));return t=t.map(e=>{let t=e.genres.map(e=>e.name);return 0===t.length&&(t=["No genre"],"uk-UA"===d&&(t=["Нема жанру"])),t.length>=3&&(t=t.slice(0,2),"uk-UA"===d?t.push("Інше"):t.push("Other")),t=t.join(", "),e.genres=t,e})}function L(e){if(!e)return null;let t=JSON.parse(JSON.stringify(e));return t=t.map(e=>(e.release_date?e.release_date=e.release_date.split("-")[0]:e.release_date="uk-UA"===d?"Нема даних":"No date",e))}l.addEventListener("click",h),s.addEventListener("click",p);var w={onWatchedBtnClick:h,onQueueBtnClick:p,getMarkup:f};exports.default=w;
},{"../partials/hbs/watched-queue-markup.hbs":"E2xy","./common/refs":"OsqH","./pagination":"o8lo","./common/api-data":"TAGd"}],"PZFh":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3],e="Expected a function",n=NaN,r="[object Symbol]",i=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,f=/^0o[0-7]+$/i,c=parseInt,a="object"==typeof t&&t&&t.Object===Object&&t,s="object"==typeof self&&self&&self.Object===Object&&self,v=a||s||Function("return this")(),l=Object.prototype,p=l.toString,b=Math.max,m=Math.min,y=function(){return v.Date.now()};function d(t,n,r){var i,o,u,f,c,a,s=0,v=!1,l=!1,p=!0;if("function"!=typeof t)throw new TypeError(e);function d(e){var n=i,r=o;return i=o=void 0,s=e,f=t.apply(r,n)}function g(t){var e=t-a;return void 0===a||e>=n||e<0||l&&t-s>=u}function O(){var t=y();if(g(t))return x(t);c=setTimeout(O,function(t){var e=n-(t-a);return l?m(e,u-(t-s)):e}(t))}function x(t){return c=void 0,p&&i?d(t):(i=o=void 0,f)}function T(){var t=y(),e=g(t);if(i=arguments,o=this,a=t,e){if(void 0===c)return function(t){return s=t,c=setTimeout(O,n),v?d(t):f}(a);if(l)return c=setTimeout(O,n),d(a)}return void 0===c&&(c=setTimeout(O,n)),f}return n=h(n)||0,j(r)&&(v=!!r.leading,u=(l="maxWait"in r)?b(h(r.maxWait)||0,n):u,p="trailing"in r?!!r.trailing:p),T.cancel=function(){void 0!==c&&clearTimeout(c),s=0,i=a=o=c=void 0},T.flush=function(){return void 0===c?f:x(y())},T}function j(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function g(t){return!!t&&"object"==typeof t}function O(t){return"symbol"==typeof t||g(t)&&p.call(t)==r}function h(t){if("number"==typeof t)return t;if(O(t))return n;if(j(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=j(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(i,"");var r=u.test(t);return r||f.test(t)?c(t.slice(2),r?2:8):o.test(t)?n:+t}module.exports=d;
},{}],"cGsR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.onSearchFilm=_;var e=d(require("./common/refs.js")),s=d(require("./watched-queue-btns")),a=require("./pagination.js"),t=require("./render-popular-film.js"),i=require("./search-by-keyword.js");function d(e){return e&&e.__esModule?e:{default:e}}const{headerRefs:r,navHomeRefs:l,navLibrRefs:n,btnHomeRefs:c,btnLibrRefs:o,formSearchRefs:u,librListRefs:h,logoRefs:L,galleryListRefs:m,toggleThemeRefs:v,inputSearchRefs:f,wrapperRefs:y,errorPictureRefs:R,emptyWatchedQueueRefs:p,emptySearchRefs:g}=e.default.refs;n.addEventListener("click",q),l.addEventListener("click",I),L.addEventListener("click",I),v.addEventListener("change",T);const b=require("lodash.debounce");async function _(){f.value||(g.classList.remove("visually-hidden"),R.classList.add("visually-hidden"),m.innerHTML=""),await(0,i.onSearch)(1),(0,a.onMarkupButton)(1)}f.addEventListener("input",b(_,500));const k={LIGHT:"light-theme",DARK:"dark-theme"},{LIGHT:S,DARK:M}=k;let H=localStorage.getItem("theme");function q(){R.classList.add("visually-hidden"),g.classList.add("visually-hidden"),p.classList.add("visually-hidden"),r.classList.add("header__library"),r.classList.remove("header__home"),u.classList.add("visually-hidden"),h.classList.remove("visually-hidden"),o.classList.add("current"),c.classList.remove("current"),m.innerHTML="",localStorage.setItem("totalPages",0),f.value="",s.default.onWatchedBtnClick(),y.innerHTML="",(0,a.onMarkupButton)(1)}async function I(){R.classList.add("visually-hidden"),g.classList.add("visually-hidden"),p.classList.add("visually-hidden"),r.classList.remove("header__library"),r.classList.add("header__home"),u.classList.remove("visually-hidden"),h.classList.add("visually-hidden"),c.classList.add("current"),o.classList.remove("current"),f.value="",await(0,t.onSearchPopularFilms)(),y.innerHTML="",(0,a.onMarkupButton)()}function T(e){!0===e.target.checked?(localStorage.setItem("theme",M),j(S,M)):(localStorage.setItem("theme",S),j(M,S))}function j(e,s){document.body.classList.remove(e),document.body.classList.add(s)}H||(H=S,localStorage.setItem("theme",H)),document.body.classList.add(H),v.checked=H===M;
},{"./common/refs.js":"OsqH","./watched-queue-btns":"VN1g","./pagination.js":"o8lo","./render-popular-film.js":"sETT","./search-by-keyword.js":"OU2w","lodash.debounce":"PZFh"}],"lei1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var l=n(require("handlebars/dist/handlebars.runtime"));function n(l){return l&&l.__esModule?l:{default:l}}const e=l.default.template({1:function(l,n,e,t,o){var a,i=null!=n?n:l.nullContext||{},s=l.hooks.helperMissing,r=l.escapeExpression,c=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return'    <img class="movie-image" src="https://image.tmdb.org/t/p/w500'+r("function"==typeof(a=null!=(a=c(e,"poster_path")||(null!=n?c(n,"poster_path"):n))?a:s)?a.call(i,{name:"poster_path",hash:{},data:o,loc:{start:{line:2,column:65},end:{line:2,column:80}}}):a)+'" alt="'+r("function"==typeof(a=null!=(a=c(e,"title")||(null!=n?c(n,"title"):n))?a:s)?a.call(i,{name:"title",hash:{},data:o,loc:{start:{line:2,column:87},end:{line:2,column:96}}}):a)+'">\n'},3:function(l,n,e,t,o){var a,i=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return'    <img class="movie-image" src="https://upload.wikimedia.org/wikipedia/commons/c/c2/No_image_poster.png" alt="'+l.escapeExpression("function"==typeof(a=null!=(a=i(e,"title")||(null!=n?i(n,"title"):n))?a:l.hooks.helperMissing)?a.call(null!=n?n:l.nullContext||{},{name:"title",hash:{},data:o,loc:{start:{line:4,column:112},end:{line:4,column:121}}}):a)+'">\n'},5:function(l,n,e,t,o){var a,i=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return'        <li class="movie-flex__value">'+l.escapeExpression("function"==typeof(a=null!=(a=i(e,"name")||(null!=n?i(n,"name"):n))?a:l.hooks.helperMissing)?a.call(null!=n?n:l.nullContext||{},{name:"name",hash:{},data:o,loc:{start:{line:21,column:38},end:{line:21,column:46}}}):a)+"</li>\n"},7:function(l,n,e,t,o){var a,i=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return null!=(a=i(e,"unless").call(null!=n?n:l.nullContext||{},null!=n?i(n,"logo_path"):n,{name:"unless",hash:{},fn:l.program(8,o,0),inverse:l.noop,data:o,loc:{start:{line:31,column:12},end:{line:33,column:23}}}))?a:""},8:function(l,n,e,t,o){var a,i=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return'                <li class="company__list-item">'+l.escapeExpression("function"==typeof(a=null!=(a=i(e,"name")||(null!=n?i(n,"name"):n))?a:l.hooks.helperMissing)?a.call(null!=n?n:l.nullContext||{},{name:"name",hash:{},data:o,loc:{start:{line:32,column:47},end:{line:32,column:55}}}):a)+' <span class="separator">|</span></li>\n'},10:function(l,n,e,t,o){var a,i=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return null!=(a=i(e,"if").call(null!=n?n:l.nullContext||{},null!=n?i(n,"logo_path"):n,{name:"if",hash:{},fn:l.program(11,o,0),inverse:l.noop,data:o,loc:{start:{line:38,column:12},end:{line:42,column:19}}}))?a:""},11:function(l,n,e,t,o){var a,i=null!=n?n:l.nullContext||{},s=l.hooks.helperMissing,r=l.escapeExpression,c=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return'            <li class="company__list-item">\n                <img class="company__image" src="https://image.tmdb.org/t/p/w500'+r("function"==typeof(a=null!=(a=c(e,"logo_path")||(null!=n?c(n,"logo_path"):n))?a:s)?a.call(i,{name:"logo_path",hash:{},data:o,loc:{start:{line:40,column:80},end:{line:40,column:93}}}):a)+'" alt="'+r("function"==typeof(a=null!=(a=c(e,"name")||(null!=n?c(n,"name"):n))?a:s)?a.call(i,{name:"name",hash:{},data:o,loc:{start:{line:40,column:100},end:{line:40,column:108}}}):a)+'">\n            </li>\n'},compiler:[8,">= 4.3.0"],main:function(l,n,e,t,o){var a,i,s=null!=n?n:l.nullContext||{},r=l.hooks.helperMissing,c="function",u=l.escapeExpression,p=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return(null!=(a=p(e,"if").call(s,null!=n?p(n,"poster_path"):n,{name:"if",hash:{},fn:l.program(1,o,0),inverse:l.program(3,o,0),data:o,loc:{start:{line:1,column:4},end:{line:5,column:11}}}))?a:"")+'    <div class="tablet-movie-container">\n        <div>\n    <h1 class="movie-title">'+u(typeof(i=null!=(i=p(e,"title")||(null!=n?p(n,"title"):n))?i:r)===c?i.call(s,{name:"title",hash:{},data:o,loc:{start:{line:8,column:28},end:{line:8,column:37}}}):i)+'</h1>\n    <div class="movie-flex">\n    <ul class="movie-flex__list">\n        <li class="movie-flex__title movie-flex-vote">Vote / Votes</li>\n        <li class="movie-flex__title movie-flex-popularity">Popularity</li>\n        <li class="movie-flex__title movie-flex-title">Original Title</li>\n        <li class="movie-flex__title movie-flex-genre">Genre</li>\n    </ul>\n    <ul class="movie-flex__list">\n        <li class="movie-flex__value"><span class="movie-flex__vote">'+u(typeof(i=null!=(i=p(e,"vote_average")||(null!=n?p(n,"vote_average"):n))?i:r)===c?i.call(s,{name:"vote_average",hash:{},data:o,loc:{start:{line:17,column:69},end:{line:17,column:85}}}):i)+'</span> <span class="movie-flex__slash">/</span><span class="movie-flex__votes">'+u(typeof(i=null!=(i=p(e,"vote_count")||(null!=n?p(n,"vote_count"):n))?i:r)===c?i.call(s,{name:"vote_count",hash:{},data:o,loc:{start:{line:17,column:165},end:{line:17,column:179}}}):i)+'</span></li>\n        <li class="movie-flex__value">'+u(typeof(i=null!=(i=p(e,"popularity")||(null!=n?p(n,"popularity"):n))?i:r)===c?i.call(s,{name:"popularity",hash:{},data:o,loc:{start:{line:18,column:38},end:{line:18,column:52}}}):i)+'</li>\n        <li class="movie-flex__value">'+u(typeof(i=null!=(i=p(e,"original_title")||(null!=n?p(n,"original_title"):n))?i:r)===c?i.call(s,{name:"original_title",hash:{},data:o,loc:{start:{line:19,column:38},end:{line:19,column:56}}}):i)+"</li>\n"+(null!=(a=p(e,"each").call(s,null!=n?p(n,"genres"):n,{name:"each",hash:{},fn:l.program(5,o,0),inverse:l.noop,data:o,loc:{start:{line:20,column:8},end:{line:22,column:17}}}))?a:"")+'    </ul>\n    </div>\n    <h2 class="movie-title__desc">About</h2>\n    <p class="movie-overview">'+u(typeof(i=null!=(i=p(e,"overview")||(null!=n?p(n,"overview"):n))?i:r)===c?i.call(s,{name:"overview",hash:{},data:o,loc:{start:{line:26,column:30},end:{line:26,column:42}}}):i)+'</p>\n    </div>\n    <div class="company-container">\n    <ul class="company list">\n'+(null!=(a=p(e,"each").call(s,null!=n?p(n,"production_companies"):n,{name:"each",hash:{},fn:l.program(7,o,0),inverse:l.noop,data:o,loc:{start:{line:30,column:8},end:{line:34,column:17}}}))?a:"")+'    </ul>\n    <ul class="company list">\n'+(null!=(a=p(e,"each").call(s,null!=n?p(n,"production_companies"):n,{name:"each",hash:{},fn:l.program(10,o,0),inverse:l.noop,data:o,loc:{start:{line:37,column:8},end:{line:43,column:17}}}))?a:"")+"    </ul>\n</div>\n</div>\n"},useData:!0});var t=e;exports.default=t;
},{"handlebars/dist/handlebars.runtime":"pAws"}],"Eywa":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("handlebars/dist/handlebars.runtime"));function r(e){return e&&e.__esModule?e:{default:e}}const t=e.default.template({compiler:[8,">= 4.3.0"],main:function(e,r,t,l,a){var n,o=e.lookupProperty||function(e,r){if(Object.prototype.hasOwnProperty.call(e,r))return e[r]};return'<a class="trailer">\n    <iframe src="https://www.youtube.com/embed/'+e.escapeExpression("function"==typeof(n=null!=(n=o(t,"trailer")||(null!=r?o(r,"trailer"):r))?n:e.hooks.helperMissing)?n.call(null!=r?r:e.nullContext||{},{name:"trailer",hash:{},data:a,loc:{start:{line:2,column:47},end:{line:2,column:58}}}):n)+'" frameborder="0" allowfullscreen\n        class="trailer-iframe"></iframe>\n    \n</a>'},useData:!0});var l=t;exports.default=l;
},{"handlebars/dist/handlebars.runtime":"pAws"}],"voJm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=O,exports.onClickMovie=q;var e=s(require("../partials/hbs/modal-film.hbs")),t=s(require("../partials/hbs/modal-trailer.hbs")),n=s(require("./api-service")),o=s(require("./common/refs")),i=require("./common/api-data");function s(e){return e&&e.__esModule?e:{default:e}}const{modalTrailerContainerRefs:r,modalTrailerWindowRefs:a,modalFilmContainerRefs:l,backdropRefs:d,closeBtnModalRefs:c,modalWindowRefs:u,galleryListRefs:f,WATCHED:m,QUEUE:v,watchedBtnRefs:L,queueBtnRefs:p,modalsWrapperRefs:y}=o.default.refs,h=(0,i.getLanguage)();let b,g;f.addEventListener("click",q);let x=function(){"dark-theme"===g&&(this.style.boxShadow="0px 4px 4px rgb(5, 5, 5)",this.style.border="1px solid rgb(5, 5, 5)")},k=function(){"dark-theme"===g&&(this.style.boxShadow="0px 4px 4px rgb(255, 107, 1)")};function C(e){let t=e.target;if("LI"!==e.target.nodeName){for(t=e.target.parentNode;"LI"!==t.nodeName&&"BODY"!==t.nodeName;)t=t.parentNode;if("BODY"===t.nodeName)return}return t}function _(e){n.default.fetchTrailer(e.id).then(n=>{const o=n.results[0].key;if(e.id==n.id)return n.trailer=o,r.insertAdjacentHTML("beforeend",(0,t.default)(n)),n}),"dark-theme"===g?U("rgb(5, 5, 5)","inherit"):U("","rgb(0, 0, 0)")}async function w(t){return await n.default.fetchMovie(t.id).then(n=>{if(t.id==n.id)return l.insertAdjacentHTML("beforeend",(0,e.default)(n)),Y(),n})}async function q(e){e.preventDefault();let t=C(e);g=localStorage.getItem("theme");let n=Array.from(e.target.classList).includes("card__overlay");n?_(t):(b=await w(t),M(),E()),T(),S(),n?R():H()}function E(){"dark-theme"===g?A("rgb(5, 5, 5)","rgb(255, 255, 255)","rgb(83, 83, 83)","inherit","rgba(255, 107, 0, 0.75)"):A("","","","rgb(0, 0, 0)","")}function M(){L.onmouseover=x,L.onmouseout=k,p.onmouseover=x,p.onmouseout=k}function T(){c.addEventListener("click",W),window.addEventListener("keydown",O),L.addEventListener("click",B),p.addEventListener("click",D),d.addEventListener("click",W)}function H(){u.classList.remove("visually-hidden"),u.classList.add("is-open"),c.classList.add("close-film__position"),y.classList.add("modal-wrapper-film")}function R(){a.classList.remove("visually-hidden"),a.classList.add("is-open"),c.classList.add("close-trailer__position"),y.classList.add("modal-wrapper-trailer")}function S(){document.body.classList.toggle("modal-open"),d.classList.remove("visually-hidden"),y.classList.remove("visually-hidden"),l.classList.add("is-open")}function A(e,t,n,o,i){const s=document.querySelector(".movie-flex__votes"),r=document.querySelector(".company-container");u.style.backgroundColor=e,u.style.color=t,s.style.backgroundColor=n,c.style.fill=o,r.style.backgroundColor=i}function U(e,t){a.style.backgroundColor=e,c.style.fill=t}function N(){let e=(0,i.getUser)();return e||""}function B(e){let t=N();(0,i.move)(t,v,m,b),L.textContent="watched",p.textContent="add to queue","uk-UA"===h&&(L.textContent="Переглянуто",p.textContent="Додати в чергу")}function D(e){let t=N();(0,i.move)(t,m,v,b),L.textContent="add to watched",p.textContent="queue","uk-UA"===h&&(L.textContent="Переглянути",p.textContent="Додано в чергу")}function W(e){let t=e.target.classList;(t.contains("backdrop")||t.contains("close-button__icon")||t.contains("close__button")||t.contains("use-close-button"))&&j()}function j(){a.classList.add("visually-hidden"),a.classList.remove("is-open"),r.innerHTML="",u.classList.add("visually-hidden"),u.classList.remove("is-open"),l.innerHTML="",document.body.classList.toggle("modal-open"),d.classList.add("visually-hidden"),y.classList.add("visually-hidden"),c.removeEventListener("click",W),d.removeEventListener("click",W),L.removeEventListener("click",B),p.removeEventListener("click",D),window.removeEventListener("keydown",O),c.classList.remove("close_position"),I()}function I(){L.textContent="add to watched",p.textContent="add to queue","uk-UA"===h&&(p.textContent="Додати в чергу",L.textContent="Переглянути")}function O(e){"Escape"===e.code&&j()}function Y(){const e=document.querySelector(".movie-title__desc"),t=document.querySelector(".movie-flex-vote"),n=document.querySelector(".movie-flex-popularity"),o=document.querySelector(".movie-flex-title"),i=document.querySelector(".movie-flex-genre");"uk-UA"===h&&(e.innerHTML="Про фільм",t.innerHTML="Рейтинг",o.innerHTML="Оригінальна назва",i.innerHTML="Жанри",n.innerHTML="Вподобання")}
},{"../partials/hbs/modal-film.hbs":"lei1","../partials/hbs/modal-trailer.hbs":"Eywa","./api-service":"hC31","./common/refs":"OsqH","./common/api-data":"TAGd"}],"c1Lc":[function(require,module,exports) {
let t=document.querySelector(".up-button");function e(){let e=window.pageYOffset;document.documentElement.scrollTopMax;e>100&&!Array.from(t.classList).includes("up-button-show")&&t.classList.add("up-button-show"),e<100&&t.classList.remove("up-button-show")}function o(){window.pageYOffset>0&&(window.scrollBy(0,-30),setTimeout(o,0))}window.addEventListener("scroll",e),t.addEventListener("click",o);
},{}],"Sc1o":[function(require,module,exports) {
let e=document.querySelector(".mask");window.addEventListener("load",()=>{e.classList.add("hide"),setTimeout(()=>{e.remove()},600)});
},{}],"pg4l":[function(require,module,exports) {
"use strict";var e=require("../common/api-firebase"),t=require("../common/api-data"),n=o(require("../common/refs"));function o(e){return e&&e.__esModule?e:{default:e}}const{backdropRefs:s,openModalAuthRefs:a,modalAuthRefs:l,confirmCheckboxRefs:i,authTitleRefs:c,authNameGroupRefs:r,authNameRefs:u,authNameTextRefs:d,authEmailRefs:g,authEmailTextRefs:h,authPasswordRefs:m,authPasswordTextRefs:f,authCheckboxText:p,authFormRefs:L,authCancelBtnRefs:b,authSignUpBtnRefs:w}=n.default.refs;let v,x,k,T,y,R,_=function(){"dark-theme"===k&&(this.style.boxShadow="4px 4px 4px rgb(5, 5, 5)",this.style.border="1px solid rgb(5, 5, 5)")},E=function(){"dark-theme"===k&&(this.style.boxShadow="4px 4px 4px rgb(255, 107, 1)")};a.addEventListener("click",U);const M=L.querySelector(".close__button");function B(e,t,n){L.style.backgroundColor=e,L.style.color=t,M.style.fill=n}function H(){let e=(0,t.getLanguage)();console.log(e),P("en-US"===e?{title:"Please enter user details:",email:"Mail",password:"Password",passwordPlaceholder:"Enter password",name:"Name",namePlaceholder:"John Jonson",checkboxText:"Register a new user",cancelBtn:"Close",signUpBtn:"Sign Up",logInBtn:"Log In",logOut:"Log Out"}:{title:"Будь ласка введіть дані користувача:",email:"Пошта",password:"Пароль",passwordPlaceholder:"Введіть пароль",name:"Ім'я",namePlaceholder:"Козаченко Микола",checkboxText:"Зареєструвати нового користувача",cancelBtn:"Закрити",signUpBtn:"Реєстрація",logInBtn:"Увійти",logOut:"Вийти"})}function P(e){c.innerHTML=e.title,h.innerHTML=e.email,f.innerHTML=e.password,d.innerHTML=e.name,p.innerHTML=e.checkboxText,L.password.placeholder=e.passwordPlaceholder,L.name.placeholder=e.namePlaceholder,b.innerHTML=e.cancelBtn,T=e.signUpBtn,y=e.logInBtn,R=e.logOut}function N(){window.removeEventListener("keydown",I),M.removeEventListener("click",C),i.removeEventListener("change",q),s.removeEventListener("click",C),S()}function S(){s.classList.toggle("visually-hidden"),l.classList.toggle("visually-hidden"),l.classList.toggle("is-open"),document.body.classList.toggle("modal-open"),M.classList.toggle("auth__button-close")}function U(e){k=localStorage.getItem("theme"),window.addEventListener("keydown",I),M.addEventListener("click",C),i.addEventListener("change",q),s.addEventListener("click",C),w.addEventListener("click",O),"dark-theme"===k?B("rgb(5, 5, 5)","rgb(255, 255, 255)","inherit"):B("#f7f7f7","rgb(0, 0, 0)","rgb(0, 0, 0)"),S(),b.onmouseover=_,b.onmouseout=E,w.onmouseover=_,w.onmouseout=E,H(),w.innerHTML=T}function I(e){"Escape"===e.code&&N()}function C(e){let t=e.target.classList;(t.contains("backdrop")||t.contains("auth__button-close")||t.contains("auth__icon")||t.contains("auth__use")||t.contains("button-submit-close")||t.contains("close__button")||t.contains("close-button__icon")||t.contains("use-close-button"))&&N()}function q(e){let t="";e.target.checked?(t=T,r.classList.remove("visually-hidden"),L.style.height="374px"):(t=y,r.classList.add("visually-hidden"),L.style.height="307px"),w.innerHTML=t}async function O(n){if(!v||!x){v=await(0,e.init)();const n=u.value,o=g.value,s=m.value,l=i.checked;console.log("userName",n),console.log("userName",n),console.log("userEmail",o),console.log("userPassword",s),console.log("isNewUser",l),(x=await(0,e.login)(v,n,s,o,l))&&("signIn"===x.operationType&&(console.log(x),localStorage.setItem("loginUser",x.user.email)),a.innerHTML=R);let c=await(0,e.getDb)(v);console.log("db",c);let r=(0,t.get)(),d=x.user.email.split("@")[0],h=await(0,e.writeNewData)(c,d,r);console.log("res",h)}}i.checked=!0,u.innerHTML="",g.innerHTML="",m.value="",H();
},{"../common/api-firebase":"CAsa","../common/api-data":"TAGd","../common/refs":"OsqH"}],"gmTP":[function(require,module,exports) {
"use strict";var e=require("./common/api-data"),n=t(require("./common/refs"));function t(e){return e&&e.__esModule?e:{default:e}}const r=document.querySelector(".footer-cont__txt-rights"),o=document.querySelector(".footer-cont__txt-developed"),i=document.querySelector(".footer-cont__text-by"),u=(0,e.getLanguage)(),{ukrLangSvgRefs:a,engLangSvgRefs:c,btnHomeRefs:f,btnLibrRefs:d,inputSearchRefs:s,btnLogin:L,headerWatchedBtnRefs:l,headerQueueBtnRefs:g,watchedBtnRefs:M,queueBtnRefs:H,openModalBtnRefs:T}=n.default.refs;function R(){(0,e.setLanguage)("uk-UA"),location.reload()}function b(){(0,e.setLanguage)("en-US"),location.reload()}function m(){"uk-UA"===u&&(f.innerHTML="Головна",d.innerHTML="Моя бібліотека",s.placeholder="Шукати фільми",L.innerHTML="Увійти",l.innerHTML="Переглянуте",g.innerHTML="У черзі",M.innerHTML="До переглянутих",H.innerHTML="Дивитися потім",r.innerHTML="Всі права захищені",o.innerHTML="Розроблено з",T.innerHTML="студентами GoIT",i.innerHTML="",a.style.border="1px solid #ff6b01")}function S(){"en-US"===u&&(c.style.border="1px solid #ff6b01")}a.addEventListener("click",R),c.addEventListener("click",b),(0,e.getLanguage)(),m(),S();
},{"./common/api-data":"TAGd","./common/refs":"OsqH"}],"Focm":[function(require,module,exports) {
"use strict";require("./sass/main.scss"),require("./js/common/api-firebase.js"),require("./js/about.js"),require("./js/search-by-keyword.js"),require("./js/header.js"),require("./js/render-popular-film"),require("./js/modal-film.js"),require("./js/up-button"),require("./js/spinner"),require("./js/watched-queue-btns"),require("./js/render-popular-film.js"),require("./js/watched-queue-btns.js"),require("./js/component/auth.js"),require("./js/pagination.js"),require("./js/change-language.js");
},{"./sass/main.scss":"clu1","./js/common/api-firebase.js":"CAsa","./js/about.js":"H3RA","./js/search-by-keyword.js":"OU2w","./js/header.js":"cGsR","./js/render-popular-film":"sETT","./js/modal-film.js":"voJm","./js/up-button":"c1Lc","./js/spinner":"Sc1o","./js/watched-queue-btns":"VN1g","./js/render-popular-film.js":"sETT","./js/watched-queue-btns.js":"VN1g","./js/component/auth.js":"pg4l","./js/pagination.js":"o8lo","./js/change-language.js":"gmTP"}]},{},["Focm"], null)
//# sourceMappingURL=/project-filmoteka/src.c95c8995.js.map